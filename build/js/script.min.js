document.querySelectorAll(".model__link").forEach(e=>{e.addEventListener("click",e=>{console.log(e.target.tagName),"img"===e.target.tagName.toLowerCase()&&e.preventDefault()})}),new Swiper(".model__image-container",{pagination:{el:".model__pagination",type:"bullets",clickable:!0},loop:!0}),function(){const e=document.querySelectorAll(".device__wire-dote span"),t=document.querySelectorAll(".device__wire-popup-mobile"),o=document.querySelectorAll(".device__wire-popup-close"),n=document.querySelector(".device__wire-popup-overlay");if(!e[0])return;e.forEach((e,o)=>{e.addEventListener("click",()=>{t[o].classList.add("js--show"),n.classList.add("js--show")})}),o.forEach((e,o)=>{e.addEventListener("click",()=>{t[o].classList.remove("js--show"),n.classList.remove("js--show")})}),n.addEventListener("click",()=>{t.forEach(e=>{e.classList.contains("js--show")&&e.classList.remove("js--show")}),n.classList.remove("js--show")})}(),document.getElementById("animation")&&lottie.loadAnimation({container:document.getElementById("animation"),renderer:"svg",loop:!0,autoplay:!0,path:"data.json"}),function(){var e="https://split.daichicloud.ru/brands/all",t="GET",o=200,n=300,s=function(e,t){var s=new XMLHttpRequest;return s.timeout=1e4,s.responseType="json",s.addEventListener("load",(function(){!function(e){return e.status<o||e.status>n}(s)?e(s.response):t("Данные не загрузились. Причина: "+s.status+" "+s.statusText)})),s.addEventListener("error",(function(){t("Произошла ошибка соединения")})),s.addEventListener("timeout",(function(){t("Запрос не успел выполниться за "+s.timeout+"мс")})),s},r=function(e){e.remove()},a=function(e){var t=document.createElement("div");t.style="z-index: 100; margin: 0 auto; text-align: center; background-color: red;",t.style.position="absolute",t.style.left=0,t.style.right=0,t.style.fontSize="30px",t.textContent=e,document.body.insertAdjacentElement("afterbegin",t),window.setTimeout(r,2e3,t)};window.backend={load:function(o,n){var r=s(o,n||a);r.open(t,e),r.send()}}}(),jQuery,function(){const e=document.querySelector(".model-choice__brand-list"),t=document.querySelector(".model-choice__brand-choice");if(!e)return;t.addEventListener("click",()=>{if(!e.classList.contains("show"))return e.classList.add("show"),void t.classList.add("opened");e.classList.contains("show")&&(e.classList.remove("show"),t.classList.remove("opened"))}),document.addEventListener("mousedown",o=>{let n=o.target;n.classList.contains("model-choice__brand-choice")||n.classList.contains("model-choice__brand-item")||n.classList.contains("model-choice__brand-list")||!e.classList.contains("show")||(e.classList.remove("show"),t.classList.remove("opened"))})}(),function(){const e=document.querySelector(".equipment__wrapper"),t=document.querySelector(".equipment__container");if(!e)return;(()=>{let o=document.createDocumentFragment(),n=e.cloneNode(!0);n.className="equipment__slide-wrapper",n.classList.add("swiper-wrapper");let s=document.createElement("div");s.classList.add("equipment__pagination"),s.classList.add("swiper-pagination"),o.appendChild(n),o.appendChild(s),t.appendChild(o),t.querySelectorAll(".equipment__item").forEach(e=>{e.classList.add("swiper-slide")}),new Swiper(".equipment__container",{pagination:{el:".equipment__pagination",type:"bullets"},loop:!0})})()}(),function(){const e=document.querySelector(".process__wrapper"),t=document.querySelector(".process__container");if(!e)return;(()=>{let o=document.createDocumentFragment(),n=e.cloneNode(!0);n.className="process__slide-wrapper",n.classList.add("swiper-wrapper");let s=document.createElement("div");s.classList.add("process__pagination"),s.classList.add("swiper-pagination");let r=document.createElement("div");r.className="process__number",r.textContent=1,o.appendChild(n),o.appendChild(s),o.appendChild(r),t.appendChild(o),t.querySelectorAll(".process__item").forEach(e=>{e.classList.add("swiper-slide")});(e=>{const o=t.querySelector(".process__number");e.on("slideChange",()=>{o.textContent=e.realIndex+1})})(new Swiper(".process__container",{pagination:{el:".process__pagination",type:"bullets"},loop:!0}))})()}(),function(){const e=document.querySelector(".add-model__form"),t=document.querySelector("input[name='email']"),o=document.querySelector(".add-model__email-error"),n=document.querySelector("input[name='brand']"),s=document.querySelector(".add-model__brand-error"),r=document.querySelector("input[name='model']"),a=document.querySelector(".add-model__model-error"),i=document.querySelector("input[type='file']"),d=document.querySelector(".add-model__agreement-input"),l=document.querySelector(".add-model__submit"),c=document.querySelector(".add-model__file-progress"),u=document.querySelector(".add-model__bar-current"),m=document.querySelector(".add-model__file-result"),p=document.querySelector(".add-model__file-image"),_=document.querySelector(".add-model__file-name"),v=document.querySelector(".add-model__file-close");if(!t)return;const L=(e,t)=>{e.classList.contains(t)||e.classList.add(t)},h=(e,t)=>{e.classList.contains(t)&&e.classList.remove(t)},w=()=>{t.validity.valid&&""!==n.value&&""!==r.value&&d.checked?l.hasAttribute("disabled")&&l.removeAttribute("disabled"):!l.hasAttribute("disabled")&&l.setAttribute("disabled","")},f=e=>{const t=e.target;L(t,"fill"),""===t.value&&L(t,"mask")},y=e=>{const t=e.target;t.value||h(t,"fill"),h(t,"mask")};t.addEventListener("focus",f),t.addEventListener("blur",y),t.addEventListener("input",e=>{const n=e.target;t.validity.valid||(L(o,"show"),L(t,"error")),t.validity.valid&&(h(n,"error"),h(o,"show")),""===n.value&&L(n,"mask"),""!==n.value&&h(n,"mask"),w()}),n.addEventListener("focus",f),n.addEventListener("blur",y),n.addEventListener("input",e=>{const t=e.target;""===t.value&&(L(t,"mask"),L(t,"error"),L(s,"show")),""!==t.value&&(h(t,"mask"),h(t,"error"),h(s,"show")),w()}),r.addEventListener("focus",f),r.addEventListener("blur",y),r.addEventListener("input",e=>{const t=e.target;""===t.value&&(L(t,"mask"),L(t,"error"),L(a,"show")),""!==t.value&&(h(t,"mask"),h(t,"error"),h(a,"show")),w()}),i.addEventListener("change",e=>{(e=>{if(e.files&&e.files[0]){var t=new FileReader;t.onloadstart=function(e){c.classList.add("show")},t.onprogress=function(e){console.log(Math.round(e.loaded/e.total*100)),u.style.width=Math.round(e.loaded/e.total*100)+"%"},t.onload=function(t){p.setAttribute("src",t.target.result),_.textContent=e.files[0].name,!m.classList.contains("show")&&m.classList.add("show"),c.classList.remove("show"),u.style.width=0},t.readAsDataURL(e.files[0])}})(e.target)}),v.addEventListener("click",()=>{i.value="",/safari/i.test(navigator.userAgent)||(i.type="",i.type="file"),m.classList.remove("show"),_.textContent="",p.removeAttribute("src")}),d.addEventListener("click",()=>{d.checked?h(d,"error"):L(d,"error"),w()}),l.addEventListener("click",t=>{t.preventDefault(),e.submit()})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZGVsLmpzIiwicG9wdXAuanMiLCJhbmltYXRpb24uanMiLCJiYWNrZW5kLmpzIiwic2VsZWN0LmpzIiwiY2hvaWNlLmpzIiwiZXF1aXBtZW50LmpzIiwicHJvY2Vzcy5qcyIsImZvcm0uanMiXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImxpbmsiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZ0IiwiY29uc29sZSIsImxvZyIsInRhcmdldCIsInRhZ05hbWUiLCJ0b0xvd2VyQ2FzZSIsInByZXZlbnREZWZhdWx0IiwiU3dpcGVyIiwicGFnaW5hdGlvbiIsImVsIiwidHlwZSIsImNsaWNrYWJsZSIsImxvb3AiLCJ3aXJlQnV0dG9ucyIsInBvcHVwcyIsImNsb3NlQnV0dG9ucyIsIm92ZXJsYXkiLCJxdWVyeVNlbGVjdG9yIiwid2lyZUJ1dHRvbiIsImlkeCIsImNsYXNzTGlzdCIsImFkZCIsImNsb3NlQnV0dG9uIiwicmVtb3ZlIiwicG9wdXAiLCJjb250YWlucyIsImdldEVsZW1lbnRCeUlkIiwibG90dGllIiwibG9hZEFuaW1hdGlvbiIsImNvbnRhaW5lciIsInJlbmRlcmVyIiwiYXV0b3BsYXkiLCJwYXRoIiwiUmVxVXJsIiwiUmVxTWV0aG9kIiwiUmVxU3RhdHVzIiwiY3JlYXRlUmVxdWVzdCIsIm9uTG9hZCIsIm9uRXJyb3IiLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsInRpbWVvdXQiLCJyZXNwb25zZVR5cGUiLCJzdGF0dXMiLCJpc0Vycm9yU3RhdHVzIiwicmVzcG9uc2UiLCJzdGF0dXNUZXh0IiwicmVtb3ZlRWxlbWVudCIsImVsZW1lbnQiLCJvbkFueUVycm9yIiwibWVzc2FnZSIsIm5vZGUiLCJjcmVhdGVFbGVtZW50Iiwic3R5bGUiLCJwb3NpdGlvbiIsImxlZnQiLCJyaWdodCIsImZvbnRTaXplIiwidGV4dENvbnRlbnQiLCJib2R5IiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50Iiwid2luZG93Iiwic2V0VGltZW91dCIsImJhY2tlbmQiLCJsb2FkIiwicmVxIiwib3BlbiIsInNlbmQiLCJqUXVlcnkiLCJicmFuZExpc3QiLCJicmFuZEJ1dHRvbiIsIndyYXBwZXIiLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJ3cmFwcGVyTm9kZSIsImNsb25lTm9kZSIsImNsYXNzTmFtZSIsInBhZ2luYXRpb25Ob2RlIiwiYXBwZW5kQ2hpbGQiLCJpdGVtIiwicmVuZGVyU2xpZGVyIiwibnVtYmVyTm9kZSIsInN3aXBlciIsIm51bWJlckZpZWxkIiwib24iLCJyZWFsSW5kZXgiLCJhZGROdW1iZXJpbmciLCJmb3JtIiwiZW1haWxJbnB1dCIsImVtYWlsRXJyb3IiLCJicmFuZElucHV0IiwiYnJhbmRFcnJvciIsIm1vZGVsSW5wdXQiLCJtb2RlbEVycm9yIiwiZmlsZUlucHV0IiwiY2hlY2tib3giLCJzdWJtaXQiLCJwcm9ncmVzcyIsImJhciIsImZpbGVSZXN1bHQiLCJmaWxlSW1nIiwiZmlsZU5hbWUiLCJmaWxlQ2xlYXIiLCJhZGRDbGFzc05hbWUiLCJyZW1vdmVDbGFzc05hbWUiLCJjaGVja0Zvcm0iLCJ2YWxpZGl0eSIsInZhbGlkIiwidmFsdWUiLCJjaGVja2VkIiwiaGFzQXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwic2V0QXR0cmlidXRlIiwib25UZXh0Rm9jdXMiLCJpbnB1dCIsIm9uVGV4dEJsdXIiLCJmaWxlcyIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJvbmxvYWRzdGFydCIsImUiLCJvbnByb2dyZXNzIiwiTWF0aCIsInJvdW5kIiwibG9hZGVkIiwidG90YWwiLCJ3aWR0aCIsIm9ubG9hZCIsInJlc3VsdCIsIm5hbWUiLCJyZWFkQXNEYXRhVVJMIiwicmVhZFVybCIsInRlc3QiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiXSwibWFwcGluZ3MiOiJBQUNBQSxTQUFBQyxpQkFBQSxnQkFhQUMsUUFBQUMsSUFDQUEsRUFBQUMsaUJBQUEsUUFBQUMsSUFFQUMsUUFBQUMsSUFB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S0FDQStGLEVBQUFjLE1BQUEsR0FFQSxVQUFBd0IsS0FBQUMsVUFBQUMsYUFDQXhDLEVBQUFwRixLQUFBLEdBQ0FvRixFQUFBcEYsS0FBQSxRQUdBeUYsRUFBQS9FLFVBQUFHLE9BQUEsUUFDQThFLEVBQUEzQyxZQUFBLEdBQ0EwQyxFQUFBVyxnQkFBQSxTQW9DQWhCLEVBQUFoRyxpQkFBQSxRQTdCQSxLQUNBZ0csRUFBQWMsUUFFQUwsRUFBQVQsRUFBQSxTQURBUSxFQUFBUixFQUFBLFNBR0FVLE1BMEJBVCxFQUFBakcsaUJBQUEsUUF2QkFDLElBQ0FBLEVBQUFNLGlCQUVBaUYsRUFBQVMsV0E1TUEiLCJmaWxlIjoic2NyaXB0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IG1vZGVsTGlua3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubW9kZWxfX2xpbmsnKVxuXG4gIGNvbnN0IGluaXRTd2lwZXIgPSAoKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBTd2lwZXIoJy5tb2RlbF9faW1hZ2UtY29udGFpbmVyJywge1xuICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICBlbDogJy5tb2RlbF9fcGFnaW5hdGlvbicsXG4gICAgICAgIHR5cGU6ICdidWxsZXRzJyxcbiAgICAgICAgY2xpY2thYmxlOiB0cnVlLFxuICAgICAgfSxcbiAgICAgIGxvb3A6IHRydWUsXG4gICAgfSk7XG4gIH07XG5cbiAgbW9kZWxMaW5rcy5mb3JFYWNoKChsaW5rKSA9PiB7XG4gICAgbGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldnQpID0+IHtcblxuICAgICAgY29uc29sZS5sb2coZXZ0LnRhcmdldC50YWdOYW1lKTtcbiAgICAgIGlmIChldnQudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2ltZycpIHtcbiAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgfSlcbiAgfSk7XG5cbiAgaW5pdFN3aXBlcigpO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IHdpcmVCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmRldmljZV9fd2lyZS1kb3RlIHNwYW4nKTtcbiAgY29uc3QgcG9wdXBzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmRldmljZV9fd2lyZS1wb3B1cC1tb2JpbGUnKTtcbiAgY29uc3QgY2xvc2VCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmRldmljZV9fd2lyZS1wb3B1cC1jbG9zZScpO1xuICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRldmljZV9fd2lyZS1wb3B1cC1vdmVybGF5Jyk7XG5cbiAgaWYgKCF3aXJlQnV0dG9uc1swXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGNsb3NlQW55UG9wdXAgPSAoKSA9PiB7XG4gICAgcG9wdXBzLmZvckVhY2goKHBvcHVwKSA9PiB7XG4gICAgICBpZiAocG9wdXAuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0tc2hvdycpKSB7XG4gICAgICAgIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1zaG93Jyk7XG4gICAgICB9XG4gICAgfSlcbiAgfTtcblxuICB3aXJlQnV0dG9ucy5mb3JFYWNoKCh3aXJlQnV0dG9uLCBpZHgpID0+IHtcbiAgICB3aXJlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgcG9wdXBzW2lkeF0uY2xhc3NMaXN0LmFkZCgnanMtLXNob3cnKTtcbiAgICAgIG92ZXJsYXkuY2xhc3NMaXN0LmFkZCgnanMtLXNob3cnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgY2xvc2VCdXR0b25zLmZvckVhY2goKGNsb3NlQnV0dG9uLCBpZHgpID0+IHtcbiAgICBjbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIHBvcHVwc1tpZHhdLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1zaG93Jyk7XG4gICAgICBvdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1zaG93Jyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgY2xvc2VBbnlQb3B1cCgpO1xuICAgIG92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZSgnanMtLXNob3cnKTtcbiAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYW5pbWF0aW9uJykpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsb3R0aWUubG9hZEFuaW1hdGlvbih7XG4gICAgY29udGFpbmVyOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYW5pbWF0aW9uJyksIC8vIHRoZSBkb20gZWxlbWVudCB0aGF0IHdpbGwgY29udGFpbiB0aGUgYW5pbWF0aW9uXG4gICAgcmVuZGVyZXI6ICdzdmcnLFxuICAgIGxvb3A6IHRydWUsXG4gICAgYXV0b3BsYXk6IHRydWUsXG4gICAgcGF0aDogJ2RhdGEuanNvbicgLy8gdGhlIHBhdGggdG8gdGhlIGFuaW1hdGlvbiBqc29uXG4gIH0pO1xufSkoKTtcbiIsIid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIFJlcVVybCA9IHtcbiAgICBHRVQ6ICdodHRwczovL3NwbGl0LmRhaWNoaWNsb3VkLnJ1L2JyYW5kcy9hbGwnLFxuICAgIC8vUE9TVDogJ2h0dHBzOi8vanMuZHVtcC5hY2FkZW15L2tla3N0YWdyYW0nXG4gIH07XG5cbiAgdmFyIFJlcU1ldGhvZCA9IHtcbiAgICBHRVQ6ICdHRVQnLFxuICAgIFBPU1Q6ICdQT1NUJ1xuICB9O1xuXG4gIHZhciBSZXFTdGF0dXMgPSB7XG4gICAgT0s6IDIwMCxcbiAgICBNVUxUSVBMRV9DSE9JQ0VTOiAzMDAsXG4gIH07XG5cbiAgdmFyIFRJTUVPVVQgPSAxMDAwMDtcblxuICB2YXIgaXNFcnJvclN0YXR1cyA9IGZ1bmN0aW9uICh4aHIpIHtcbiAgICByZXR1cm4geGhyLnN0YXR1cyA8IFJlcVN0YXR1cy5PS1xuICAgICAgfHwgeGhyLnN0YXR1cyA+IFJlcVN0YXR1cy5NVUxUSVBMRV9DSE9JQ0VTO1xuICB9O1xuXG4gIHZhciBjcmVhdGVSZXF1ZXN0ID0gZnVuY3Rpb24gKG9uTG9hZCwgb25FcnJvcikge1xuICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICAgIHhoci50aW1lb3V0ID0gVElNRU9VVDtcbiAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2pzb24nO1xuXG4gICAgeGhyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoaXNFcnJvclN0YXR1cyh4aHIpKSB7XG4gICAgICAgIG9uRXJyb3IoJ9CU0LDQvdC90YvQtSDQvdC1INC30LDQs9GA0YPQt9C40LvQuNGB0YwuINCf0YDQuNGH0LjQvdCwOiAnICsgeGhyLnN0YXR1cyArICcgJyArIHhoci5zdGF0dXNUZXh0KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBvbkxvYWQoeGhyLnJlc3BvbnNlKTtcbiAgICB9KTtcblxuICAgIHhoci5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGZ1bmN0aW9uICgpIHtcbiAgICAgIG9uRXJyb3IoJ9Cf0YDQvtC40LfQvtGI0LvQsCDQvtGI0LjQsdC60LAg0YHQvtC10LTQuNC90LXQvdC40Y8nKTtcbiAgICB9KTtcblxuICAgIHhoci5hZGRFdmVudExpc3RlbmVyKCd0aW1lb3V0JywgZnVuY3Rpb24gKCkge1xuICAgICAgb25FcnJvcign0JfQsNC/0YDQvtGBINC90LUg0YPRgdC/0LXQuyDQstGL0L/QvtC70L3QuNGC0YzRgdGPINC30LAgJyArIHhoci50aW1lb3V0ICsgJ9C80YEnKTtcbiAgICB9KTtcblxuICAgIHJldHVybiB4aHI7XG4gIH07XG5cbiAgdmFyIHJlbW92ZUVsZW1lbnQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgIGVsZW1lbnQucmVtb3ZlKCk7XG4gIH07XG5cbiAgdmFyIG9uQW55RXJyb3IgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgIHZhciBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgbm9kZS5zdHlsZSA9ICd6LWluZGV4OiAxMDA7IG1hcmdpbjogMCBhdXRvOyB0ZXh0LWFsaWduOiBjZW50ZXI7IGJhY2tncm91bmQtY29sb3I6IHJlZDsnO1xuICAgIG5vZGUuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgIG5vZGUuc3R5bGUubGVmdCA9IDA7XG4gICAgbm9kZS5zdHlsZS5yaWdodCA9IDA7XG4gICAgbm9kZS5zdHlsZS5mb250U2l6ZSA9ICczMHB4JztcblxuICAgIG5vZGUudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xuICAgIGRvY3VtZW50LmJvZHkuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmJlZ2luJywgbm9kZSk7XG4gICAgd2luZG93LnNldFRpbWVvdXQocmVtb3ZlRWxlbWVudCwgMjAwMCwgbm9kZSk7XG4gIH07XG5cbiAgd2luZG93LmJhY2tlbmQgPSB7XG4gICAgbG9hZDogZnVuY3Rpb24gKG9uTG9hZCwgb25FcnJvcikge1xuICAgICAgdmFyIHJlcSA9IGNyZWF0ZVJlcXVlc3Qob25Mb2FkLCBvbkVycm9yIHx8IG9uQW55RXJyb3IpO1xuICAgICAgcmVxLm9wZW4oUmVxTWV0aG9kLkdFVCwgUmVxVXJsLkdFVCk7XG4gICAgICByZXEuc2VuZCgpO1xuICAgIH0sXG5cbiAgICAvLyBzYXZlOiBmdW5jdGlvbiAoZGF0YSwgb25Mb2FkLCBvbkVycm9yKSB7XG4gICAgLy8gICB2YXIgcmVxID0gY3JlYXRlUmVxdWVzdChvbkxvYWQsIG9uRXJyb3IpO1xuICAgIC8vICAgcmVxLm9wZW4oUmVxTWV0aG9kLlBPU1QsIFJlcVVybC5QT1NUKTtcbiAgICAvLyAgIHJlcS5zZW5kKGRhdGEpO1xuICAgIC8vIH1cbiAgfTtcbn0pKCk7XG5cblxuXG5cbiIsIi8vICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuLy8gICAvLyAkKCcubW9kZWwtY2hvaWNlX19icmFuZC1zZWxlY3QnKS5zZWxlY3QyKHtcbi8vICAgLy8gICBtaW5pbXVtUmVzdWx0c0ZvclNlYXJjaDogLTEsXG4vLyAgIC8vIH0pO1xuXG4vLyAgIC8vICQoJy5tb2RlbC1jaG9pY2VfX3Nlcmllcy1zZWxlY3QnKS5zZWxlY3QyKHtcbi8vICAgLy8gICBtaW5pbXVtUmVzdWx0c0ZvclNlYXJjaDogLTEsXG4vLyAgIC8vIH0pO1xuXG4vLyAgIGZ1bmN0aW9uIG1ha2VTZWxlY3QoZWxlbWVudCkge1xuLy8gICAgICQoZWxlbWVudCkuc2VsZWN0Mih7XG4vLyAgICAgICBtaW5pbXVtUmVzdWx0c0ZvclNlYXJjaDogLTEsXG4vLyAgICAgfSk7XG4vLyAgIH07XG5cblxuXG5cbi8vICAgd2luZG93Lm1ha2VTZWxlY3QgPSBtYWtlU2VsZWN0O1xuXG4vLyAgIGNvbnNvbGUubG9nKHdpbmRvdy5tYWtlU2VsZWN0KTtcblxuLy8gfSk7XG5cblxuKGZ1bmN0aW9uKCQpIHtcbiAgLy8gZnVuY3Rpb24gbWFrZVNlbGVjdChlbGVtZW50Q2xhc3MpIHtcbiAgLy8gICAkKGVsZW1lbnRDbGFzcykuc2VsZWN0Mih7XG4gIC8vICAgICBtaW5pbXVtUmVzdWx0c0ZvclNlYXJjaDogLTEsXG4gIC8vICAgfSk7XG4gIC8vIH07XG5cbiAgLy8gd2luZG93Lm1ha2VTZWxlY3QgPSBtYWtlU2VsZWN0O1xufSkoalF1ZXJ5KTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gIC8vIGNvbnN0IHNwbGl0cyA9IFtcbiAgLy8gICB7XG4gIC8vICAgICBcImlkXCI6NyxcbiAgLy8gICAgIFwidGl0bGVcIjpcIkF4aW9tYVwiLFxuICAvLyAgICAgXCJzZXJpZXNcIjpbXG4gIC8vICAgICAgIHtcbiAgLy8gICAgICAgICBcImlkXCI6NjMsXG4gIC8vICAgICAgICAgXCJ0aXRsZVwiOlwiQVNYX0FcIlxuICAvLyAgICAgICB9LFxuICAvLyAgICAgICB7XG4gIC8vICAgICAgICAgXCJpZFwiOjYyLFxuICAvLyAgICAgICAgIFwidGl0bGVcIjpcIkFTWF9BWlwiXG4gIC8vICAgICAgIH1cbiAgLy8gICAgIF1cbiAgLy8gICB9LFxuICAvLyAgIHtcImlkXCI6NixcInRpdGxlXCI6XCJEYWljaGlcIixcInNlcmllc1wiOlt7XCJpZFwiOjQ1LFwidGl0bGVcIjpcIkNhcmJvbiBEQV9EVlFcIn0se1wiaWRcIjo0NixcInRpdGxlXCI6XCJFdmVyZXN0IERBX0VWUVwifSx7XCJpZFwiOjQzLFwidGl0bGVcIjpcIlBlYWsgREFfQVZRU1wifSx7XCJpZFwiOjQyLFwidGl0bGVcIjpcIlgtdHJlbWUgUGVhayBEQV9BVlFTXCJ9XX0sXG4gIC8vICAge1wiaWRcIjoxLFwidGl0bGVcIjpcIkRhaWtpblwiLFwic2VyaWVzXCI6W3tcImlkXCI6MTEsXCJ0aXRsZVwiOlwiQ29tZm9yYSBGVFgtSlxcL0dWXCJ9LHtcImlkXCI6MjYsXCJ0aXRsZVwiOlwiQ29tZm9yYSBGVFhQLUszXCJ9LHtcImlkXCI6MjcsXCJ0aXRsZVwiOlwiQ29tZm9yYSBGVFhQLUxcIn0se1wiaWRcIjoyOCxcInRpdGxlXCI6XCJDb21mb3JhIEZUWFAtTVwifSx7XCJpZFwiOjIzLFwidGl0bGVcIjpcIkVtdXJhIEZUWEctTFwifSx7XCJpZFwiOjE4LFwidGl0bGVcIjpcIkVtdXJhIEZUWEotTVwifSx7XCJpZFwiOjIwLFwidGl0bGVcIjpcIkZMWFMtQlwifSx7XCJpZFwiOjE2LFwidGl0bGVcIjpcIkZUWEItQlwifSx7XCJpZFwiOjY1LFwidGl0bGVcIjpcIkZUWFMtRVwifSx7XCJpZFwiOjY0LFwidGl0bGVcIjpcIkZUWFMtSlxcL0dcIn0se1wiaWRcIjoyMSxcInRpdGxlXCI6XCJGVlhNLUZcIn0se1wiaWRcIjoyMixcInRpdGxlXCI6XCJGVlhTLUZcIn0se1wiaWRcIjoxOSxcInRpdGxlXCI6XCJOZXh1cmEgRlZYRy1LXCJ9LHtcImlkXCI6MjQsXCJ0aXRsZVwiOlwiUGVyZmVyYSBGVFhNLU5cIn0se1wiaWRcIjoyNSxcInRpdGxlXCI6XCJQZXJmZXJhIEZUWFMtS1wifSx7XCJpZFwiOjEsXCJ0aXRsZVwiOlwiU2Vuc2lyYSBGVFhCLUNcIn1dfSxcbiAgLy8gICB7XCJpZFwiOjIsXCJ0aXRsZVwiOlwiS2VudGF0c3VcIixcInNlcmllc1wiOlt7XCJpZFwiOjQ5LFwidGl0bGVcIjpcIkJyYXZvICBLU0dCX0hGQU5cIn0se1wiaWRcIjo1MCxcInRpdGxlXCI6XCJCcmF2byAgS1NHQkFfSFpBTlwifSx7XCJpZFwiOjU2LFwidGl0bGVcIjpcIktNR0JBX0haQU5cIn0se1wiaWRcIjo1NyxcInRpdGxlXCI6XCJLTUdCQl9IWkFOXCJ9LHtcImlkXCI6NTIsXCJ0aXRsZVwiOlwiVGVhbSAgS1NHVF9IWkFOXCJ9LHtcImlkXCI6NDcsXCJ0aXRsZVwiOlwiVGl0YW4gR2VuZXNpcyBLU0dYXCJ9LHtcImlkXCI6NTEsXCJ0aXRsZVwiOlwiVHVyaW4gS1NHVV9IWkFOXCJ9XX0sXG4gIC8vICAge1wiaWRcIjo4LFwidGl0bGVcIjpcIk1pZGVhXCIsXCJzZXJpZXNcIjpbe1wiaWRcIjo2MSxcInRpdGxlXCI6XCJCbGFuYyBNU01BXCJ9LHtcImlkXCI6NjAsXCJ0aXRsZVwiOlwiQmxhbmMgTVNNQSBFUlAgKE1BKVwifSx7XCJpZFwiOjU5LFwidGl0bGVcIjpcIk1pc3Npb24gTVNNQiAoTUIpXCJ9LHtcImlkXCI6NTgsXCJ0aXRsZVwiOlwiVWx0aW1hdGUgQ29tZm9ydCBNU01UIChNVClcIn1dfV07XG5cblxuICAvL2xldCBzZXJpZXNOYW1lID0gJyc7XG4gIC8vbGV0IGJyYW5kTmFtZSA9ICcnO1xuXG4gIGNvbnN0IGJyYW5kTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RlbC1jaG9pY2VfX2JyYW5kLWxpc3QnKTtcbiAgY29uc3QgYnJhbmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kZWwtY2hvaWNlX19icmFuZC1jaG9pY2UnKTtcbiAgLy9jb25zdCBicmFuZFNlbGVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RlbC1jaG9pY2VfX3NlbGVjdC1icmFuZCcpO1xuXG4gIGlmICghYnJhbmRMaXN0KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy9sZXQgY3VycmVudEJyYW5kSWR4ID0gLTE7XG4gIC8vbGV0IGN1cnJlbnRPcHRpb25JZHggPSAtMTtcblxuICAvL2NvbnN0IGJyYW5kU2VsZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGVsLWNob2ljZV9fYnJhbmQtc2VsZWN0Jyk7XG4gIC8vY29uc3Qgc2VyaWVzV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RlbC1jaG9pY2VfX3Nlcmllcy13cmFwcGVyJyk7XG4gIC8vY29uc3Qgc2VyaWVzVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2VyaWVzJykuY29udGVudC5xdWVyeVNlbGVjdG9yKCcubW9kZWwtY2hvaWNlX19zZXJpZXMtc2VsZWN0Jyk7XG5cbiAgLy9jb25zdCBsaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGVsLWNob2ljZV9fbGluaycpO1xuXG4gIC8vIGNvbnN0IGdldEhyZWYgPSAoc2VyaWVzKSA9PiB7XG4gIC8vICAgbGV0IGhyZWYgPSAnJztcblxuICAvLyAgIFBBR0VTLmZvckVhY2goKHBhZ2UpID0+IHtcbiAgLy8gICAgIGlmIChocmVmID09PSAnJykge1xuICAvLyAgICAgICBpZiAoc2VyaWVzLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihwYWdlKSAhPT0gLTEpIHtcbiAgLy8gICAgICAgICBocmVmID0gcGFnZTtcbiAgLy8gICAgICAgfVxuICAvLyAgICAgfVxuICAvLyAgIH0pO1xuXG4gIC8vICAgcmV0dXJuIGhyZWYgPT09ICcnID8gJycgOiBocmVmICsgJy5odG1sJztcbiAgLy8gfTtcblxuICBjb25zdCBvbkJyYW5kQ2xpY2sgPSAoKSA9PiB7XG4gICAgaWYgKCFicmFuZExpc3QuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93JykpIHtcbiAgICAgIGJyYW5kTGlzdC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7XG4gICAgICBicmFuZEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdvcGVuZWQnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoYnJhbmRMaXN0LmNsYXNzTGlzdC5jb250YWlucygnc2hvdycpKSB7XG4gICAgICBicmFuZExpc3QuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuICAgICAgYnJhbmRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnb3BlbmVkJyk7XG4gICAgfVxuICAgIC8vIGpRdWVyeSgnLm1vZGVsLWNob2ljZV9fYnJhbmQtbGlzdCcpLm1DdXN0b21TY3JvbGxiYXIoe1xuICAgIC8vICAgc2V0SGVpZ2h0OiAxODksXG4gICAgLy8gICBhdXRvSGlkZVNjcm9sbGJhcjogZmFsc2UsXG4gICAgLy8gICB0aGVtZTogJ2RhcmsnLFxuICAgIC8vICAgbW91c2VXaGVlbFBpeGVsczogMjAwLFxuICAgIC8vICAgY29udGVudFRvdWNoU2Nyb2xsOiB0cnVlXG4gICAgLy8gfSk7XG4gIH07XG5cbiAgLy8gY29uc3Qgb25TZXJpZXNDbGljayA9ICgpID0+IHtcbiAgLy8gICBpZiAoIXNlcmllc0xpc3QuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93JykpIHtcbiAgLy8gICAgIHNlcmllc0xpc3QuY2xhc3NMaXN0LmFkZCgnc2hvdycpO1xuICAvLyAgICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ29wZW5lZCcpO1xuICAvLyAgICAgLy8gY29uc29sZS5sb2coc2VyaWVzTGlzdC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5ib3R0b20gLSB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuICAvLyAgICAgcmV0dXJuO1xuICAvLyAgIH1cblxuICAvLyAgIGlmIChzZXJpZXNMaXN0LmNsYXNzTGlzdC5jb250YWlucygnc2hvdycpKSB7XG4gIC8vICAgICBzZXJpZXNMaXN0LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgLy8gICAgIHNlcmllc0J1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuZWQnKTtcbiAgLy8gICB9XG4gIC8vIH07XG5cbiAgY29uc3Qgb25PdXRzaWRlQ2xpY2sgPSAoZXZ0KSA9PiB7XG4gICAgbGV0IHRhcmdldCA9IGV2dC50YXJnZXQ7XG5cbiAgICBpZiAoXG4gICAgICAhdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kZWwtY2hvaWNlX19icmFuZC1jaG9pY2UnKVxuICAgICAgJiYgIXRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGVsLWNob2ljZV9fYnJhbmQtaXRlbScpXG4gICAgICAmJiAhdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kZWwtY2hvaWNlX19icmFuZC1saXN0JylcbiAgICAgICYmIGJyYW5kTGlzdC5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3cnKVxuICAgICkge1xuICAgICAgYnJhbmRMaXN0LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICAgIGJyYW5kQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW5lZCcpO1xuICAgIH1cblxuICAgIC8vIGlmIChcbiAgICAvLyAgICF0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RlbC1jaG9pY2VfX3Nlcmllcy1jaG9pY2UnKVxuICAgIC8vICAgJiYgIXRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGVsLWNob2ljZV9fc2VyaWVzLWl0ZW0nKVxuICAgIC8vICAgJiYgIXRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGVsLWNob2ljZV9fc2VyaWVzLWxpc3QnKVxuICAgIC8vICAgJiYgc2VyaWVzTGlzdC5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3cnKVxuICAgIC8vICkge1xuICAgIC8vICAgc2VyaWVzTGlzdC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XG4gICAgLy8gICBzZXJpZXNCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnb3BlbmVkJyk7XG4gICAgLy8gfVxuICB9O1xuXG5cbiAgICAvLyBsZXQgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgLy8gbGV0IGkgPSAwO1xuXG4gICAgLy8gYXJyLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAvLyAgIGxldCBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICAvLyAgIG5vZGUudGV4dENvbnRlbnQgPSBpdGVtWyd0aXRsZSddO1xuICAgIC8vICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdtb2RlbC1jaG9pY2VfX2JyYW5kLWl0ZW0nKTtcbiAgICAvLyAgIG5vZGUuc2V0QXR0cmlidXRlKCdkYXRhLWlkJywgaSk7XG4gICAgLy8gICBpKys7XG4gICAgLy8gICBmcmFnbWVudC5hcHBlbmRDaGlsZChub2RlKTtcblxuICAgIC8vICAgLy8gbGV0IHNlcmllc1NlbGVjdCA9IHNlcmllc1RlbXBsYXRlLmNsb25lTm9kZSh0cnVlKTtcbiAgICAvLyAgIC8vIHNlcmllc1NlbGVjdC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICAvLyAgIC8vIHNlcmllc1NlbGVjdC5zZXRBdHRyaWJ1dGUoJ25hbWUnLCBpdGVtWyd0aXRsZSddKTtcblxuICAgIC8vICAgLy8gaXRlbS5zZXJpZXMuZm9yRWFjaCgoc2VyaWUpID0+IHtcbiAgICAvLyAgIC8vICAgbGV0IG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAvLyAgIC8vICAgbm9kZS5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgc2VyaWVbJ3RpdGxlJ10pO1xuICAgIC8vICAgLy8gICBub2RlLnRleHRDb250ZW50ID0gc2VyaWVbJ3RpdGxlJ107XG4gICAgLy8gICAvLyAgIHNlcmllc1NlbGVjdC5hcHBlbmRDaGlsZChub2RlKTtcbiAgICAvLyAgIC8vIH0pO1xuXG4gICAgLy8gICAvLyBzZXJpZXNXcmFwcGVyLmFwcGVuZENoaWxkKHNlcmllc1NlbGVjdCk7XG4gICAgLy8gfSk7XG5cbiAgICAvLyBicmFuZExpc3QuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuXG5cbiAgICAvLyBsZXQgZnJhZ21lbnQxID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIC8vIGxldCBqID0gMDtcblxuICAgIC8vIGFyci5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgLy8gICBsZXQgbm9kZTEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAvLyAgIG5vZGUxLnRleHRDb250ZW50ID0gaXRlbVsndGl0bGUnXTtcbiAgICAvLyAgIG5vZGUxLmNsYXNzTGlzdC5hZGQoJ21vZGVsLWNob2ljZV9fYnJhbmQtb3B0aW9uJyk7XG4gICAgLy8gICBub2RlMS5zZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnLCBpKTtcbiAgICAvLyAgIGorKztcbiAgICAvLyAgIGZyYWdtZW50MS5hcHBlbmRDaGlsZChub2RlMSk7XG5cbiAgICAvLyAgIC8vIGxldCBzZXJpZXNTZWxlY3QgPSBzZXJpZXNUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgLy8gICAvLyBzZXJpZXNTZWxlY3QuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgLy8gICAvLyBzZXJpZXNTZWxlY3Quc2V0QXR0cmlidXRlKCduYW1lJywgaXRlbVsndGl0bGUnXSk7XG5cbiAgICAvLyAgIC8vIGl0ZW0uc2VyaWVzLmZvckVhY2goKHNlcmllKSA9PiB7XG4gICAgLy8gICAvLyAgIGxldCBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgLy8gICAvLyAgIG5vZGUuc2V0QXR0cmlidXRlKCd2YWx1ZScsIHNlcmllWyd0aXRsZSddKTtcbiAgICAvLyAgIC8vICAgbm9kZS50ZXh0Q29udGVudCA9IHNlcmllWyd0aXRsZSddO1xuICAgIC8vICAgLy8gICBzZXJpZXNTZWxlY3QuYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgLy8gICAvLyB9KTtcblxuICAgIC8vICAgLy8gc2VyaWVzV3JhcHBlci5hcHBlbmRDaGlsZChzZXJpZXNTZWxlY3QpO1xuICAgIC8vIH0pO1xuXG4gICAgLy8gYnJhbmRTZWxlY3QuYXBwZW5kQ2hpbGQoZnJhZ21lbnQxKTtcblxuXG5cbiAgICAvLyBjb25zdCBvbkJyYW5kSXRlbUNsaWNrID0gKGV2dCkgPT4ge1xuICAgIC8vICAgbGV0IHRhcmdldCA9IGV2dC50YXJnZXQ7XG4gICAgLy8gICBsZXQgaWR4ID0gK3RhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnKTtcblxuICAgIC8vICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGVsLWNob2ljZV9fYnJhbmQtaXRlbScpKSB7XG4gICAgLy8gICAgIGlmIChjdXJyZW50QnJhbmRJZHggPT09IGlkeCkge1xuICAgIC8vICAgICAgIGJyYW5kTGlzdC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XG4gICAgLy8gICAgICAgYnJhbmRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnb3BlbmVkJyk7XG4gICAgLy8gICAgIH1cblxuICAgIC8vICAgICBpZiAoY3VycmVudEJyYW5kSWR4ICE9PSBpZHgpIHtcbiAgICAvLyAgICAgICBzZXJpZXNMaXN0LmlubmVySFRNTCA9ICcnO1xuXG4gICAgLy8gICAgICAgc2VyaWVzQnV0dG9uLnRleHRDb250ZW50ID0gJ9CS0YvQsdGA0LDRgtGMINC40Lcg0YHQv9C40YHQutCwJztcbiAgICAvLyAgICAgICBzZXJpZXNCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTtcblxuICAgIC8vICAgICAgIGxldCBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAvLyAgICAgICBsZXQgaWR4ID0gK3RhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnKTtcblxuICAgIC8vICAgICAgIGFycltpZHhdLnNlcmllcy5mb3JFYWNoKChzZXJpZSkgPT4ge1xuICAgIC8vICAgICAgICAgbGV0IG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAgIC8vICAgICAgICAgbm9kZS50ZXh0Q29udGVudCA9IHNlcmllWyd0aXRsZSddO1xuICAgIC8vICAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdtb2RlbC1jaG9pY2VfX3Nlcmllcy1pdGVtJyk7XG4gICAgLy8gICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChub2RlKTtcbiAgICAvLyAgICAgICB9KTtcblxuICAgIC8vICAgICAgIHNlcmllc0xpc3QuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuICAgIC8vICAgICAgIGN1cnJlbnRCcmFuZElkeCA9IGlkeDtcblxuICAgIC8vICAgICAgIGJyYW5kQnV0dG9uLnRleHRDb250ZW50ID0gdGFyZ2V0LnRleHRDb250ZW50O1xuICAgIC8vICAgICAgIGJyYW5kTmFtZSA9IHRhcmdldC50ZXh0Q29udGVudDtcbiAgICAvLyAgICAgICBpZiAoIWJyYW5kQnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkge1xuICAgIC8vICAgICAgICAgYnJhbmRCdXR0b24uY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTtcbiAgICAvLyAgICAgICB9XG5cbiAgICAvLyAgICAgICBpZiAoc2VyaWVzQnV0dG9uLmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgIC8vICAgICAgICAgc2VyaWVzQnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICAvLyAgICAgICB9XG5cbiAgICAvLyAgICAgICBicmFuZExpc3QuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuICAgIC8vICAgICAgIGJyYW5kQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW5lZCcpO1xuXG4gICAgLy8gICAgICAgbGluay5jbGFzc0xpc3QuYWRkKCdkaXNhYmxlZCcpO1xuICAgIC8vICAgICAgIGxpbmsucmVtb3ZlQXR0cmlidXRlKCdocmVmJyk7XG4gICAgLy8gICAgIH1cbiAgICAvLyAgIH1cbiAgICAvLyB9XG5cbiAgICAvLyBjb25zdCBvbkJyYW5kQ2hhbmdlID0gKGV2dCkgPT4ge1xuICAgIC8vICAgY3VycmVudE9wdGlvbklkeCA9IGV2dC50YXJnZXQuc2VsZWN0ZWRJbmRleCAtIDE7XG4gICAgLy8gICBzZXJpZXNTZWxlY3QuaW5uZXJIVE1MID0gJyc7XG5cbiAgICAvLyAgIHNlcmllc0J1dHRvbi50ZXh0Q29udGVudCA9ICfQktGL0LHRgNCw0YLRjCDQuNC3INGB0L/QuNGB0LrQsCc7XG4gICAgLy8gICBzZXJpZXNCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTtcblxuICAgIC8vICAgbGV0IG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAvLyAgIG5vZGUudGV4dENvbnRlbnQgPSAnJztcbiAgICAvLyAgIG5vZGUuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgICAvLyAgIG5vZGUuc2V0QXR0cmlidXRlKCdzZWxlY3RlZCcsICcnKTtcbiAgICAvLyAgIG5vZGUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblxuICAgIC8vICAgc2VyaWVzU2VsZWN0LmFwcGVuZENoaWxkKG5vZGUpO1xuXG4gICAgLy8gICBsZXQgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG5cbiAgICAvLyAgIGlmIChzZXJpZXNTZWxlY3QuaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XG4gICAgLy8gICAgIHNlcmllc1NlbGVjdC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgLy8gICB9XG5cblxuICAgIC8vICAgYXJyW2N1cnJlbnRPcHRpb25JZHhdLnNlcmllcy5mb3JFYWNoKChzZXJpZSkgPT4ge1xuICAgIC8vICAgICBsZXQgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xuICAgIC8vICAgICBub2RlLnRleHRDb250ZW50ID0gc2VyaWVbJ3RpdGxlJ107XG4gICAgLy8gICAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnbW9kZWwtY2hvaWNlX19zZXJpZXMtb3B0aW9uJyk7XG4gICAgLy8gICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKG5vZGUpO1xuICAgIC8vICAgfSk7XG5cbiAgICAvLyAgIHNlcmllc1NlbGVjdC5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG5cbiAgICAvLyAgIGJyYW5kQnV0dG9uLnRleHRDb250ZW50ID0gZXZ0LnRhcmdldC52YWx1ZTtcbiAgICAvLyAgIGJyYW5kTmFtZSA9IGV2dC50YXJnZXQudmFsdWU7XG4gICAgLy8gICBpZiAoIWJyYW5kQnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkge1xuICAgIC8vICAgICBicmFuZEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpO1xuICAgIC8vICAgfVxuXG4gICAgLy8gICBsaW5rLmNsYXNzTGlzdC5hZGQoJ2Rpc2FibGVkJyk7XG4gICAgLy8gICBsaW5rLnJlbW92ZUF0dHJpYnV0ZSgnaHJlZicpO1xuICAgIC8vIH1cblxuICAgIC8vIGNvbnN0IG9uU2VyaWVzSXRlbUNsaWNrID0gKGV2dCkgPT4ge1xuICAgIC8vICAgbGV0IHRhcmdldCA9IGV2dC50YXJnZXQ7XG5cbiAgICAvLyAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RlbC1jaG9pY2VfX3Nlcmllcy1pdGVtJykpIHtcbiAgICAvLyAgICAgc2VyaWVzQnV0dG9uLnRleHRDb250ZW50ID0gdGFyZ2V0LnRleHRDb250ZW50O1xuICAgIC8vICAgICBpZiAoIXNlcmllc0J1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAvLyAgICAgICBzZXJpZXNCdXR0b24uY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTtcbiAgICAvLyAgICAgfVxuXG4gICAgLy8gICAgIHNlcmllc0xpc3QuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuICAgIC8vICAgICBzZXJpZXNCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnb3BlbmVkJyk7XG5cbiAgICAvLyAgICAgbGluay5jbGFzc0xpc3QucmVtb3ZlKCdkaXNhYmxlZCcpO1xuICAgIC8vICAgICBzZXJpZXNOYW1lID0gdGFyZ2V0LnRleHRDb250ZW50O1xuICAgIC8vICAgICBsaW5rLnNldEF0dHJpYnV0ZSgnaHJlZicsIGdldEhyZWYoc2VyaWVzTmFtZSkpO1xuICAgIC8vICAgfVxuICAgIC8vIH1cblxuICAgIC8vIGNvbnN0IG9uU2VyaWVzQ2hhbmdlID0gKGV2dCkgPT4ge1xuICAgIC8vICAgc2VyaWVzQnV0dG9uLnRleHRDb250ZW50ID0gZXZ0LnRhcmdldC52YWx1ZTtcbiAgICAvLyAgIGlmICghc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkge1xuICAgIC8vICAgICBzZXJpZXNCdXR0b24uY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTtcbiAgICAvLyAgIH1cblxuICAgIC8vICAgbGluay5jbGFzc0xpc3QucmVtb3ZlKCdkaXNhYmxlZCcpO1xuICAgIC8vICAgc2VyaWVzTmFtZSA9IGV2dC50YXJnZXQudmFsdWU7XG4gICAgLy8gICBsaW5rLnNldEF0dHJpYnV0ZSgnaHJlZicsIGdldEhyZWYoc2VyaWVzTmFtZSkpO1xuICAgIC8vIH1cblxuICAgIC8vIGNvbnN0IG9uTGlua0NsaWNrID0gKGV2dCkgPT4ge1xuICAgIC8vICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgLy8gICBsZXQgaHJlZiA9IGV2dC50YXJnZXQuZ2V0QXR0cmlidXRlKCdocmVmJyk7XG5cbiAgICAvLyAgIGlmIChocmVmID09PSAnJykge1xuICAgIC8vICAgICBhbGVydCgn0JjQvdGB0YLRgNGD0LrRhtC40Y8g0L/QviDRg9GB0YLQsNC90L7QstC60LUgV2ktRmkg0LrQvtC90YLRgNC+0LvQu9C10YDQsCDQtNC70Y8g0LTQsNC90L3QvtC5INGB0LXRgNC40Lgg0LrQvtC90LTQuNGG0LjQvtC90LXRgNCwINCyINGB0LrQvtGA0L7QvCDQstGA0LXQvNC10L3QuCDQv9C+0Y/QstC40YLRgdGPLicpO1xuXG4gICAgLy8gICAgIHJldHVybjtcbiAgICAvLyAgIH1cblxuICAgIC8vICAgZG9jdW1lbnQubG9jYXRpb24uaHJlZiA9IGhyZWY7XG4gICAgLy8gfTtcblxuICAgIC8vbGV0IHNwbGl0c0RhdGEgPSBiYWNrZW5kLmxvYWQoZ2V0RGF0YSk7XG5cbiAgICAvL2JyYW5kU2VsZWN0LmFwcGVuZENoaWxkKG1ha2VPcHRpb25Ob2RlKHNwbGl0cykpO1xuICAgIC8vbWFrZU9wdGlvbk5vZGUoc3BsaXRzKTtcbiAgICAvL2JhY2tlbmQubG9hZChtYWtlT3B0aW9uTm9kZSk7XG5cblxuICAgIC8vIG1ha2VTZWxlY3QoYnJhbmRDbGFzcyk7XG4gICAgLy8gbWFrZVNlbGVjdChzZXJpZXNDbGFzcyk7XG5cbiAgICAvLyBqUXVlcnkoYnJhbmRDbGFzcykuc2VsZWN0Mignb3BlbicpO1xuICAgIC8vIGpRdWVyeShicmFuZENsYXNzKS5zZWxlY3QyKCdjbG9zZScpO1xuXG5cbiAgICAvLyBjb25zdCBzZXJpZXNTZWxlY3RzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1vZGVsLWNob2ljZV9fc2VyaWVzLXNlbGVjdCcpO1xuXG5cbiAgICAvLyBjb25zdCBoaWRlU2VyaWVzID0gKCkgPT4ge1xuICAgIC8vICAgc2VyaWVzU2VsZWN0cy5mb3JFYWNoKChzZWxlY3QpID0+IHtcbiAgICAvLyAgICAgaWYgKCFzZWxlY3QuY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRkZW4nKSkge1xuICAgIC8vICAgICAgIHNlbGVjdC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICAvLyAgICAgICBzZWxlY3QucmVtb3ZlQXR0cmlidXRlKCdpZCcpO1xuICAgIC8vICAgICB9XG4gICAgLy8gICB9KVxuICAgIC8vIH07XG5cbiAgICAvLyBjb25zdCBzaG93U2VyaWVzID0gKGlkeCkgPT4ge1xuICAgIC8vICAgc2VyaWVzU2VsZWN0c1tpZHhdLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgIC8vICAgc2VyaWVzU2VsZWN0c1tpZHhdLnNldEF0dHJpYnV0ZSgnaWQnLCAnc2VyaWVzLXNlbGVjdCcpO1xuICAgIC8vIH07XG5cbiAgICAvLyBqUXVlcnkoYnJhbmRDbGFzcykub24oJ2NoYW5nZScsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAvLyAgIGxldCBpZHggPSAralF1ZXJ5KCcubW9kZWwtY2hvaWNlX19icmFuZC1zZWxlY3Qgb3B0aW9uOnNlbGVjdGVkJykuYXR0cignZGF0YS1pZCcpO1xuXG4gICAgLy8gICBoaWRlU2VyaWVzKCk7XG4gICAgLy8gICBzaG93U2VyaWVzKGlkeCArIDEpO1xuXG4gICAgLy8gICBqUXVlcnkoJyNzZXJpZXMtc2VsZWN0Jykuc2VsZWN0Mignb3BlbicpO1xuICAgIC8vICAgalF1ZXJ5KCcjc2VyaWVzLXNlbGVjdCcpLnNlbGVjdDIoJ2Nsb3NlJyk7XG5cbiAgICAvLyAgIGpRdWVyeSgnLm1vZGVsLWNob2ljZV9fYnJhbmQtc2VsZWN0JykuYWRkQ2xhc3MoJ3NlbGVjdGVkJyk7XG4gICAgLy8gICBqUXVlcnkoJy5tb2RlbC1jaG9pY2VfX3Nlcmllcy1zZWxlY3QnKS5yZW1vdmVDbGFzcygnc2VsZWN0ZWQnKTtcbiAgICAvLyB9KTtcblxuICAgIC8vIGpRdWVyeShzZXJpZXNDbGFzcykub24oJ2NoYW5nZScsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAvLyAgIGlmIChsaW5rLmNsYXNzTGlzdC5jb250YWlucygnZGlzYWJsZWQnKSkge1xuICAgIC8vICAgICBsaW5rLmNsYXNzTGlzdC5yZW1vdmUoJ2Rpc2FibGVkJyk7XG4gICAgLy8gICB9XG5cbiAgICAvLyAgIGxldCB2YWx1ZSA9IGpRdWVyeShldnQudGFyZ2V0KS5jaGlsZHJlbignb3B0aW9uOnNlbGVjdGVkJykudGV4dCgpO1xuICAgIC8vICAgc2VyaWVzTmFtZSA9IHZhbHVlO1xuXG5cbiAgICAvLyAgIGxpbmsuc2V0QXR0cmlidXRlKCdocmVmJywgc2VyaWVzTmFtZSk7XG5cbiAgICAvLyAgIGpRdWVyeSgnLm1vZGVsLWNob2ljZV9fc2VyaWVzLXNlbGVjdCcpLmFkZENsYXNzKCdzZWxlY3RlZCcpO1xuICAgIC8vIH0pO1xuXG4gICAgLy9SZXNpemUuaW5pdCgpO1xuICAgIC8vUmVzaXplLmFkZExpc3RlbmVyKCk7XG5cbiAgICBicmFuZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQnJhbmRDbGljayk7XG4gICAgLy9zZXJpZXNCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvblNlcmllc0NsaWNrKTtcbiAgICAvLyBicmFuZExpc3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkJyYW5kSXRlbUNsaWNrKTtcbiAgICAvLyBzZXJpZXNMaXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25TZXJpZXNJdGVtQ2xpY2spO1xuICAgIC8vIGJyYW5kU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uQnJhbmRDaGFuZ2UpO1xuICAgIC8vIHNlcmllc1NlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvblNlcmllc0NoYW5nZSk7XG4gICAgLy8gbGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uTGlua0NsaWNrKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBvbk91dHNpZGVDbGljayk7XG5cblxuICAvL2JhY2tlbmQubG9hZChtYWtlT3B0aW9uTm9kZSk7XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmVxdWlwbWVudF9fd3JhcHBlcicpO1xuICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZXF1aXBtZW50X19jb250YWluZXInKTtcblxuICBpZighd3JhcHBlcikge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGluaXRTd2lwZXIgPSAoKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBTd2lwZXIoJy5lcXVpcG1lbnRfX2NvbnRhaW5lcicsIHtcbiAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgZWw6ICcuZXF1aXBtZW50X19wYWdpbmF0aW9uJyxcbiAgICAgICAgdHlwZTogJ2J1bGxldHMnLFxuICAgICAgfSxcbiAgICAgIGxvb3A6IHRydWUsXG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgYWRkU2xpZGVDbGFzcyA9IChlbGVtZW50KSA9PiB7XG4gICAgbGV0IGl0ZW1zID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZXF1aXBtZW50X19pdGVtJyk7XG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKCdzd2lwZXItc2xpZGUnKTtcbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCByZW5kZXJTbGlkZXIgPSAoKSA9PiB7XG4gICAgbGV0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuXG4gICAgbGV0IHdyYXBwZXJOb2RlID0gd3JhcHBlci5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgd3JhcHBlck5vZGUuY2xhc3NOYW1lID0gJ2VxdWlwbWVudF9fc2xpZGUtd3JhcHBlcic7XG4gICAgd3JhcHBlck5vZGUuY2xhc3NMaXN0LmFkZCgnc3dpcGVyLXdyYXBwZXInKTtcblxuICAgIGxldCBwYWdpbmF0aW9uTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHBhZ2luYXRpb25Ob2RlLmNsYXNzTGlzdC5hZGQoJ2VxdWlwbWVudF9fcGFnaW5hdGlvbicpO1xuICAgIHBhZ2luYXRpb25Ob2RlLmNsYXNzTGlzdC5hZGQoJ3N3aXBlci1wYWdpbmF0aW9uJyk7XG5cbiAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCh3cmFwcGVyTm9kZSk7XG4gICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQocGFnaW5hdGlvbk5vZGUpO1xuXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGZyYWdtZW50KTtcbiAgICBhZGRTbGlkZUNsYXNzKGNvbnRhaW5lcik7XG5cbiAgICBpbml0U3dpcGVyKCk7XG4gIH07XG5cbiAgcmVuZGVyU2xpZGVyKCk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgY29uc3Qgd3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9jZXNzX193cmFwcGVyJyk7XG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9jZXNzX19jb250YWluZXInKTtcblxuICBpZiAoIXdyYXBwZXIpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBpbml0U3dpcGVyID0gKCkgPT4ge1xuICAgIHJldHVybiBuZXcgU3dpcGVyKCcucHJvY2Vzc19fY29udGFpbmVyJywge1xuICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICBlbDogJy5wcm9jZXNzX19wYWdpbmF0aW9uJyxcbiAgICAgICAgdHlwZTogJ2J1bGxldHMnLFxuICAgICAgfSxcbiAgICAgIGxvb3A6IHRydWUsXG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgYWRkU2xpZGVDbGFzcyA9IChlbGVtZW50KSA9PiB7XG4gICAgbGV0IGl0ZW1zID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucHJvY2Vzc19faXRlbScpO1xuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgnc3dpcGVyLXNsaWRlJyk7XG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgYWRkTnVtYmVyaW5nID0gKHN3aXBlcikgPT4ge1xuICAgIGNvbnN0IG51bWJlckZpZWxkID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5wcm9jZXNzX19udW1iZXInKTtcblxuICAgIHN3aXBlci5vbignc2xpZGVDaGFuZ2UnLCAoKSA9PiB7XG4gICAgICBudW1iZXJGaWVsZC50ZXh0Q29udGVudCA9IHN3aXBlci5yZWFsSW5kZXggKyAxO1xuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IHJlbmRlclNsaWRlciA9ICgpID0+IHtcbiAgICBsZXQgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG5cbiAgICBsZXQgd3JhcHBlck5vZGUgPSB3cmFwcGVyLmNsb25lTm9kZSh0cnVlKTtcbiAgICB3cmFwcGVyTm9kZS5jbGFzc05hbWUgPSAncHJvY2Vzc19fc2xpZGUtd3JhcHBlcic7XG4gICAgd3JhcHBlck5vZGUuY2xhc3NMaXN0LmFkZCgnc3dpcGVyLXdyYXBwZXInKTtcblxuICAgIGxldCBwYWdpbmF0aW9uTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHBhZ2luYXRpb25Ob2RlLmNsYXNzTGlzdC5hZGQoJ3Byb2Nlc3NfX3BhZ2luYXRpb24nKTtcbiAgICBwYWdpbmF0aW9uTm9kZS5jbGFzc0xpc3QuYWRkKCdzd2lwZXItcGFnaW5hdGlvbicpO1xuXG4gICAgbGV0IG51bWJlck5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBudW1iZXJOb2RlLmNsYXNzTmFtZSA9ICdwcm9jZXNzX19udW1iZXInO1xuICAgIG51bWJlck5vZGUudGV4dENvbnRlbnQgPSAxO1xuXG4gICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQod3JhcHBlck5vZGUpO1xuICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKHBhZ2luYXRpb25Ob2RlKTtcbiAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChudW1iZXJOb2RlKTtcblxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG4gICAgYWRkU2xpZGVDbGFzcyhjb250YWluZXIpO1xuXG4gICAgY29uc3QgcHJvY2Vzc1N3aXBlciA9IGluaXRTd2lwZXIoKTtcbiAgICBhZGROdW1iZXJpbmcocHJvY2Vzc1N3aXBlcik7XG4gIH07XG5cbiAgcmVuZGVyU2xpZGVyKCk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtbW9kZWxfX2Zvcm0nKTtcblxuICBjb25zdCBlbWFpbElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImlucHV0W25hbWU9J2VtYWlsJ11cIik7XG4gIGNvbnN0IGVtYWlsRXJyb3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLW1vZGVsX19lbWFpbC1lcnJvcicpO1xuXG4gIGNvbnN0IGJyYW5kSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRbbmFtZT0nYnJhbmQnXVwiKTtcbiAgY29uc3QgYnJhbmRFcnJvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtbW9kZWxfX2JyYW5kLWVycm9yJyk7XG5cbiAgY29uc3QgbW9kZWxJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJpbnB1dFtuYW1lPSdtb2RlbCddXCIpO1xuICBjb25zdCBtb2RlbEVycm9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC1tb2RlbF9fbW9kZWwtZXJyb3InKTtcblxuICBjb25zdCBmaWxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRbdHlwZT0nZmlsZSddXCIpO1xuXG4gIGNvbnN0IGNoZWNrYm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC1tb2RlbF9fYWdyZWVtZW50LWlucHV0Jyk7XG5cbiAgY29uc3Qgc3VibWl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC1tb2RlbF9fc3VibWl0Jyk7XG5cbiAgY29uc3QgcHJvZ3Jlc3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLW1vZGVsX19maWxlLXByb2dyZXNzJyk7XG4gIGNvbnN0IGJhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtbW9kZWxfX2Jhci1jdXJyZW50Jyk7XG5cbiAgY29uc3QgZmlsZVJlc3VsdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtbW9kZWxfX2ZpbGUtcmVzdWx0Jyk7XG4gIGNvbnN0IGZpbGVJbWcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLW1vZGVsX19maWxlLWltYWdlJyk7XG4gIGNvbnN0IGZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC1tb2RlbF9fZmlsZS1uYW1lJyk7XG4gIGNvbnN0IGZpbGVDbGVhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtbW9kZWxfX2ZpbGUtY2xvc2UnKTtcblxuICBpZiAoIWVtYWlsSW5wdXQpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBhZGRDbGFzc05hbWUgPSAoZWxlbWVudCwgY2xhc3NOYW1lKSA9PiB7XG4gICAgaWYgKCFlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpKSB7XG4gICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgcmVtb3ZlQ2xhc3NOYW1lID0gKGVsZW1lbnQsIGNsYXNzTmFtZSkgPT4ge1xuICAgIGlmIChlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpKSB7XG4gICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgZW5hYmxlQnV0dG9uID0gKCkgPT4ge1xuICAgIHN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykgJiYgc3VibWl0LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgfTtcblxuICBjb25zdCBkaXNhYmxlQnV0dG9uID0gKCkgPT4ge1xuICAgICFzdWJtaXQuaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpICYmIHN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICB9O1xuXG4gIGNvbnN0IGlzRm9ybUZpbGxlZCA9ICgpID0+IHtcbiAgICByZXR1cm4gZW1haWxJbnB1dC52YWxpZGl0eS52YWxpZFxuICAgICAgJiYgYnJhbmRJbnB1dC52YWx1ZSAhPT0gJydcbiAgICAgICYmIG1vZGVsSW5wdXQudmFsdWUgIT09ICcnXG4gICAgICAmJiBjaGVja2JveC5jaGVja2VkXG4gIH07XG5cbiAgY29uc3QgY2hlY2tGb3JtID0gKCkgPT4ge1xuICAgIGlmIChpc0Zvcm1GaWxsZWQoKSkge1xuICAgICAgZW5hYmxlQnV0dG9uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRpc2FibGVCdXR0b24oKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgcmVhZFVybCA9IChpbnB1dCkgPT4ge1xuICAgIGlmIChpbnB1dC5maWxlcyAmJiBpbnB1dC5maWxlc1swXSkge1xuICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG5cbiAgICAgIHJlYWRlci5vbmxvYWRzdGFydCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHByb2dyZXNzLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTtcbiAgICAgIH1cblxuICAgICAgcmVhZGVyLm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhNYXRoLnJvdW5kKGUubG9hZGVkIC8gZS50b3RhbCAqIDEwMCkpO1xuICAgICAgICBiYXIuc3R5bGUud2lkdGggPSBNYXRoLnJvdW5kKGUubG9hZGVkIC8gZS50b3RhbCAqIDEwMCkgKyAnJSc7XG4gICAgICB9XG5cbiAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBmaWxlSW1nLnNldEF0dHJpYnV0ZSgnc3JjJywgZS50YXJnZXQucmVzdWx0KTtcbiAgICAgICAgZmlsZU5hbWUudGV4dENvbnRlbnQgPSBpbnB1dC5maWxlc1swXS5uYW1lO1xuICAgICAgICAhZmlsZVJlc3VsdC5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3cnKSAmJiBmaWxlUmVzdWx0LmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTtcblxuICAgICAgICBwcm9ncmVzcy5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XG4gICAgICAgIGJhci5zdHlsZS53aWR0aCA9IDA7XG4gICAgICB9XG5cbiAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGlucHV0LmZpbGVzWzBdKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBvblRleHRGb2N1cyA9IChldnQpID0+IHtcbiAgICBjb25zdCBpbnB1dCA9IGV2dC50YXJnZXQ7XG5cbiAgICBhZGRDbGFzc05hbWUoaW5wdXQsICdmaWxsJyk7XG5cbiAgICBpZiAoaW5wdXQudmFsdWUgPT09ICcnKSB7XG4gICAgICBhZGRDbGFzc05hbWUoaW5wdXQsICdtYXNrJyk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IG9uVGV4dEJsdXIgPSAoZXZ0KSA9PiB7XG4gICAgY29uc3QgaW5wdXQgPSBldnQudGFyZ2V0O1xuXG4gICAgaWYgKCFpbnB1dC52YWx1ZSkge1xuICAgICAgcmVtb3ZlQ2xhc3NOYW1lKGlucHV0LCAnZmlsbCcpO1xuICAgIH1cblxuICAgIHJlbW92ZUNsYXNzTmFtZShpbnB1dCwgJ21hc2snKTtcbiAgfVxuXG4gIGNvbnN0IG9uRW1haWxJbnB1dCA9IChldnQpID0+IHtcbiAgICBjb25zdCBpbnB1dCA9IGV2dC50YXJnZXQ7XG5cbiAgICAvLyBpZiAoaW5wdXQudmFsdWUgPT09ICcnKSB7XG4gICAgLy8gICBhZGRDbGFzc05hbWUoaW5wdXQsICdtYXNrJyk7XG4gICAgLy8gICBhZGRDbGFzc05hbWUoaW5wdXQsICdlcnJvcicpO1xuICAgIC8vIH1cblxuICAgIGlmICghZW1haWxJbnB1dC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgYWRkQ2xhc3NOYW1lKGVtYWlsRXJyb3IsICdzaG93Jyk7XG4gICAgICBhZGRDbGFzc05hbWUoZW1haWxJbnB1dCwgJ2Vycm9yJyk7XG4gICAgfVxuXG4gICAgaWYgKGVtYWlsSW5wdXQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHJlbW92ZUNsYXNzTmFtZShpbnB1dCwgJ2Vycm9yJyk7XG4gICAgICByZW1vdmVDbGFzc05hbWUoZW1haWxFcnJvciwgJ3Nob3cnKTtcbiAgICB9XG5cbiAgICBpZiAoaW5wdXQudmFsdWUgPT09ICcnKSB7XG4gICAgICBhZGRDbGFzc05hbWUoaW5wdXQsICdtYXNrJyk7XG4gICAgfVxuXG4gICAgaWYgKGlucHV0LnZhbHVlICE9PSAnJykge1xuICAgICAgcmVtb3ZlQ2xhc3NOYW1lKGlucHV0LCAnbWFzaycpO1xuICAgIH1cblxuICAgIGNoZWNrRm9ybSgpO1xuICB9XG5cbiAgY29uc3Qgb25CcmFuZElucHV0ID0gKGV2dCkgPT4ge1xuICAgIGNvbnN0IGlucHV0ID0gZXZ0LnRhcmdldDtcblxuICAgIGlmIChpbnB1dC52YWx1ZSA9PT0gJycpIHtcbiAgICAgIGFkZENsYXNzTmFtZShpbnB1dCwgJ21hc2snKTtcbiAgICAgIGFkZENsYXNzTmFtZShpbnB1dCwgJ2Vycm9yJyk7XG4gICAgICBhZGRDbGFzc05hbWUoYnJhbmRFcnJvciwgJ3Nob3cnKTtcbiAgICB9XG5cbiAgICBpZiAoaW5wdXQudmFsdWUgIT09ICcnKSB7XG4gICAgICByZW1vdmVDbGFzc05hbWUoaW5wdXQsICdtYXNrJyk7XG4gICAgICByZW1vdmVDbGFzc05hbWUoaW5wdXQsICdlcnJvcicpO1xuICAgICAgcmVtb3ZlQ2xhc3NOYW1lKGJyYW5kRXJyb3IsICdzaG93Jyk7XG4gICAgfVxuXG4gICAgY2hlY2tGb3JtKCk7XG4gIH1cblxuICBjb25zdCBvbk1vZGVsSW5wdXQgPSAoZXZ0KSA9PiB7XG4gICAgY29uc3QgaW5wdXQgPSBldnQudGFyZ2V0O1xuXG4gICAgaWYgKGlucHV0LnZhbHVlID09PSAnJykge1xuICAgICAgYWRkQ2xhc3NOYW1lKGlucHV0LCAnbWFzaycpO1xuICAgICAgYWRkQ2xhc3NOYW1lKGlucHV0LCAnZXJyb3InKTtcbiAgICAgIGFkZENsYXNzTmFtZShtb2RlbEVycm9yLCAnc2hvdycpO1xuICAgIH1cblxuICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gJycpIHtcbiAgICAgIHJlbW92ZUNsYXNzTmFtZShpbnB1dCwgJ21hc2snKTtcbiAgICAgIHJlbW92ZUNsYXNzTmFtZShpbnB1dCwgJ2Vycm9yJyk7XG4gICAgICByZW1vdmVDbGFzc05hbWUobW9kZWxFcnJvciwgJ3Nob3cnKTtcbiAgICB9XG5cbiAgICBjaGVja0Zvcm0oKTtcbiAgfVxuXG4gIGNvbnN0IG9uRmlsZUNsZWFyID0gKCkgPT4ge1xuICAgIGZpbGVJbnB1dC52YWx1ZSA9ICcnO1xuXG4gICAgaWYoIS9zYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKXtcbiAgICAgIGZpbGVJbnB1dC50eXBlID0gJyc7XG4gICAgICBmaWxlSW5wdXQudHlwZSA9ICdmaWxlJztcbiAgICB9XG5cbiAgICBmaWxlUmVzdWx0LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICBmaWxlTmFtZS50ZXh0Q29udGVudCA9ICcnO1xuICAgIGZpbGVJbWcucmVtb3ZlQXR0cmlidXRlKCdzcmMnKTtcbiAgfVxuXG4gIGNvbnN0IG9uRmlsZUNoYW5nZSA9IChldnQpID0+IHtcbiAgICByZWFkVXJsKGV2dC50YXJnZXQpO1xuICB9XG5cbiAgY29uc3Qgb25DaGVja2JveENsaWNrID0gKCkgPT4ge1xuICAgICFjaGVja2JveC5jaGVja2VkXG4gICAgICA/IGFkZENsYXNzTmFtZShjaGVja2JveCwgJ2Vycm9yJylcbiAgICAgIDogcmVtb3ZlQ2xhc3NOYW1lKGNoZWNrYm94LCAnZXJyb3InKTtcblxuICAgIGNoZWNrRm9ybSgpO1xuICB9XG5cbiAgY29uc3Qgb25TdWJtaXQgPSAoZXZ0KSA9PiB7XG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBmb3JtLnN1Ym1pdCgpO1xuICB9XG5cbiAgZW1haWxJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIG9uVGV4dEZvY3VzKTtcbiAgZW1haWxJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgb25UZXh0Qmx1cik7XG4gIGVtYWlsSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbkVtYWlsSW5wdXQpO1xuXG4gIGJyYW5kSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCBvblRleHRGb2N1cyk7XG4gIGJyYW5kSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIG9uVGV4dEJsdXIpO1xuICBicmFuZElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25CcmFuZElucHV0KTtcblxuICBtb2RlbElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgb25UZXh0Rm9jdXMpO1xuICBtb2RlbElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBvblRleHRCbHVyKTtcbiAgbW9kZWxJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uTW9kZWxJbnB1dCk7XG5cbiAgZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uRmlsZUNoYW5nZSk7XG4gIGZpbGVDbGVhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uRmlsZUNsZWFyKTtcblxuICBjaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2hlY2tib3hDbGljayk7XG5cbiAgc3VibWl0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25TdWJtaXQpO1xufSkoKTtcbiJdfQ==
