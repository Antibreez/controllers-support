new Swiper(".model__image-container",{pagination:{el:".model__pagination",type:"bullets",clickable:!0},loop:!0}),function(){const e=document.querySelectorAll(".device__wire-dote span"),t=document.querySelectorAll(".device__wire-popup-mobile"),o=document.querySelectorAll(".device__wire-popup-close"),s=document.querySelector(".device__wire-popup-overlay");if(!e[0])return;e.forEach((e,o)=>{e.addEventListener("click",()=>{t[o].classList.add("js--show"),s.classList.add("js--show")})}),o.forEach((e,o)=>{e.addEventListener("click",()=>{t[o].classList.remove("js--show"),s.classList.remove("js--show")})}),s.addEventListener("click",()=>{t.forEach(e=>{e.classList.contains("js--show")&&e.classList.remove("js--show")}),s.classList.remove("js--show")})}(),document.getElementById("animation")&&lottie.loadAnimation({container:document.getElementById("animation"),renderer:"svg",loop:!0,autoplay:!0,path:"data.json"}),function(){var e="https://split.daichicloud.ru/brands/all",t="GET",o=200,s=300,n=function(e,t){var n=new XMLHttpRequest;return n.timeout=1e4,n.responseType="json",n.addEventListener("load",(function(){!function(e){return e.status<o||e.status>s}(n)?e(n.response):t("Данные не загрузились. Причина: "+n.status+" "+n.statusText)})),n.addEventListener("error",(function(){t("Произошла ошибка соединения")})),n.addEventListener("timeout",(function(){t("Запрос не успел выполниться за "+n.timeout+"мс")})),n},r=function(e){e.remove()},a=function(e){var t=document.createElement("div");t.style="z-index: 100; margin: 0 auto; text-align: center; background-color: red;",t.style.position="absolute",t.style.left=0,t.style.right=0,t.style.fontSize="30px",t.textContent=e,document.body.insertAdjacentElement("afterbegin",t),window.setTimeout(r,2e3,t)};window.backend={load:function(o,s){var r=n(o,s||a);r.open(t,e),r.send()}}}(),jQuery,function(){const e=document.querySelector(".model-choice__brand-list"),t=document.querySelector(".model-choice__brand-choice");if(!e)return;t.addEventListener("click",()=>{if(!e.classList.contains("show"))return e.classList.add("show"),void t.classList.add("opened");e.classList.contains("show")&&(e.classList.remove("show"),t.classList.remove("opened"))}),document.addEventListener("mousedown",o=>{let s=o.target;s.classList.contains("model-choice__brand-choice")||s.classList.contains("model-choice__brand-item")||s.classList.contains("model-choice__brand-list")||!e.classList.contains("show")||(e.classList.remove("show"),t.classList.remove("opened"))})}(),function(){const e=document.querySelector(".equipment__wrapper"),t=document.querySelector(".equipment__container");if(!e)return;(()=>{let o=document.createDocumentFragment(),s=e.cloneNode(!0);s.className="equipment__slide-wrapper",s.classList.add("swiper-wrapper");let n=document.createElement("div");n.classList.add("equipment__pagination"),n.classList.add("swiper-pagination"),o.appendChild(s),o.appendChild(n),t.appendChild(o),t.querySelectorAll(".equipment__item").forEach(e=>{e.classList.add("swiper-slide")}),new Swiper(".equipment__container",{pagination:{el:".equipment__pagination",type:"bullets"},loop:!0})})()}(),function(){const e=document.querySelector(".process__wrapper"),t=document.querySelector(".process__container");if(!e)return;(()=>{let o=document.createDocumentFragment(),s=e.cloneNode(!0);s.className="process__slide-wrapper",s.classList.add("swiper-wrapper");let n=document.createElement("div");n.classList.add("process__pagination"),n.classList.add("swiper-pagination");let r=document.createElement("div");r.className="process__number",r.textContent=1,o.appendChild(s),o.appendChild(n),o.appendChild(r),t.appendChild(o),t.querySelectorAll(".process__item").forEach(e=>{e.classList.add("swiper-slide")});(e=>{const o=t.querySelector(".process__number");e.on("slideChange",()=>{o.textContent=e.realIndex+1})})(new Swiper(".process__container",{pagination:{el:".process__pagination",type:"bullets"},loop:!0}))})()}(),function(){const e=document.querySelector(".add-model__form"),t=document.querySelector("input[name='email']"),o=document.querySelector(".add-model__email-error"),s=document.querySelector("input[name='brand']"),n=document.querySelector(".add-model__brand-error"),r=document.querySelector("input[name='model']"),a=document.querySelector(".add-model__model-error"),i=document.querySelector("input[type='file']"),d=document.querySelector(".add-model__agreement-input"),c=document.querySelector(".add-model__submit"),l=document.querySelector(".add-model__file-progress"),u=document.querySelector(".add-model__bar-current"),m=document.querySelector(".add-model__file-result"),p=document.querySelector(".add-model__file-image"),_=document.querySelector(".add-model__file-name"),v=document.querySelector(".add-model__file-close");if(!t)return;const L=(e,t)=>{e.classList.contains(t)||e.classList.add(t)},h=(e,t)=>{e.classList.contains(t)&&e.classList.remove(t)},w=()=>{t.validity.valid&&""!==s.value&&""!==r.value&&d.checked?c.hasAttribute("disabled")&&c.removeAttribute("disabled"):!c.hasAttribute("disabled")&&c.setAttribute("disabled","")},y=e=>{const t=e.target;L(t,"fill"),""===t.value&&L(t,"mask")},f=e=>{const t=e.target;t.value||h(t,"fill"),h(t,"mask")};t.addEventListener("focus",y),t.addEventListener("blur",f),t.addEventListener("input",e=>{const s=e.target;t.validity.valid||(L(o,"show"),L(t,"error")),t.validity.valid&&(h(s,"error"),h(o,"show")),""===s.value&&L(s,"mask"),""!==s.value&&h(s,"mask"),w()}),s.addEventListener("focus",y),s.addEventListener("blur",f),s.addEventListener("input",e=>{const t=e.target;""===t.value&&(L(t,"mask"),L(t,"error"),L(n,"show")),""!==t.value&&(h(t,"mask"),h(t,"error"),h(n,"show")),w()}),r.addEventListener("focus",y),r.addEventListener("blur",f),r.addEventListener("input",e=>{const t=e.target;""===t.value&&(L(t,"mask"),L(t,"error"),L(a,"show")),""!==t.value&&(h(t,"mask"),h(t,"error"),h(a,"show")),w()}),i.addEventListener("change",e=>{(e=>{if(e.files&&e.files[0]){var t=new FileReader;t.onloadstart=function(e){l.classList.add("show")},t.onprogress=function(e){console.log(Math.round(e.loaded/e.total*100)),u.style.width=Math.round(e.loaded/e.total*100)+"%"},t.onload=function(t){p.setAttribute("src",t.target.result),_.textContent=e.files[0].name,!m.classList.contains("show")&&m.classList.add("show"),l.classList.remove("show"),u.style.width=0},t.readAsDataURL(e.files[0])}})(e.target)}),v.addEventListener("click",()=>{i.value="",/safari/i.test(navigator.userAgent)||(i.type="",i.type="file"),m.classList.remove("show"),_.textContent="",p.removeAttribute("src")}),d.addEventListener("click",()=>{d.checked?h(d,"error"):L(d,"error"),w()}),c.addEventListener("click",t=>{t.preventDefault(),e.submit()})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZGVsLmpzIiwicG9wdXAuanMiLCJhbmltYXRpb24uanMiLCJiYWNrZW5kLmpzIiwic2VsZWN0LmpzIiwiY2hvaWNlLmpzIiwiZXF1aXBtZW50LmpzIiwicHJvY2Vzcy5qcyIsImZvcm0uanMiXSwibmFtZXMiOlsiU3dpcGVyIiwicGFnaW5hdGlvbiIsImVsIiwidHlwZSIsImNsaWNrYWJsZSIsImxvb3AiLCJ3aXJlQnV0dG9ucyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsInBvcHVwcyIsImNsb3NlQnV0dG9ucyIsIm92ZXJsYXkiLCJxdWVyeVNlbGVjdG9yIiwiZm9yRWFjaCIsIndpcmVCdXR0b24iLCJpZHgiLCJhZGRFdmVudExpc3RlbmVyIiwiY2xhc3NMaXN0IiwiYWRkIiwiY2xvc2VCdXR0b24iLCJyZW1vdmUiLCJwb3B1cCIsImNvbnRhaW5zIiwiZ2V0RWxlbWVudEJ5SWQiLCJsb3R0aWUiLCJsb2FkQW5pbWF0aW9uIiwiY29udGFpbmVyIiwicmVuZGVyZXIiLCJhdXRvcGxheSIsInBhdGgiLCJSZXFVcmwiLCJSZXFNZXRob2QiLCJSZXFTdGF0dXMiLCJjcmVhdGVSZXF1ZXN0Iiwib25Mb2FkIiwib25FcnJvciIsInhociIsIlhNTEh0dHBSZXF1ZXN0IiwidGltZW91dCIsInJlc3BvbnNlVHlwZSIsInN0YXR1cyIsImlzRXJyb3JTdGF0dXMiLCJyZXNwb25zZSIsInN0YXR1c1RleHQiLCJyZW1vdmVFbGVtZW50IiwiZWxlbWVudCIsIm9uQW55RXJyb3IiLCJtZXNzYWdlIiwibm9kZSIsImNyZWF0ZUVsZW1lbnQiLCJzdHlsZSIsInBvc2l0aW9uIiwibGVmdCIsInJpZ2h0IiwiZm9udFNpemUiLCJ0ZXh0Q29udGVudCIsImJvZHkiLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiLCJ3aW5kb3ciLCJzZXRUaW1lb3V0IiwiYmFja2VuZCIsImxvYWQiLCJyZXEiLCJvcGVuIiwic2VuZCIsImpRdWVyeSIsImJyYW5kTGlzdCIsImJyYW5kQnV0dG9uIiwiZXZ0IiwidGFyZ2V0Iiwid3JhcHBlciIsImZyYWdtZW50IiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsIndyYXBwZXJOb2RlIiwiY2xvbmVOb2RlIiwiY2xhc3NOYW1lIiwicGFnaW5hdGlvbk5vZGUiLCJhcHBlbmRDaGlsZCIsIml0ZW0iLCJyZW5kZXJTbGlkZXIiLCJudW1iZXJOb2RlIiwic3dpcGVyIiwibnVtYmVyRmllbGQiLCJvbiIsInJlYWxJbmRleCIsImFkZE51bWJlcmluZyIsImZvcm0iLCJlbWFpbElucHV0IiwiZW1haWxFcnJvciIsImJyYW5kSW5wdXQiLCJicmFuZEVycm9yIiwibW9kZWxJbnB1dCIsIm1vZGVsRXJyb3IiLCJmaWxlSW5wdXQiLCJjaGVja2JveCIsInN1Ym1pdCIsInByb2dyZXNzIiwiYmFyIiwiZmlsZVJlc3VsdCIsImZpbGVJbWciLCJmaWxlTmFtZSIsImZpbGVDbGVhciIsImFkZENsYXNzTmFtZSIsInJlbW92ZUNsYXNzTmFtZSIsImNoZWNrRm9ybSIsInZhbGlkaXR5IiwidmFsaWQiLCJ2YWx1ZSIsImNoZWNrZWQiLCJoYXNBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJzZXRBdHRyaWJ1dGUiLCJvblRleHRGb2N1cyIsImlucHV0Iiwib25UZXh0Qmx1ciIsImZpbGVzIiwicmVhZGVyIiwiRmlsZVJlYWRlciIsIm9ubG9hZHN0YXJ0IiwiZSIsIm9ucHJvZ3Jlc3MiLCJjb25zb2xlIiwibG9nIiwiTWF0aCIsInJvdW5kIiwibG9hZGVkIiwidG90YWwiLCJ3aWR0aCIsIm9ubG9hZCIsInJlc3VsdCIsIm5hbWUiLCJyZWFkQXNEYXRhVVJMIiwicmVhZFVybCIsInRlc3QiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJwcmV2ZW50RGVmYXVsdCJdLCJtYXBwaW5ncyI6IkFBRUEsSUFBQUEsT0FBQSwwQkFBQSxDQUNBQyxXQUFBLENBQ0FDLEdBQUEscUJBQ0FDLEtBQUEsVUFDQUMsV0FBQSxHQUVBQyxNQUFBLElDUkEsV0FDQSxNQUFBQyxFQUFBQyxT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VCxFQUFBLFNBREFRLEVBQUFSLEVBQUEsU0FHQVUsTUEwQkFULEVBQUEvRSxpQkFBQSxRQXZCQW9ELElBQ0FBLEVBQUFvRSxpQkFFQWxELEVBQUFTLFdBNU1BIiwiZmlsZSI6InNjcmlwdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICBjb25zdCBpbml0U3dpcGVyID0gKCkgPT4ge1xuICAgIHJldHVybiBuZXcgU3dpcGVyKCcubW9kZWxfX2ltYWdlLWNvbnRhaW5lcicsIHtcbiAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgZWw6ICcubW9kZWxfX3BhZ2luYXRpb24nLFxuICAgICAgICB0eXBlOiAnYnVsbGV0cycsXG4gICAgICAgIGNsaWNrYWJsZTogdHJ1ZSxcbiAgICAgIH0sXG4gICAgICBsb29wOiB0cnVlLFxuICAgIH0pO1xuICB9O1xuXG4gIGluaXRTd2lwZXIoKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICBjb25zdCB3aXJlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kZXZpY2VfX3dpcmUtZG90ZSBzcGFuJyk7XG4gIGNvbnN0IHBvcHVwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kZXZpY2VfX3dpcmUtcG9wdXAtbW9iaWxlJyk7XG4gIGNvbnN0IGNsb3NlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kZXZpY2VfX3dpcmUtcG9wdXAtY2xvc2UnKTtcbiAgY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kZXZpY2VfX3dpcmUtcG9wdXAtb3ZlcmxheScpO1xuXG4gIGlmICghd2lyZUJ1dHRvbnNbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBjbG9zZUFueVBvcHVwID0gKCkgPT4ge1xuICAgIHBvcHVwcy5mb3JFYWNoKChwb3B1cCkgPT4ge1xuICAgICAgaWYgKHBvcHVwLmNsYXNzTGlzdC5jb250YWlucygnanMtLXNob3cnKSkge1xuICAgICAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tc2hvdycpO1xuICAgICAgfVxuICAgIH0pXG4gIH07XG5cbiAgd2lyZUJ1dHRvbnMuZm9yRWFjaCgod2lyZUJ1dHRvbiwgaWR4KSA9PiB7XG4gICAgd2lyZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIHBvcHVwc1tpZHhdLmNsYXNzTGlzdC5hZGQoJ2pzLS1zaG93Jyk7XG4gICAgICBvdmVybGF5LmNsYXNzTGlzdC5hZGQoJ2pzLS1zaG93Jyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGNsb3NlQnV0dG9ucy5mb3JFYWNoKChjbG9zZUJ1dHRvbiwgaWR4KSA9PiB7XG4gICAgY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICBwb3B1cHNbaWR4XS5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tc2hvdycpO1xuICAgICAgb3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tc2hvdycpO1xuICAgIH0pO1xuICB9KTtcblxuICBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGNsb3NlQW55UG9wdXAoKTtcbiAgICBvdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1zaG93Jyk7XG4gIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FuaW1hdGlvbicpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbG90dGllLmxvYWRBbmltYXRpb24oe1xuICAgIGNvbnRhaW5lcjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FuaW1hdGlvbicpLCAvLyB0aGUgZG9tIGVsZW1lbnQgdGhhdCB3aWxsIGNvbnRhaW4gdGhlIGFuaW1hdGlvblxuICAgIHJlbmRlcmVyOiAnc3ZnJyxcbiAgICBsb29wOiB0cnVlLFxuICAgIGF1dG9wbGF5OiB0cnVlLFxuICAgIHBhdGg6ICdkYXRhLmpzb24nIC8vIHRoZSBwYXRoIHRvIHRoZSBhbmltYXRpb24ganNvblxuICB9KTtcbn0pKCk7XG4iLCIndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBSZXFVcmwgPSB7XG4gICAgR0VUOiAnaHR0cHM6Ly9zcGxpdC5kYWljaGljbG91ZC5ydS9icmFuZHMvYWxsJyxcbiAgICAvL1BPU1Q6ICdodHRwczovL2pzLmR1bXAuYWNhZGVteS9rZWtzdGFncmFtJ1xuICB9O1xuXG4gIHZhciBSZXFNZXRob2QgPSB7XG4gICAgR0VUOiAnR0VUJyxcbiAgICBQT1NUOiAnUE9TVCdcbiAgfTtcblxuICB2YXIgUmVxU3RhdHVzID0ge1xuICAgIE9LOiAyMDAsXG4gICAgTVVMVElQTEVfQ0hPSUNFUzogMzAwLFxuICB9O1xuXG4gIHZhciBUSU1FT1VUID0gMTAwMDA7XG5cbiAgdmFyIGlzRXJyb3JTdGF0dXMgPSBmdW5jdGlvbiAoeGhyKSB7XG4gICAgcmV0dXJuIHhoci5zdGF0dXMgPCBSZXFTdGF0dXMuT0tcbiAgICAgIHx8IHhoci5zdGF0dXMgPiBSZXFTdGF0dXMuTVVMVElQTEVfQ0hPSUNFUztcbiAgfTtcblxuICB2YXIgY3JlYXRlUmVxdWVzdCA9IGZ1bmN0aW9uIChvbkxvYWQsIG9uRXJyb3IpIHtcbiAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgICB4aHIudGltZW91dCA9IFRJTUVPVVQ7XG4gICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdqc29uJztcblxuICAgIHhoci5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKGlzRXJyb3JTdGF0dXMoeGhyKSkge1xuICAgICAgICBvbkVycm9yKCfQlNCw0L3QvdGL0LUg0L3QtSDQt9Cw0LPRgNGD0LfQuNC70LjRgdGMLiDQn9GA0LjRh9C40L3QsDogJyArIHhoci5zdGF0dXMgKyAnICcgKyB4aHIuc3RhdHVzVGV4dCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgb25Mb2FkKHhoci5yZXNwb25zZSk7XG4gICAgfSk7XG5cbiAgICB4aHIuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCBmdW5jdGlvbiAoKSB7XG4gICAgICBvbkVycm9yKCfQn9GA0L7QuNC30L7RiNC70LAg0L7RiNC40LHQutCwINGB0L7QtdC00LjQvdC10L3QuNGPJyk7XG4gICAgfSk7XG5cbiAgICB4aHIuYWRkRXZlbnRMaXN0ZW5lcigndGltZW91dCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIG9uRXJyb3IoJ9CX0LDQv9GA0L7RgSDQvdC1INGD0YHQv9C10Lsg0LLRi9C/0L7Qu9C90LjRgtGM0YHRjyDQt9CwICcgKyB4aHIudGltZW91dCArICfQvNGBJyk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4geGhyO1xuICB9O1xuXG4gIHZhciByZW1vdmVFbGVtZW50ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICBlbGVtZW50LnJlbW92ZSgpO1xuICB9O1xuXG4gIHZhciBvbkFueUVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICB2YXIgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIG5vZGUuc3R5bGUgPSAnei1pbmRleDogMTAwOyBtYXJnaW46IDAgYXV0bzsgdGV4dC1hbGlnbjogY2VudGVyOyBiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7JztcbiAgICBub2RlLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICBub2RlLnN0eWxlLmxlZnQgPSAwO1xuICAgIG5vZGUuc3R5bGUucmlnaHQgPSAwO1xuICAgIG5vZGUuc3R5bGUuZm9udFNpemUgPSAnMzBweCc7XG5cbiAgICBub2RlLnRleHRDb250ZW50ID0gbWVzc2FnZTtcbiAgICBkb2N1bWVudC5ib2R5Lmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJiZWdpbicsIG5vZGUpO1xuICAgIHdpbmRvdy5zZXRUaW1lb3V0KHJlbW92ZUVsZW1lbnQsIDIwMDAsIG5vZGUpO1xuICB9O1xuXG4gIHdpbmRvdy5iYWNrZW5kID0ge1xuICAgIGxvYWQ6IGZ1bmN0aW9uIChvbkxvYWQsIG9uRXJyb3IpIHtcbiAgICAgIHZhciByZXEgPSBjcmVhdGVSZXF1ZXN0KG9uTG9hZCwgb25FcnJvciB8fCBvbkFueUVycm9yKTtcbiAgICAgIHJlcS5vcGVuKFJlcU1ldGhvZC5HRVQsIFJlcVVybC5HRVQpO1xuICAgICAgcmVxLnNlbmQoKTtcbiAgICB9LFxuXG4gICAgLy8gc2F2ZTogZnVuY3Rpb24gKGRhdGEsIG9uTG9hZCwgb25FcnJvcikge1xuICAgIC8vICAgdmFyIHJlcSA9IGNyZWF0ZVJlcXVlc3Qob25Mb2FkLCBvbkVycm9yKTtcbiAgICAvLyAgIHJlcS5vcGVuKFJlcU1ldGhvZC5QT1NULCBSZXFVcmwuUE9TVCk7XG4gICAgLy8gICByZXEuc2VuZChkYXRhKTtcbiAgICAvLyB9XG4gIH07XG59KSgpO1xuXG5cblxuXG4iLCIvLyAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcbi8vICAgLy8gJCgnLm1vZGVsLWNob2ljZV9fYnJhbmQtc2VsZWN0Jykuc2VsZWN0Mih7XG4vLyAgIC8vICAgbWluaW11bVJlc3VsdHNGb3JTZWFyY2g6IC0xLFxuLy8gICAvLyB9KTtcblxuLy8gICAvLyAkKCcubW9kZWwtY2hvaWNlX19zZXJpZXMtc2VsZWN0Jykuc2VsZWN0Mih7XG4vLyAgIC8vICAgbWluaW11bVJlc3VsdHNGb3JTZWFyY2g6IC0xLFxuLy8gICAvLyB9KTtcblxuLy8gICBmdW5jdGlvbiBtYWtlU2VsZWN0KGVsZW1lbnQpIHtcbi8vICAgICAkKGVsZW1lbnQpLnNlbGVjdDIoe1xuLy8gICAgICAgbWluaW11bVJlc3VsdHNGb3JTZWFyY2g6IC0xLFxuLy8gICAgIH0pO1xuLy8gICB9O1xuXG5cblxuXG4vLyAgIHdpbmRvdy5tYWtlU2VsZWN0ID0gbWFrZVNlbGVjdDtcblxuLy8gICBjb25zb2xlLmxvZyh3aW5kb3cubWFrZVNlbGVjdCk7XG5cbi8vIH0pO1xuXG5cbihmdW5jdGlvbigkKSB7XG4gIC8vIGZ1bmN0aW9uIG1ha2VTZWxlY3QoZWxlbWVudENsYXNzKSB7XG4gIC8vICAgJChlbGVtZW50Q2xhc3MpLnNlbGVjdDIoe1xuICAvLyAgICAgbWluaW11bVJlc3VsdHNGb3JTZWFyY2g6IC0xLFxuICAvLyAgIH0pO1xuICAvLyB9O1xuXG4gIC8vIHdpbmRvdy5tYWtlU2VsZWN0ID0gbWFrZVNlbGVjdDtcbn0pKGpRdWVyeSk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAvLyBjb25zdCBzcGxpdHMgPSBbXG4gIC8vICAge1xuICAvLyAgICAgXCJpZFwiOjcsXG4gIC8vICAgICBcInRpdGxlXCI6XCJBeGlvbWFcIixcbiAgLy8gICAgIFwic2VyaWVzXCI6W1xuICAvLyAgICAgICB7XG4gIC8vICAgICAgICAgXCJpZFwiOjYzLFxuICAvLyAgICAgICAgIFwidGl0bGVcIjpcIkFTWF9BXCJcbiAgLy8gICAgICAgfSxcbiAgLy8gICAgICAge1xuICAvLyAgICAgICAgIFwiaWRcIjo2MixcbiAgLy8gICAgICAgICBcInRpdGxlXCI6XCJBU1hfQVpcIlxuICAvLyAgICAgICB9XG4gIC8vICAgICBdXG4gIC8vICAgfSxcbiAgLy8gICB7XCJpZFwiOjYsXCJ0aXRsZVwiOlwiRGFpY2hpXCIsXCJzZXJpZXNcIjpbe1wiaWRcIjo0NSxcInRpdGxlXCI6XCJDYXJib24gREFfRFZRXCJ9LHtcImlkXCI6NDYsXCJ0aXRsZVwiOlwiRXZlcmVzdCBEQV9FVlFcIn0se1wiaWRcIjo0MyxcInRpdGxlXCI6XCJQZWFrIERBX0FWUVNcIn0se1wiaWRcIjo0MixcInRpdGxlXCI6XCJYLXRyZW1lIFBlYWsgREFfQVZRU1wifV19LFxuICAvLyAgIHtcImlkXCI6MSxcInRpdGxlXCI6XCJEYWlraW5cIixcInNlcmllc1wiOlt7XCJpZFwiOjExLFwidGl0bGVcIjpcIkNvbWZvcmEgRlRYLUpcXC9HVlwifSx7XCJpZFwiOjI2LFwidGl0bGVcIjpcIkNvbWZvcmEgRlRYUC1LM1wifSx7XCJpZFwiOjI3LFwidGl0bGVcIjpcIkNvbWZvcmEgRlRYUC1MXCJ9LHtcImlkXCI6MjgsXCJ0aXRsZVwiOlwiQ29tZm9yYSBGVFhQLU1cIn0se1wiaWRcIjoyMyxcInRpdGxlXCI6XCJFbXVyYSBGVFhHLUxcIn0se1wiaWRcIjoxOCxcInRpdGxlXCI6XCJFbXVyYSBGVFhKLU1cIn0se1wiaWRcIjoyMCxcInRpdGxlXCI6XCJGTFhTLUJcIn0se1wiaWRcIjoxNixcInRpdGxlXCI6XCJGVFhCLUJcIn0se1wiaWRcIjo2NSxcInRpdGxlXCI6XCJGVFhTLUVcIn0se1wiaWRcIjo2NCxcInRpdGxlXCI6XCJGVFhTLUpcXC9HXCJ9LHtcImlkXCI6MjEsXCJ0aXRsZVwiOlwiRlZYTS1GXCJ9LHtcImlkXCI6MjIsXCJ0aXRsZVwiOlwiRlZYUy1GXCJ9LHtcImlkXCI6MTksXCJ0aXRsZVwiOlwiTmV4dXJhIEZWWEctS1wifSx7XCJpZFwiOjI0LFwidGl0bGVcIjpcIlBlcmZlcmEgRlRYTS1OXCJ9LHtcImlkXCI6MjUsXCJ0aXRsZVwiOlwiUGVyZmVyYSBGVFhTLUtcIn0se1wiaWRcIjoxLFwidGl0bGVcIjpcIlNlbnNpcmEgRlRYQi1DXCJ9XX0sXG4gIC8vICAge1wiaWRcIjoyLFwidGl0bGVcIjpcIktlbnRhdHN1XCIsXCJzZXJpZXNcIjpbe1wiaWRcIjo0OSxcInRpdGxlXCI6XCJCcmF2byAgS1NHQl9IRkFOXCJ9LHtcImlkXCI6NTAsXCJ0aXRsZVwiOlwiQnJhdm8gIEtTR0JBX0haQU5cIn0se1wiaWRcIjo1NixcInRpdGxlXCI6XCJLTUdCQV9IWkFOXCJ9LHtcImlkXCI6NTcsXCJ0aXRsZVwiOlwiS01HQkJfSFpBTlwifSx7XCJpZFwiOjUyLFwidGl0bGVcIjpcIlRlYW0gIEtTR1RfSFpBTlwifSx7XCJpZFwiOjQ3LFwidGl0bGVcIjpcIlRpdGFuIEdlbmVzaXMgS1NHWFwifSx7XCJpZFwiOjUxLFwidGl0bGVcIjpcIlR1cmluIEtTR1VfSFpBTlwifV19LFxuICAvLyAgIHtcImlkXCI6OCxcInRpdGxlXCI6XCJNaWRlYVwiLFwic2VyaWVzXCI6W3tcImlkXCI6NjEsXCJ0aXRsZVwiOlwiQmxhbmMgTVNNQVwifSx7XCJpZFwiOjYwLFwidGl0bGVcIjpcIkJsYW5jIE1TTUEgRVJQIChNQSlcIn0se1wiaWRcIjo1OSxcInRpdGxlXCI6XCJNaXNzaW9uIE1TTUIgKE1CKVwifSx7XCJpZFwiOjU4LFwidGl0bGVcIjpcIlVsdGltYXRlIENvbWZvcnQgTVNNVCAoTVQpXCJ9XX1dO1xuXG5cbiAgLy9sZXQgc2VyaWVzTmFtZSA9ICcnO1xuICAvL2xldCBicmFuZE5hbWUgPSAnJztcblxuICBjb25zdCBicmFuZExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kZWwtY2hvaWNlX19icmFuZC1saXN0Jyk7XG4gIGNvbnN0IGJyYW5kQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGVsLWNob2ljZV9fYnJhbmQtY2hvaWNlJyk7XG4gIC8vY29uc3QgYnJhbmRTZWxlY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kZWwtY2hvaWNlX19zZWxlY3QtYnJhbmQnKTtcblxuICBpZiAoIWJyYW5kTGlzdCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vbGV0IGN1cnJlbnRCcmFuZElkeCA9IC0xO1xuICAvL2xldCBjdXJyZW50T3B0aW9uSWR4ID0gLTE7XG5cbiAgLy9jb25zdCBicmFuZFNlbGVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RlbC1jaG9pY2VfX2JyYW5kLXNlbGVjdCcpO1xuICAvL2NvbnN0IHNlcmllc1dyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kZWwtY2hvaWNlX19zZXJpZXMtd3JhcHBlcicpO1xuICAvL2NvbnN0IHNlcmllc1RlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlcmllcycpLmNvbnRlbnQucXVlcnlTZWxlY3RvcignLm1vZGVsLWNob2ljZV9fc2VyaWVzLXNlbGVjdCcpO1xuXG4gIC8vY29uc3QgbGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RlbC1jaG9pY2VfX2xpbmsnKTtcblxuICAvLyBjb25zdCBnZXRIcmVmID0gKHNlcmllcykgPT4ge1xuICAvLyAgIGxldCBocmVmID0gJyc7XG5cbiAgLy8gICBQQUdFUy5mb3JFYWNoKChwYWdlKSA9PiB7XG4gIC8vICAgICBpZiAoaHJlZiA9PT0gJycpIHtcbiAgLy8gICAgICAgaWYgKHNlcmllcy50b0xvd2VyQ2FzZSgpLmluZGV4T2YocGFnZSkgIT09IC0xKSB7XG4gIC8vICAgICAgICAgaHJlZiA9IHBhZ2U7XG4gIC8vICAgICAgIH1cbiAgLy8gICAgIH1cbiAgLy8gICB9KTtcblxuICAvLyAgIHJldHVybiBocmVmID09PSAnJyA/ICcnIDogaHJlZiArICcuaHRtbCc7XG4gIC8vIH07XG5cbiAgY29uc3Qgb25CcmFuZENsaWNrID0gKCkgPT4ge1xuICAgIGlmICghYnJhbmRMaXN0LmNsYXNzTGlzdC5jb250YWlucygnc2hvdycpKSB7XG4gICAgICBicmFuZExpc3QuY2xhc3NMaXN0LmFkZCgnc2hvdycpO1xuICAgICAgYnJhbmRCdXR0b24uY2xhc3NMaXN0LmFkZCgnb3BlbmVkJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGJyYW5kTGlzdC5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3cnKSkge1xuICAgICAgYnJhbmRMaXN0LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICAgIGJyYW5kQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW5lZCcpO1xuICAgIH1cbiAgICAvLyBqUXVlcnkoJy5tb2RlbC1jaG9pY2VfX2JyYW5kLWxpc3QnKS5tQ3VzdG9tU2Nyb2xsYmFyKHtcbiAgICAvLyAgIHNldEhlaWdodDogMTg5LFxuICAgIC8vICAgYXV0b0hpZGVTY3JvbGxiYXI6IGZhbHNlLFxuICAgIC8vICAgdGhlbWU6ICdkYXJrJyxcbiAgICAvLyAgIG1vdXNlV2hlZWxQaXhlbHM6IDIwMCxcbiAgICAvLyAgIGNvbnRlbnRUb3VjaFNjcm9sbDogdHJ1ZVxuICAgIC8vIH0pO1xuICB9O1xuXG4gIC8vIGNvbnN0IG9uU2VyaWVzQ2xpY2sgPSAoKSA9PiB7XG4gIC8vICAgaWYgKCFzZXJpZXNMaXN0LmNsYXNzTGlzdC5jb250YWlucygnc2hvdycpKSB7XG4gIC8vICAgICBzZXJpZXNMaXN0LmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTtcbiAgLy8gICAgIHNlcmllc0J1dHRvbi5jbGFzc0xpc3QuYWRkKCdvcGVuZWQnKTtcbiAgLy8gICAgIC8vIGNvbnNvbGUubG9nKHNlcmllc0xpc3QuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuYm90dG9tIC0gd2luZG93LmlubmVySGVpZ2h0KTtcbiAgLy8gICAgIHJldHVybjtcbiAgLy8gICB9XG5cbiAgLy8gICBpZiAoc2VyaWVzTGlzdC5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3cnKSkge1xuICAvLyAgICAgc2VyaWVzTGlzdC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XG4gIC8vICAgICBzZXJpZXNCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnb3BlbmVkJyk7XG4gIC8vICAgfVxuICAvLyB9O1xuXG4gIGNvbnN0IG9uT3V0c2lkZUNsaWNrID0gKGV2dCkgPT4ge1xuICAgIGxldCB0YXJnZXQgPSBldnQudGFyZ2V0O1xuXG4gICAgaWYgKFxuICAgICAgIXRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGVsLWNob2ljZV9fYnJhbmQtY2hvaWNlJylcbiAgICAgICYmICF0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RlbC1jaG9pY2VfX2JyYW5kLWl0ZW0nKVxuICAgICAgJiYgIXRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGVsLWNob2ljZV9fYnJhbmQtbGlzdCcpXG4gICAgICAmJiBicmFuZExpc3QuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93JylcbiAgICApIHtcbiAgICAgIGJyYW5kTGlzdC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XG4gICAgICBicmFuZEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuZWQnKTtcbiAgICB9XG5cbiAgICAvLyBpZiAoXG4gICAgLy8gICAhdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kZWwtY2hvaWNlX19zZXJpZXMtY2hvaWNlJylcbiAgICAvLyAgICYmICF0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RlbC1jaG9pY2VfX3Nlcmllcy1pdGVtJylcbiAgICAvLyAgICYmICF0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RlbC1jaG9pY2VfX3Nlcmllcy1saXN0JylcbiAgICAvLyAgICYmIHNlcmllc0xpc3QuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93JylcbiAgICAvLyApIHtcbiAgICAvLyAgIHNlcmllc0xpc3QuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuICAgIC8vICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW5lZCcpO1xuICAgIC8vIH1cbiAgfTtcblxuXG4gICAgLy8gbGV0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIC8vIGxldCBpID0gMDtcblxuICAgIC8vIGFyci5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgLy8gICBsZXQgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgLy8gICBub2RlLnRleHRDb250ZW50ID0gaXRlbVsndGl0bGUnXTtcbiAgICAvLyAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnbW9kZWwtY2hvaWNlX19icmFuZC1pdGVtJyk7XG4gICAgLy8gICBub2RlLnNldEF0dHJpYnV0ZSgnZGF0YS1pZCcsIGkpO1xuICAgIC8vICAgaSsrO1xuICAgIC8vICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQobm9kZSk7XG5cbiAgICAvLyAgIC8vIGxldCBzZXJpZXNTZWxlY3QgPSBzZXJpZXNUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgLy8gICAvLyBzZXJpZXNTZWxlY3QuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgLy8gICAvLyBzZXJpZXNTZWxlY3Quc2V0QXR0cmlidXRlKCduYW1lJywgaXRlbVsndGl0bGUnXSk7XG5cbiAgICAvLyAgIC8vIGl0ZW0uc2VyaWVzLmZvckVhY2goKHNlcmllKSA9PiB7XG4gICAgLy8gICAvLyAgIGxldCBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgLy8gICAvLyAgIG5vZGUuc2V0QXR0cmlidXRlKCd2YWx1ZScsIHNlcmllWyd0aXRsZSddKTtcbiAgICAvLyAgIC8vICAgbm9kZS50ZXh0Q29udGVudCA9IHNlcmllWyd0aXRsZSddO1xuICAgIC8vICAgLy8gICBzZXJpZXNTZWxlY3QuYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgLy8gICAvLyB9KTtcblxuICAgIC8vICAgLy8gc2VyaWVzV3JhcHBlci5hcHBlbmRDaGlsZChzZXJpZXNTZWxlY3QpO1xuICAgIC8vIH0pO1xuXG4gICAgLy8gYnJhbmRMaXN0LmFwcGVuZENoaWxkKGZyYWdtZW50KTtcblxuXG4gICAgLy8gbGV0IGZyYWdtZW50MSA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAvLyBsZXQgaiA9IDA7XG5cbiAgICAvLyBhcnIuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgIC8vICAgbGV0IG5vZGUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgLy8gICBub2RlMS50ZXh0Q29udGVudCA9IGl0ZW1bJ3RpdGxlJ107XG4gICAgLy8gICBub2RlMS5jbGFzc0xpc3QuYWRkKCdtb2RlbC1jaG9pY2VfX2JyYW5kLW9wdGlvbicpO1xuICAgIC8vICAgbm9kZTEuc2V0QXR0cmlidXRlKCdkYXRhLWlkJywgaSk7XG4gICAgLy8gICBqKys7XG4gICAgLy8gICBmcmFnbWVudDEuYXBwZW5kQ2hpbGQobm9kZTEpO1xuXG4gICAgLy8gICAvLyBsZXQgc2VyaWVzU2VsZWN0ID0gc2VyaWVzVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xuICAgIC8vICAgLy8gc2VyaWVzU2VsZWN0LmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgIC8vICAgLy8gc2VyaWVzU2VsZWN0LnNldEF0dHJpYnV0ZSgnbmFtZScsIGl0ZW1bJ3RpdGxlJ10pO1xuXG4gICAgLy8gICAvLyBpdGVtLnNlcmllcy5mb3JFYWNoKChzZXJpZSkgPT4ge1xuICAgIC8vICAgLy8gICBsZXQgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xuICAgIC8vICAgLy8gICBub2RlLnNldEF0dHJpYnV0ZSgndmFsdWUnLCBzZXJpZVsndGl0bGUnXSk7XG4gICAgLy8gICAvLyAgIG5vZGUudGV4dENvbnRlbnQgPSBzZXJpZVsndGl0bGUnXTtcbiAgICAvLyAgIC8vICAgc2VyaWVzU2VsZWN0LmFwcGVuZENoaWxkKG5vZGUpO1xuICAgIC8vICAgLy8gfSk7XG5cbiAgICAvLyAgIC8vIHNlcmllc1dyYXBwZXIuYXBwZW5kQ2hpbGQoc2VyaWVzU2VsZWN0KTtcbiAgICAvLyB9KTtcblxuICAgIC8vIGJyYW5kU2VsZWN0LmFwcGVuZENoaWxkKGZyYWdtZW50MSk7XG5cblxuXG4gICAgLy8gY29uc3Qgb25CcmFuZEl0ZW1DbGljayA9IChldnQpID0+IHtcbiAgICAvLyAgIGxldCB0YXJnZXQgPSBldnQudGFyZ2V0O1xuICAgIC8vICAgbGV0IGlkeCA9ICt0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLWlkJyk7XG5cbiAgICAvLyAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RlbC1jaG9pY2VfX2JyYW5kLWl0ZW0nKSkge1xuICAgIC8vICAgICBpZiAoY3VycmVudEJyYW5kSWR4ID09PSBpZHgpIHtcbiAgICAvLyAgICAgICBicmFuZExpc3QuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuICAgIC8vICAgICAgIGJyYW5kQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW5lZCcpO1xuICAgIC8vICAgICB9XG5cbiAgICAvLyAgICAgaWYgKGN1cnJlbnRCcmFuZElkeCAhPT0gaWR4KSB7XG4gICAgLy8gICAgICAgc2VyaWVzTGlzdC5pbm5lckhUTUwgPSAnJztcblxuICAgIC8vICAgICAgIHNlcmllc0J1dHRvbi50ZXh0Q29udGVudCA9ICfQktGL0LHRgNCw0YLRjCDQuNC3INGB0L/QuNGB0LrQsCc7XG4gICAgLy8gICAgICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7XG5cbiAgICAvLyAgICAgICBsZXQgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgLy8gICAgICAgbGV0IGlkeCA9ICt0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLWlkJyk7XG5cbiAgICAvLyAgICAgICBhcnJbaWR4XS5zZXJpZXMuZm9yRWFjaCgoc2VyaWUpID0+IHtcbiAgICAvLyAgICAgICAgIGxldCBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICAvLyAgICAgICAgIG5vZGUudGV4dENvbnRlbnQgPSBzZXJpZVsndGl0bGUnXTtcbiAgICAvLyAgICAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnbW9kZWwtY2hvaWNlX19zZXJpZXMtaXRlbScpO1xuICAgIC8vICAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgLy8gICAgICAgfSk7XG5cbiAgICAvLyAgICAgICBzZXJpZXNMaXN0LmFwcGVuZENoaWxkKGZyYWdtZW50KTtcbiAgICAvLyAgICAgICBjdXJyZW50QnJhbmRJZHggPSBpZHg7XG5cbiAgICAvLyAgICAgICBicmFuZEJ1dHRvbi50ZXh0Q29udGVudCA9IHRhcmdldC50ZXh0Q29udGVudDtcbiAgICAvLyAgICAgICBicmFuZE5hbWUgPSB0YXJnZXQudGV4dENvbnRlbnQ7XG4gICAgLy8gICAgICAgaWYgKCFicmFuZEJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAvLyAgICAgICAgIGJyYW5kQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XG4gICAgLy8gICAgICAgfVxuXG4gICAgLy8gICAgICAgaWYgKHNlcmllc0J1dHRvbi5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgICAvLyAgICAgICAgIHNlcmllc0J1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgLy8gICAgICAgfVxuXG4gICAgLy8gICAgICAgYnJhbmRMaXN0LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICAvLyAgICAgICBicmFuZEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuZWQnKTtcblxuICAgIC8vICAgICAgIGxpbmsuY2xhc3NMaXN0LmFkZCgnZGlzYWJsZWQnKTtcbiAgICAvLyAgICAgICBsaW5rLnJlbW92ZUF0dHJpYnV0ZSgnaHJlZicpO1xuICAgIC8vICAgICB9XG4gICAgLy8gICB9XG4gICAgLy8gfVxuXG4gICAgLy8gY29uc3Qgb25CcmFuZENoYW5nZSA9IChldnQpID0+IHtcbiAgICAvLyAgIGN1cnJlbnRPcHRpb25JZHggPSBldnQudGFyZ2V0LnNlbGVjdGVkSW5kZXggLSAxO1xuICAgIC8vICAgc2VyaWVzU2VsZWN0LmlubmVySFRNTCA9ICcnO1xuXG4gICAgLy8gICBzZXJpZXNCdXR0b24udGV4dENvbnRlbnQgPSAn0JLRi9Cx0YDQsNGC0Ywg0LjQtyDRgdC/0LjRgdC60LAnO1xuICAgIC8vICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7XG5cbiAgICAvLyAgIGxldCBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgLy8gICBub2RlLnRleHRDb250ZW50ID0gJyc7XG4gICAgLy8gICBub2RlLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gICAgLy8gICBub2RlLnNldEF0dHJpYnV0ZSgnc2VsZWN0ZWQnLCAnJyk7XG4gICAgLy8gICBub2RlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cbiAgICAvLyAgIHNlcmllc1NlbGVjdC5hcHBlbmRDaGlsZChub2RlKTtcblxuICAgIC8vICAgbGV0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuXG4gICAgLy8gICBpZiAoc2VyaWVzU2VsZWN0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgIC8vICAgICBzZXJpZXNTZWxlY3QucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIC8vICAgfVxuXG5cbiAgICAvLyAgIGFycltjdXJyZW50T3B0aW9uSWR4XS5zZXJpZXMuZm9yRWFjaCgoc2VyaWUpID0+IHtcbiAgICAvLyAgICAgbGV0IG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAvLyAgICAgbm9kZS50ZXh0Q29udGVudCA9IHNlcmllWyd0aXRsZSddO1xuICAgIC8vICAgICBub2RlLmNsYXNzTGlzdC5hZGQoJ21vZGVsLWNob2ljZV9fc2VyaWVzLW9wdGlvbicpO1xuICAgIC8vICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChub2RlKTtcbiAgICAvLyAgIH0pO1xuXG4gICAgLy8gICBzZXJpZXNTZWxlY3QuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuXG4gICAgLy8gICBicmFuZEJ1dHRvbi50ZXh0Q29udGVudCA9IGV2dC50YXJnZXQudmFsdWU7XG4gICAgLy8gICBicmFuZE5hbWUgPSBldnQudGFyZ2V0LnZhbHVlO1xuICAgIC8vICAgaWYgKCFicmFuZEJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAvLyAgICAgYnJhbmRCdXR0b24uY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTtcbiAgICAvLyAgIH1cblxuICAgIC8vICAgbGluay5jbGFzc0xpc3QuYWRkKCdkaXNhYmxlZCcpO1xuICAgIC8vICAgbGluay5yZW1vdmVBdHRyaWJ1dGUoJ2hyZWYnKTtcbiAgICAvLyB9XG5cbiAgICAvLyBjb25zdCBvblNlcmllc0l0ZW1DbGljayA9IChldnQpID0+IHtcbiAgICAvLyAgIGxldCB0YXJnZXQgPSBldnQudGFyZ2V0O1xuXG4gICAgLy8gICBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kZWwtY2hvaWNlX19zZXJpZXMtaXRlbScpKSB7XG4gICAgLy8gICAgIHNlcmllc0J1dHRvbi50ZXh0Q29udGVudCA9IHRhcmdldC50ZXh0Q29udGVudDtcbiAgICAvLyAgICAgaWYgKCFzZXJpZXNCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgLy8gICAgICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XG4gICAgLy8gICAgIH1cblxuICAgIC8vICAgICBzZXJpZXNMaXN0LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICAvLyAgICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW5lZCcpO1xuXG4gICAgLy8gICAgIGxpbmsuY2xhc3NMaXN0LnJlbW92ZSgnZGlzYWJsZWQnKTtcbiAgICAvLyAgICAgc2VyaWVzTmFtZSA9IHRhcmdldC50ZXh0Q29udGVudDtcbiAgICAvLyAgICAgbGluay5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBnZXRIcmVmKHNlcmllc05hbWUpKTtcbiAgICAvLyAgIH1cbiAgICAvLyB9XG5cbiAgICAvLyBjb25zdCBvblNlcmllc0NoYW5nZSA9IChldnQpID0+IHtcbiAgICAvLyAgIHNlcmllc0J1dHRvbi50ZXh0Q29udGVudCA9IGV2dC50YXJnZXQudmFsdWU7XG4gICAgLy8gICBpZiAoIXNlcmllc0J1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAvLyAgICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XG4gICAgLy8gICB9XG5cbiAgICAvLyAgIGxpbmsuY2xhc3NMaXN0LnJlbW92ZSgnZGlzYWJsZWQnKTtcbiAgICAvLyAgIHNlcmllc05hbWUgPSBldnQudGFyZ2V0LnZhbHVlO1xuICAgIC8vICAgbGluay5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBnZXRIcmVmKHNlcmllc05hbWUpKTtcbiAgICAvLyB9XG5cbiAgICAvLyBjb25zdCBvbkxpbmtDbGljayA9IChldnQpID0+IHtcbiAgICAvLyAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIC8vICAgbGV0IGhyZWYgPSBldnQudGFyZ2V0LmdldEF0dHJpYnV0ZSgnaHJlZicpO1xuXG4gICAgLy8gICBpZiAoaHJlZiA9PT0gJycpIHtcbiAgICAvLyAgICAgYWxlcnQoJ9CY0L3RgdGC0YDRg9C60YbQuNGPINC/0L4g0YPRgdGC0LDQvdC+0LLQutC1IFdpLUZpINC60L7QvdGC0YDQvtC70LvQtdGA0LAg0LTQu9GPINC00LDQvdC90L7QuSDRgdC10YDQuNC4INC60L7QvdC00LjRhtC40L7QvdC10YDQsCDQsiDRgdC60L7RgNC+0Lwg0LLRgNC10LzQtdC90Lgg0L/QvtGP0LLQuNGC0YHRjy4nKTtcblxuICAgIC8vICAgICByZXR1cm47XG4gICAgLy8gICB9XG5cbiAgICAvLyAgIGRvY3VtZW50LmxvY2F0aW9uLmhyZWYgPSBocmVmO1xuICAgIC8vIH07XG5cbiAgICAvL2xldCBzcGxpdHNEYXRhID0gYmFja2VuZC5sb2FkKGdldERhdGEpO1xuXG4gICAgLy9icmFuZFNlbGVjdC5hcHBlbmRDaGlsZChtYWtlT3B0aW9uTm9kZShzcGxpdHMpKTtcbiAgICAvL21ha2VPcHRpb25Ob2RlKHNwbGl0cyk7XG4gICAgLy9iYWNrZW5kLmxvYWQobWFrZU9wdGlvbk5vZGUpO1xuXG5cbiAgICAvLyBtYWtlU2VsZWN0KGJyYW5kQ2xhc3MpO1xuICAgIC8vIG1ha2VTZWxlY3Qoc2VyaWVzQ2xhc3MpO1xuXG4gICAgLy8galF1ZXJ5KGJyYW5kQ2xhc3MpLnNlbGVjdDIoJ29wZW4nKTtcbiAgICAvLyBqUXVlcnkoYnJhbmRDbGFzcykuc2VsZWN0MignY2xvc2UnKTtcblxuXG4gICAgLy8gY29uc3Qgc2VyaWVzU2VsZWN0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RlbC1jaG9pY2VfX3Nlcmllcy1zZWxlY3QnKTtcblxuXG4gICAgLy8gY29uc3QgaGlkZVNlcmllcyA9ICgpID0+IHtcbiAgICAvLyAgIHNlcmllc1NlbGVjdHMuZm9yRWFjaCgoc2VsZWN0KSA9PiB7XG4gICAgLy8gICAgIGlmICghc2VsZWN0LmNsYXNzTGlzdC5jb250YWlucygnaGlkZGVuJykpIHtcbiAgICAvLyAgICAgICBzZWxlY3QuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgLy8gICAgICAgc2VsZWN0LnJlbW92ZUF0dHJpYnV0ZSgnaWQnKTtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfSlcbiAgICAvLyB9O1xuXG4gICAgLy8gY29uc3Qgc2hvd1NlcmllcyA9IChpZHgpID0+IHtcbiAgICAvLyAgIHNlcmllc1NlbGVjdHNbaWR4XS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICAvLyAgIHNlcmllc1NlbGVjdHNbaWR4XS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3Nlcmllcy1zZWxlY3QnKTtcbiAgICAvLyB9O1xuXG4gICAgLy8galF1ZXJ5KGJyYW5kQ2xhc3MpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgLy8gICBsZXQgaWR4ID0gK2pRdWVyeSgnLm1vZGVsLWNob2ljZV9fYnJhbmQtc2VsZWN0IG9wdGlvbjpzZWxlY3RlZCcpLmF0dHIoJ2RhdGEtaWQnKTtcblxuICAgIC8vICAgaGlkZVNlcmllcygpO1xuICAgIC8vICAgc2hvd1NlcmllcyhpZHggKyAxKTtcblxuICAgIC8vICAgalF1ZXJ5KCcjc2VyaWVzLXNlbGVjdCcpLnNlbGVjdDIoJ29wZW4nKTtcbiAgICAvLyAgIGpRdWVyeSgnI3Nlcmllcy1zZWxlY3QnKS5zZWxlY3QyKCdjbG9zZScpO1xuXG4gICAgLy8gICBqUXVlcnkoJy5tb2RlbC1jaG9pY2VfX2JyYW5kLXNlbGVjdCcpLmFkZENsYXNzKCdzZWxlY3RlZCcpO1xuICAgIC8vICAgalF1ZXJ5KCcubW9kZWwtY2hvaWNlX19zZXJpZXMtc2VsZWN0JykucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XG4gICAgLy8gfSk7XG5cbiAgICAvLyBqUXVlcnkoc2VyaWVzQ2xhc3MpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgLy8gICBpZiAobGluay5jbGFzc0xpc3QuY29udGFpbnMoJ2Rpc2FibGVkJykpIHtcbiAgICAvLyAgICAgbGluay5jbGFzc0xpc3QucmVtb3ZlKCdkaXNhYmxlZCcpO1xuICAgIC8vICAgfVxuXG4gICAgLy8gICBsZXQgdmFsdWUgPSBqUXVlcnkoZXZ0LnRhcmdldCkuY2hpbGRyZW4oJ29wdGlvbjpzZWxlY3RlZCcpLnRleHQoKTtcbiAgICAvLyAgIHNlcmllc05hbWUgPSB2YWx1ZTtcblxuXG4gICAgLy8gICBsaW5rLnNldEF0dHJpYnV0ZSgnaHJlZicsIHNlcmllc05hbWUpO1xuXG4gICAgLy8gICBqUXVlcnkoJy5tb2RlbC1jaG9pY2VfX3Nlcmllcy1zZWxlY3QnKS5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcbiAgICAvLyB9KTtcblxuICAgIC8vUmVzaXplLmluaXQoKTtcbiAgICAvL1Jlc2l6ZS5hZGRMaXN0ZW5lcigpO1xuXG4gICAgYnJhbmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkJyYW5kQ2xpY2spO1xuICAgIC8vc2VyaWVzQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25TZXJpZXNDbGljayk7XG4gICAgLy8gYnJhbmRMaXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25CcmFuZEl0ZW1DbGljayk7XG4gICAgLy8gc2VyaWVzTGlzdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uU2VyaWVzSXRlbUNsaWNrKTtcbiAgICAvLyBicmFuZFNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkJyYW5kQ2hhbmdlKTtcbiAgICAvLyBzZXJpZXNTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25TZXJpZXNDaGFuZ2UpO1xuICAgIC8vIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkxpbmtDbGljayk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgb25PdXRzaWRlQ2xpY2spO1xuXG5cbiAgLy9iYWNrZW5kLmxvYWQobWFrZU9wdGlvbk5vZGUpO1xuXG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgY29uc3Qgd3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lcXVpcG1lbnRfX3dyYXBwZXInKTtcbiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmVxdWlwbWVudF9fY29udGFpbmVyJyk7XG5cbiAgaWYoIXdyYXBwZXIpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBpbml0U3dpcGVyID0gKCkgPT4ge1xuICAgIHJldHVybiBuZXcgU3dpcGVyKCcuZXF1aXBtZW50X19jb250YWluZXInLCB7XG4gICAgICBwYWdpbmF0aW9uOiB7XG4gICAgICAgIGVsOiAnLmVxdWlwbWVudF9fcGFnaW5hdGlvbicsXG4gICAgICAgIHR5cGU6ICdidWxsZXRzJyxcbiAgICAgIH0sXG4gICAgICBsb29wOiB0cnVlLFxuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IGFkZFNsaWRlQ2xhc3MgPSAoZWxlbWVudCkgPT4ge1xuICAgIGxldCBpdGVtcyA9IGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmVxdWlwbWVudF9faXRlbScpO1xuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgnc3dpcGVyLXNsaWRlJyk7XG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgcmVuZGVyU2xpZGVyID0gKCkgPT4ge1xuICAgIGxldCBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcblxuICAgIGxldCB3cmFwcGVyTm9kZSA9IHdyYXBwZXIuY2xvbmVOb2RlKHRydWUpO1xuICAgIHdyYXBwZXJOb2RlLmNsYXNzTmFtZSA9ICdlcXVpcG1lbnRfX3NsaWRlLXdyYXBwZXInO1xuICAgIHdyYXBwZXJOb2RlLmNsYXNzTGlzdC5hZGQoJ3N3aXBlci13cmFwcGVyJyk7XG5cbiAgICBsZXQgcGFnaW5hdGlvbk5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBwYWdpbmF0aW9uTm9kZS5jbGFzc0xpc3QuYWRkKCdlcXVpcG1lbnRfX3BhZ2luYXRpb24nKTtcbiAgICBwYWdpbmF0aW9uTm9kZS5jbGFzc0xpc3QuYWRkKCdzd2lwZXItcGFnaW5hdGlvbicpO1xuXG4gICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQod3JhcHBlck5vZGUpO1xuICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKHBhZ2luYXRpb25Ob2RlKTtcblxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG4gICAgYWRkU2xpZGVDbGFzcyhjb250YWluZXIpO1xuXG4gICAgaW5pdFN3aXBlcigpO1xuICB9O1xuXG4gIHJlbmRlclNsaWRlcigpO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvY2Vzc19fd3JhcHBlcicpO1xuICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvY2Vzc19fY29udGFpbmVyJyk7XG5cbiAgaWYgKCF3cmFwcGVyKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgaW5pdFN3aXBlciA9ICgpID0+IHtcbiAgICByZXR1cm4gbmV3IFN3aXBlcignLnByb2Nlc3NfX2NvbnRhaW5lcicsIHtcbiAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgZWw6ICcucHJvY2Vzc19fcGFnaW5hdGlvbicsXG4gICAgICAgIHR5cGU6ICdidWxsZXRzJyxcbiAgICAgIH0sXG4gICAgICBsb29wOiB0cnVlLFxuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IGFkZFNsaWRlQ2xhc3MgPSAoZWxlbWVudCkgPT4ge1xuICAgIGxldCBpdGVtcyA9IGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnByb2Nlc3NfX2l0ZW0nKTtcbiAgICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ3N3aXBlci1zbGlkZScpO1xuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IGFkZE51bWJlcmluZyA9IChzd2lwZXIpID0+IHtcbiAgICBjb25zdCBudW1iZXJGaWVsZCA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcucHJvY2Vzc19fbnVtYmVyJyk7XG5cbiAgICBzd2lwZXIub24oJ3NsaWRlQ2hhbmdlJywgKCkgPT4ge1xuICAgICAgbnVtYmVyRmllbGQudGV4dENvbnRlbnQgPSBzd2lwZXIucmVhbEluZGV4ICsgMTtcbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCByZW5kZXJTbGlkZXIgPSAoKSA9PiB7XG4gICAgbGV0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuXG4gICAgbGV0IHdyYXBwZXJOb2RlID0gd3JhcHBlci5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgd3JhcHBlck5vZGUuY2xhc3NOYW1lID0gJ3Byb2Nlc3NfX3NsaWRlLXdyYXBwZXInO1xuICAgIHdyYXBwZXJOb2RlLmNsYXNzTGlzdC5hZGQoJ3N3aXBlci13cmFwcGVyJyk7XG5cbiAgICBsZXQgcGFnaW5hdGlvbk5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBwYWdpbmF0aW9uTm9kZS5jbGFzc0xpc3QuYWRkKCdwcm9jZXNzX19wYWdpbmF0aW9uJyk7XG4gICAgcGFnaW5hdGlvbk5vZGUuY2xhc3NMaXN0LmFkZCgnc3dpcGVyLXBhZ2luYXRpb24nKTtcblxuICAgIGxldCBudW1iZXJOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgbnVtYmVyTm9kZS5jbGFzc05hbWUgPSAncHJvY2Vzc19fbnVtYmVyJztcbiAgICBudW1iZXJOb2RlLnRleHRDb250ZW50ID0gMTtcblxuICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKHdyYXBwZXJOb2RlKTtcbiAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChwYWdpbmF0aW9uTm9kZSk7XG4gICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQobnVtYmVyTm9kZSk7XG5cbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuICAgIGFkZFNsaWRlQ2xhc3MoY29udGFpbmVyKTtcblxuICAgIGNvbnN0IHByb2Nlc3NTd2lwZXIgPSBpbml0U3dpcGVyKCk7XG4gICAgYWRkTnVtYmVyaW5nKHByb2Nlc3NTd2lwZXIpO1xuICB9O1xuXG4gIHJlbmRlclNsaWRlcigpO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLW1vZGVsX19mb3JtJyk7XG5cbiAgY29uc3QgZW1haWxJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJpbnB1dFtuYW1lPSdlbWFpbCddXCIpO1xuICBjb25zdCBlbWFpbEVycm9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC1tb2RlbF9fZW1haWwtZXJyb3InKTtcblxuICBjb25zdCBicmFuZElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImlucHV0W25hbWU9J2JyYW5kJ11cIik7XG4gIGNvbnN0IGJyYW5kRXJyb3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLW1vZGVsX19icmFuZC1lcnJvcicpO1xuXG4gIGNvbnN0IG1vZGVsSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRbbmFtZT0nbW9kZWwnXVwiKTtcbiAgY29uc3QgbW9kZWxFcnJvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtbW9kZWxfX21vZGVsLWVycm9yJyk7XG5cbiAgY29uc3QgZmlsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImlucHV0W3R5cGU9J2ZpbGUnXVwiKTtcblxuICBjb25zdCBjaGVja2JveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtbW9kZWxfX2FncmVlbWVudC1pbnB1dCcpO1xuXG4gIGNvbnN0IHN1Ym1pdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtbW9kZWxfX3N1Ym1pdCcpO1xuXG4gIGNvbnN0IHByb2dyZXNzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC1tb2RlbF9fZmlsZS1wcm9ncmVzcycpO1xuICBjb25zdCBiYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLW1vZGVsX19iYXItY3VycmVudCcpO1xuXG4gIGNvbnN0IGZpbGVSZXN1bHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLW1vZGVsX19maWxlLXJlc3VsdCcpO1xuICBjb25zdCBmaWxlSW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC1tb2RlbF9fZmlsZS1pbWFnZScpO1xuICBjb25zdCBmaWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtbW9kZWxfX2ZpbGUtbmFtZScpO1xuICBjb25zdCBmaWxlQ2xlYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLW1vZGVsX19maWxlLWNsb3NlJyk7XG5cbiAgaWYgKCFlbWFpbElucHV0KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgYWRkQ2xhc3NOYW1lID0gKGVsZW1lbnQsIGNsYXNzTmFtZSkgPT4ge1xuICAgIGlmICghZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoY2xhc3NOYW1lKSkge1xuICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHJlbW92ZUNsYXNzTmFtZSA9IChlbGVtZW50LCBjbGFzc05hbWUpID0+IHtcbiAgICBpZiAoZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoY2xhc3NOYW1lKSkge1xuICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzTmFtZSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGVuYWJsZUJ1dHRvbiA9ICgpID0+IHtcbiAgICBzdWJtaXQuaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpICYmIHN1Ym1pdC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gIH07XG5cbiAgY29uc3QgZGlzYWJsZUJ1dHRvbiA9ICgpID0+IHtcbiAgICAhc3VibWl0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSAmJiBzdWJtaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgfTtcblxuICBjb25zdCBpc0Zvcm1GaWxsZWQgPSAoKSA9PiB7XG4gICAgcmV0dXJuIGVtYWlsSW5wdXQudmFsaWRpdHkudmFsaWRcbiAgICAgICYmIGJyYW5kSW5wdXQudmFsdWUgIT09ICcnXG4gICAgICAmJiBtb2RlbElucHV0LnZhbHVlICE9PSAnJ1xuICAgICAgJiYgY2hlY2tib3guY2hlY2tlZFxuICB9O1xuXG4gIGNvbnN0IGNoZWNrRm9ybSA9ICgpID0+IHtcbiAgICBpZiAoaXNGb3JtRmlsbGVkKCkpIHtcbiAgICAgIGVuYWJsZUJ1dHRvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkaXNhYmxlQnV0dG9uKCk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHJlYWRVcmwgPSAoaW5wdXQpID0+IHtcbiAgICBpZiAoaW5wdXQuZmlsZXMgJiYgaW5wdXQuZmlsZXNbMF0pIHtcbiAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuXG4gICAgICByZWFkZXIub25sb2Fkc3RhcnQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBwcm9ncmVzcy5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7XG4gICAgICB9XG5cbiAgICAgIHJlYWRlci5vbnByb2dyZXNzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coTWF0aC5yb3VuZChlLmxvYWRlZCAvIGUudG90YWwgKiAxMDApKTtcbiAgICAgICAgYmFyLnN0eWxlLndpZHRoID0gTWF0aC5yb3VuZChlLmxvYWRlZCAvIGUudG90YWwgKiAxMDApICsgJyUnO1xuICAgICAgfVxuXG4gICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZmlsZUltZy5zZXRBdHRyaWJ1dGUoJ3NyYycsIGUudGFyZ2V0LnJlc3VsdCk7XG4gICAgICAgIGZpbGVOYW1lLnRleHRDb250ZW50ID0gaW5wdXQuZmlsZXNbMF0ubmFtZTtcbiAgICAgICAgIWZpbGVSZXN1bHQuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93JykgJiYgZmlsZVJlc3VsdC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7XG5cbiAgICAgICAgcHJvZ3Jlc3MuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuICAgICAgICBiYXIuc3R5bGUud2lkdGggPSAwO1xuICAgICAgfVxuXG4gICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChpbnB1dC5maWxlc1swXSk7XG4gICAgfVxuICB9XG5cbiAgY29uc3Qgb25UZXh0Rm9jdXMgPSAoZXZ0KSA9PiB7XG4gICAgY29uc3QgaW5wdXQgPSBldnQudGFyZ2V0O1xuXG4gICAgYWRkQ2xhc3NOYW1lKGlucHV0LCAnZmlsbCcpO1xuXG4gICAgaWYgKGlucHV0LnZhbHVlID09PSAnJykge1xuICAgICAgYWRkQ2xhc3NOYW1lKGlucHV0LCAnbWFzaycpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBvblRleHRCbHVyID0gKGV2dCkgPT4ge1xuICAgIGNvbnN0IGlucHV0ID0gZXZ0LnRhcmdldDtcblxuICAgIGlmICghaW5wdXQudmFsdWUpIHtcbiAgICAgIHJlbW92ZUNsYXNzTmFtZShpbnB1dCwgJ2ZpbGwnKTtcbiAgICB9XG5cbiAgICByZW1vdmVDbGFzc05hbWUoaW5wdXQsICdtYXNrJyk7XG4gIH1cblxuICBjb25zdCBvbkVtYWlsSW5wdXQgPSAoZXZ0KSA9PiB7XG4gICAgY29uc3QgaW5wdXQgPSBldnQudGFyZ2V0O1xuXG4gICAgLy8gaWYgKGlucHV0LnZhbHVlID09PSAnJykge1xuICAgIC8vICAgYWRkQ2xhc3NOYW1lKGlucHV0LCAnbWFzaycpO1xuICAgIC8vICAgYWRkQ2xhc3NOYW1lKGlucHV0LCAnZXJyb3InKTtcbiAgICAvLyB9XG5cbiAgICBpZiAoIWVtYWlsSW5wdXQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIGFkZENsYXNzTmFtZShlbWFpbEVycm9yLCAnc2hvdycpO1xuICAgICAgYWRkQ2xhc3NOYW1lKGVtYWlsSW5wdXQsICdlcnJvcicpO1xuICAgIH1cblxuICAgIGlmIChlbWFpbElucHV0LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICByZW1vdmVDbGFzc05hbWUoaW5wdXQsICdlcnJvcicpO1xuICAgICAgcmVtb3ZlQ2xhc3NOYW1lKGVtYWlsRXJyb3IsICdzaG93Jyk7XG4gICAgfVxuXG4gICAgaWYgKGlucHV0LnZhbHVlID09PSAnJykge1xuICAgICAgYWRkQ2xhc3NOYW1lKGlucHV0LCAnbWFzaycpO1xuICAgIH1cblxuICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gJycpIHtcbiAgICAgIHJlbW92ZUNsYXNzTmFtZShpbnB1dCwgJ21hc2snKTtcbiAgICB9XG5cbiAgICBjaGVja0Zvcm0oKTtcbiAgfVxuXG4gIGNvbnN0IG9uQnJhbmRJbnB1dCA9IChldnQpID0+IHtcbiAgICBjb25zdCBpbnB1dCA9IGV2dC50YXJnZXQ7XG5cbiAgICBpZiAoaW5wdXQudmFsdWUgPT09ICcnKSB7XG4gICAgICBhZGRDbGFzc05hbWUoaW5wdXQsICdtYXNrJyk7XG4gICAgICBhZGRDbGFzc05hbWUoaW5wdXQsICdlcnJvcicpO1xuICAgICAgYWRkQ2xhc3NOYW1lKGJyYW5kRXJyb3IsICdzaG93Jyk7XG4gICAgfVxuXG4gICAgaWYgKGlucHV0LnZhbHVlICE9PSAnJykge1xuICAgICAgcmVtb3ZlQ2xhc3NOYW1lKGlucHV0LCAnbWFzaycpO1xuICAgICAgcmVtb3ZlQ2xhc3NOYW1lKGlucHV0LCAnZXJyb3InKTtcbiAgICAgIHJlbW92ZUNsYXNzTmFtZShicmFuZEVycm9yLCAnc2hvdycpO1xuICAgIH1cblxuICAgIGNoZWNrRm9ybSgpO1xuICB9XG5cbiAgY29uc3Qgb25Nb2RlbElucHV0ID0gKGV2dCkgPT4ge1xuICAgIGNvbnN0IGlucHV0ID0gZXZ0LnRhcmdldDtcblxuICAgIGlmIChpbnB1dC52YWx1ZSA9PT0gJycpIHtcbiAgICAgIGFkZENsYXNzTmFtZShpbnB1dCwgJ21hc2snKTtcbiAgICAgIGFkZENsYXNzTmFtZShpbnB1dCwgJ2Vycm9yJyk7XG4gICAgICBhZGRDbGFzc05hbWUobW9kZWxFcnJvciwgJ3Nob3cnKTtcbiAgICB9XG5cbiAgICBpZiAoaW5wdXQudmFsdWUgIT09ICcnKSB7XG4gICAgICByZW1vdmVDbGFzc05hbWUoaW5wdXQsICdtYXNrJyk7XG4gICAgICByZW1vdmVDbGFzc05hbWUoaW5wdXQsICdlcnJvcicpO1xuICAgICAgcmVtb3ZlQ2xhc3NOYW1lKG1vZGVsRXJyb3IsICdzaG93Jyk7XG4gICAgfVxuXG4gICAgY2hlY2tGb3JtKCk7XG4gIH1cblxuICBjb25zdCBvbkZpbGVDbGVhciA9ICgpID0+IHtcbiAgICBmaWxlSW5wdXQudmFsdWUgPSAnJztcblxuICAgIGlmKCEvc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSl7XG4gICAgICBmaWxlSW5wdXQudHlwZSA9ICcnO1xuICAgICAgZmlsZUlucHV0LnR5cGUgPSAnZmlsZSc7XG4gICAgfVxuXG4gICAgZmlsZVJlc3VsdC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XG4gICAgZmlsZU5hbWUudGV4dENvbnRlbnQgPSAnJztcbiAgICBmaWxlSW1nLnJlbW92ZUF0dHJpYnV0ZSgnc3JjJyk7XG4gIH1cblxuICBjb25zdCBvbkZpbGVDaGFuZ2UgPSAoZXZ0KSA9PiB7XG4gICAgcmVhZFVybChldnQudGFyZ2V0KTtcbiAgfVxuXG4gIGNvbnN0IG9uQ2hlY2tib3hDbGljayA9ICgpID0+IHtcbiAgICAhY2hlY2tib3guY2hlY2tlZFxuICAgICAgPyBhZGRDbGFzc05hbWUoY2hlY2tib3gsICdlcnJvcicpXG4gICAgICA6IHJlbW92ZUNsYXNzTmFtZShjaGVja2JveCwgJ2Vycm9yJyk7XG5cbiAgICBjaGVja0Zvcm0oKTtcbiAgfVxuXG4gIGNvbnN0IG9uU3VibWl0ID0gKGV2dCkgPT4ge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgZm9ybS5zdWJtaXQoKTtcbiAgfVxuXG4gIGVtYWlsSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCBvblRleHRGb2N1cyk7XG4gIGVtYWlsSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIG9uVGV4dEJsdXIpO1xuICBlbWFpbElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25FbWFpbElucHV0KTtcblxuICBicmFuZElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgb25UZXh0Rm9jdXMpO1xuICBicmFuZElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBvblRleHRCbHVyKTtcbiAgYnJhbmRJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uQnJhbmRJbnB1dCk7XG5cbiAgbW9kZWxJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIG9uVGV4dEZvY3VzKTtcbiAgbW9kZWxJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgb25UZXh0Qmx1cik7XG4gIG1vZGVsSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbk1vZGVsSW5wdXQpO1xuXG4gIGZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkZpbGVDaGFuZ2UpO1xuICBmaWxlQ2xlYXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkZpbGVDbGVhcik7XG5cbiAgY2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNoZWNrYm94Q2xpY2spO1xuXG4gIHN1Ym1pdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uU3VibWl0KTtcbn0pKCk7XG4iXX0=
