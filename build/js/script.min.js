!function(){const e=document.querySelector(".header__placeholder"),t=document.querySelector(".header__search");if(!t)return;const o=()=>{e.classList.contains("hide"),e.classList.add("hide")};t.value&&o(),t.addEventListener("blur",()=>{t.value?o():(e.classList.contains("hide"),e.classList.remove("hide"))})}(),function(){const e=document.querySelectorAll(".model__link"),t=document.querySelectorAll(".model__image-container");new Swiper(".model__swiper-container",{pagination:{el:".model__swiper-container .model__pagination",type:"bullets",clickable:!0},loop:!0}),e[0]&&(e.forEach(e=>{e.addEventListener("mousedown",t=>{let o=!1;const n=()=>{o=!0},s=t=>{o&&t.preventDefault(),o=!1,e.removeEventListener("mousemove",n),e.removeEventListener("mouseup",s)};e.addEventListener("mousemove",n),e.addEventListener("mouseup",s)}),e.addEventListener("toushstart",t=>{let o=!1;const n=()=>{o=!0},s=t=>{o&&t.preventDefault(),o=!1,e.removeEventListener("touchmove",n),e.removeEventListener("touchend",s)};e.addEventListener("touchmove",n),e.addEventListener("touchend",s)})}),t.forEach(e=>{e.querySelectorAll(".model__image").length>1&&e.classList.add("model__swiper-container")}))}(),function(){const e=document.querySelectorAll(".device__model-item"),t=document.querySelectorAll(".device__wire-popup-mobile"),o=document.querySelectorAll(".device__wire-popup-close"),n=document.querySelector(".device__wire-popup-overlay");if(!e[0])return;e.forEach((e,o)=>{e.addEventListener("click",s=>{e.querySelector(".device__model-not-supported")||s.target.classList.contains("device__wire-popup-close")||(t[o].classList.add("js--show"),n.classList.add("js--show"))})}),o.forEach((e,o)=>{e.addEventListener("click",()=>{t[o].classList.remove("js--show"),n.classList.remove("js--show")})}),n.addEventListener("click",()=>{t.forEach(e=>{e.classList.contains("js--show")&&e.classList.remove("js--show")}),n.classList.remove("js--show")})}(),document.getElementById("animation")&&lottie.loadAnimation({container:document.getElementById("animation"),renderer:"svg",loop:!0,autoplay:!0,path:"data.json"}),function(){var e="https://split.daichicloud.ru/brands/all",t="GET",o=200,n=300,s=function(e,t){var s=new XMLHttpRequest;return s.timeout=1e4,s.responseType="json",s.addEventListener("load",(function(){!function(e){return e.status<o||e.status>n}(s)?e(s.response):t("Данные не загрузились. Причина: "+s.status+" "+s.statusText)})),s.addEventListener("error",(function(){t("Произошла ошибка соединения")})),s.addEventListener("timeout",(function(){t("Запрос не успел выполниться за "+s.timeout+"мс")})),s},r=function(e){e.remove()},a=function(e){var t=document.createElement("div");t.style="z-index: 100; margin: 0 auto; text-align: center; background-color: red;",t.style.position="absolute",t.style.left=0,t.style.right=0,t.style.fontSize="30px",t.textContent=e,document.body.insertAdjacentElement("afterbegin",t),window.setTimeout(r,2e3,t)};window.backend={load:function(o,n){var r=s(o,n||a);r.open(t,e),r.send()}}}(),jQuery,function(){const e=document.querySelector(".model-choice__brand-list"),t=document.querySelector(".model-choice__brand-choice");if(!e)return;t.addEventListener("click",()=>{if(!e.classList.contains("show"))return e.classList.add("show"),void t.classList.add("opened");e.classList.contains("show")&&(e.classList.remove("show"),t.classList.remove("opened"))}),document.addEventListener("mousedown",o=>{let n=o.target;n.classList.contains("model-choice__brand-choice")||n.classList.contains("model-choice__brand-item")||n.classList.contains("model-choice__brand-list")||!e.classList.contains("show")||(e.classList.remove("show"),t.classList.remove("opened"))})}(),function(){const e=document.querySelectorAll(".equipment__container");if(!e)return;e.forEach(e=>{let t=document.createDocumentFragment(),o=e.parentNode.querySelector(".equipment__wrapper").cloneNode(!0);o.className="equipment__slide-wrapper",o.classList.add("swiper-wrapper");let n=document.createElement("div");n.classList.add("equipment__pagination"),n.classList.add("swiper-pagination"),t.appendChild(o),t.appendChild(n),e.appendChild(t),e.querySelectorAll(".equipment__item").forEach(e=>{e.classList.add("swiper-slide")}),(e=>{new Swiper(e,{pagination:{el:".equipment__pagination",type:"bullets"},loop:!0})})(e)})}(),function(){const e=document.querySelectorAll(".process__container");if(!e)return;e.forEach(e=>{let t=document.createDocumentFragment(),o=e.parentNode.querySelector(".process__wrapper").cloneNode(!0);o.className="process__slide-wrapper",o.classList.add("swiper-wrapper");let n=document.createElement("div");n.classList.add("process__pagination"),n.classList.add("swiper-pagination");let s=document.createElement("div");s.className="process__number",s.textContent=1,t.appendChild(o),t.appendChild(n),t.appendChild(s),e.appendChild(t),e.querySelectorAll(".process__item").forEach(e=>{e.classList.add("swiper-slide")}),((e,t)=>{const o=t.querySelector(".process__number");e.on("slideChange",()=>{o.textContent=e.realIndex+1})})((e=>new Swiper(e,{pagination:{el:".process__pagination",type:"bullets"},loop:!0}))(e),e)})}(),function(){const e=document.querySelector(".add-model__form"),t=document.querySelector("input[name='email']"),o=document.querySelector(".add-model__email-error"),n=document.querySelector("input[name='brand']"),s=document.querySelector(".add-model__brand-error"),r=document.querySelector("input[name='model']"),a=document.querySelector(".add-model__model-error"),i=document.querySelector("input[type='file']"),d=document.querySelector(".add-model__agreement-input"),l=document.querySelector(".add-model__submit"),c=document.querySelector(".add-model__file-progress"),u=document.querySelector(".add-model__bar-current"),m=document.querySelector(".add-model__file-label"),p=document.querySelector(".add-model__file-wrap"),v=document.querySelector(".add-model__file-result"),_=document.querySelector(".add-model__file-image"),h=document.querySelector(".add-model__file-name"),f=document.querySelector(".add-model__file-close");if(!t)return;function L(e){e.preventDefault(),e.stopPropagation()}function g(e){m.classList.add("highlight")}function w(e){m.classList.remove("highlight")}function L(e){e.preventDefault(),e.stopPropagation()}["dragenter","dragover","dragleave","drop"].forEach(e=>{p.addEventListener(e,L,!1)}),["dragenter","dragover"].forEach(e=>{p.addEventListener(e,g,!1)}),["dragleave","drop"].forEach(e=>{p.addEventListener(e,w,!1)}),p.addEventListener("drop",(function(e){let t=e.dataTransfer.files;i.files&&i.files[0]&&(i.value="",/safari/i.test(navigator.userAgent)||(i.type="",i.type="file"),v.classList.remove("show"),h.textContent="",_.removeAttribute("src"));i.files=t,k()}),!1);const y=(e,t)=>{e.classList.contains(t)||e.classList.add(t)},E=(e,t)=>{e.classList.contains(t)&&e.classList.remove(t)},q=()=>{t.validity.valid&&""!==n.value&&""!==r.value&&d.checked?l.hasAttribute("disabled")&&l.removeAttribute("disabled"):!l.hasAttribute("disabled")&&l.setAttribute("disabled","")},S=e=>{const t=e.target;y(t,"fill"),""===t.value&&y(t,"mask")},b=e=>{const t=e.target;t.value||E(t,"fill"),E(t,"mask")},k=()=>{(e=>{if(e.files&&e.files[0]){var t=new FileReader;t.onloadstart=function(e){c.classList.add("show")},t.onprogress=function(e){console.log(Math.round(e.loaded/e.total*100)),u.style.width=Math.round(e.loaded/e.total*100)+"%"},t.onload=function(t){_.setAttribute("src",t.target.result),h.textContent=e.files[0].name,!v.classList.contains("show")&&v.classList.add("show"),c.classList.remove("show"),u.style.width=0},t.readAsDataURL(e.files[0])}})(i)};t.addEventListener("focus",S),t.addEventListener("blur",b),t.addEventListener("input",e=>{const n=e.target;t.validity.valid||(y(o,"show"),y(t,"error")),t.validity.valid&&(E(n,"error"),E(o,"show")),""===n.value&&y(n,"mask"),""!==n.value&&E(n,"mask"),q()}),n.addEventListener("focus",S),n.addEventListener("blur",b),n.addEventListener("input",e=>{const t=e.target;""===t.value&&(y(t,"mask"),y(t,"error"),y(s,"show")),""!==t.value&&(E(t,"mask"),E(t,"error"),E(s,"show")),q()}),r.addEventListener("focus",S),r.addEventListener("blur",b),r.addEventListener("input",e=>{const t=e.target;""===t.value&&(y(t,"mask"),y(t,"error"),y(a,"show")),""!==t.value&&(E(t,"mask"),E(t,"error"),E(a,"show")),q()}),i.addEventListener("change",k),f.addEventListener("click",()=>{i.value="",/safari/i.test(navigator.userAgent)||(i.type="",i.type="file"),v.classList.remove("show"),h.textContent="",_.removeAttribute("src")}),d.addEventListener("click",()=>{d.checked?E(d,"error"):y(d,"error"),q()}),l.addEventListener("click",t=>{t.preventDefault(),e.submit()})}(),function(){const e=$(".device__warning-icon"),t=$(".device__stroke-chip"),o=$(".device__stroke-popup"),n=$(".device__warning-popup");e.on("mouseenter",(function(){const e=$(this).next();e.offset().left+e.outerWidth()-$(window).outerWidth()>0&&e.css("transform","translateX(calc(-100% + 40px))")})),e.on("mouseleave",(function(){$(this).next().css("transform","")})),t.on("click",(function(){$(this).next().addClass("opened")})),o.on("click",(function(e){($(e.target).hasClass("device__stroke-popup")||$(e.target).hasClass("device__stroke-popup-close")||$(e.target).parents(".device__stroke-popup-close").length>0)&&$(this).removeClass("opened")})),e.on("click",(function(){$(this).next().addClass("opened")})),n.on("click",(function(e){($(e.target).hasClass("device__warning-popup")||$(e.target).hasClass("device__stroke-popup-close")||$(e.target).parents(".device__stroke-popup-close").length>0)&&$(this).removeClass("opened")}));new Swiper(".model__image-container",{pagination:{el:".model__image-container .model__pagination",type:"bullets",clickable:!0},loop:!0})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlYXJjaC5qcyIsIm1vZGVsLmpzIiwicG9wdXAuanMiLCJhbmltYXRpb24uanMiLCJiYWNrZW5kLmpzIiwic2VsZWN0LmpzIiwiY2hvaWNlLmpzIiwiZXF1aXBtZW50LmpzIiwicHJvY2Vzcy5qcyIsImZvcm0uanMiLCJkZXZpY2UuanMiXSwibmFtZXMiOlsicGxhY2Vob2xkZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpbnB1dCIsImhpZGUiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImFkZCIsInZhbHVlIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZSIsIm1vZGVsTGlua3MiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW1hZ2VDb250YWluZXJzIiwiU3dpcGVyIiwicGFnaW5hdGlvbiIsImVsIiwidHlwZSIsImNsaWNrYWJsZSIsImxvb3AiLCJmb3JFYWNoIiwibGluayIsImV2dCIsImlzRHJhZ2VkIiwib25Nb3VzZU1vdmUiLCJvbk1vdXNlVXAiLCJwcmV2ZW50RGVmYXVsdCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJvblRvdWNoTW92ZSIsIm9uVG91Y2hFbmQiLCJjb250YWluZXIiLCJsZW5ndGgiLCJ3aXJlQnV0dG9ucyIsInBvcHVwcyIsImNsb3NlQnV0dG9ucyIsIm92ZXJsYXkiLCJ3aXJlQnV0dG9uIiwiaWR4IiwidGFyZ2V0IiwiY2xvc2VCdXR0b24iLCJwb3B1cCIsImdldEVsZW1lbnRCeUlkIiwibG90dGllIiwibG9hZEFuaW1hdGlvbiIsInJlbmRlcmVyIiwiYXV0b3BsYXkiLCJwYXRoIiwiUmVxVXJsIiwiUmVxTWV0aG9kIiwiUmVxU3RhdHVzIiwiY3JlYXRlUmVxdWVzdCIsIm9uTG9hZCIsIm9uRXJyb3IiLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsInRpbWVvdXQiLCJyZXNwb25zZVR5cGUiLCJzdGF0dXMiLCJpc0Vycm9yU3RhdHVzIiwicmVzcG9uc2UiLCJzdGF0dXNUZXh0IiwicmVtb3ZlRWxlbWVudCIsImVsZW1lbnQiLCJvbkFueUVycm9yIiwibWVzc2FnZSIsIm5vZGUiLCJjcmVhdGVFbGVtZW50Iiwic3R5bGUiLCJwb3NpdGlvbiIsImxlZnQiLCJyaWdodCIsImZvbnRTaXplIiwidGV4dENvbnRlbnQiLCJib2R5IiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50Iiwid2luZG93Iiwic2V0VGltZW91dCIsImJhY2tlbmQiLCJsb2FkIiwicmVxIiwib3BlbiIsInNlbmQiLCJqUXVlcnkiLCJicmFuZExpc3QiLCJicmFuZEJ1dHRvbiIsIml0ZW0iLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJ3cmFwcGVyTm9kZSIsInBhcmVudE5vZGUiLCJjbG9uZU5vZGUiLCJjbGFzc05hbWUiLCJwYWdpbmF0aW9uTm9kZSIsImFwcGVuZENoaWxkIiwiaW5pdFN3aXBlciIsIm51bWJlck5vZGUiLCJzd2lwZXIiLCJudW1iZXJGaWVsZCIsIm9uIiwicmVhbEluZGV4IiwiYWRkTnVtYmVyaW5nIiwiZm9ybSIsImVtYWlsSW5wdXQiLCJlbWFpbEVycm9yIiwiYnJhbmRJbnB1dCIsImJyYW5kRXJyb3IiLCJtb2RlbElucHV0IiwibW9kZWxFcnJvciIsImZpbGVJbnB1dCIsImNoZWNrYm94Iiwic3VibWl0IiwicHJvZ3Jlc3MiLCJiYXIiLCJmaWxlTGFiZWwiLCJmaWxlRHJvcEFyZWEiLCJmaWxlUmVzdWx0IiwiZmlsZUltZyIsImZpbGVOYW1lIiwiZmlsZUNsZWFyIiwicHJldmVudERlZmF1bHRzIiwiZSIsInN0b3BQcm9wYWdhdGlvbiIsImhpZ2hsaWdodCIsInVuaGlnaGxpZ2h0IiwiZXZlbnROYW1lIiwiZmlsZXMiLCJkYXRhVHJhbnNmZXIiLCJ0ZXN0IiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwicmVtb3ZlQXR0cmlidXRlIiwib25GaWxlQ2hhbmdlIiwiYWRkQ2xhc3NOYW1lIiwicmVtb3ZlQ2xhc3NOYW1lIiwiY2hlY2tGb3JtIiwidmFsaWRpdHkiLCJ2YWxpZCIsImNoZWNrZWQiLCJoYXNBdHRyaWJ1dGUiLCJzZXRBdHRyaWJ1dGUiLCJvblRleHRGb2N1cyIsIm9uVGV4dEJsdXIiLCJyZWFkZXIiLCJGaWxlUmVhZGVyIiwib25sb2Fkc3RhcnQiLCJvbnByb2dyZXNzIiwiY29uc29sZSIsImxvZyIsIk1hdGgiLCJyb3VuZCIsImxvYWRlZCIsInRvdGFsIiwid2lkdGgiLCJvbmxvYWQiLCJyZXN1bHQiLCJuYW1lIiwicmVhZEFzRGF0YVVSTCIsInJlYWRVcmwiLCIkd2FybmluZyIsIiQiLCIkY2hpcCIsIiRwb3B1cENhYmxlIiwiJHBvcHVwV2FybmluZyIsIiRwb3B1cCIsInRoaXMiLCJuZXh0Iiwib2Zmc2V0Iiwib3V0ZXJXaWR0aCIsImNzcyIsImFkZENsYXNzIiwiaGFzQ2xhc3MiLCJwYXJlbnRzIiwicmVtb3ZlQ2xhc3MiXSwibWFwcGluZ3MiOiJDQUFBLFdBQ0EsTUFBQUEsRUFBQUMsU0FBQUMsY0FBQSx3QkFDQUMsRUFBQUYsU0FBQUMsY0FBQSxtQkFFQSxJQUFBQyxFQUNBLE9BR0EsTUFBQUMsRUFBQSxLQUNBSixFQUFBSyxVQUFBQyxTQUFBLFFBQ0FOLEVBQUFLLFVBQUFFLElBQUEsU0FnQkFKLEVBQUFLLE9BQ0FKLElBR0FELEVBQUFNLGlCQUFBLE9BWkEsS0FDQU4sRUFBQUssTUFDQUosS0FOQUosRUFBQUssVUFBQUMsU0FBQSxRQUNBTixFQUFBSyxVQUFBSyxPQUFBLFdBZkEsR0NBQSxXQUNBLE1BQUFDLEVBQUFWLFNBQUFXLGlCQUFBLGdCQUNBQyxFQUFBWixTQUFBVyxpQkFBQSwyQkFHQSxJQUFBRSxPQUFBLDJCQUFBLENBQ0FDLFdBQUEsQ0FDQUMsR0FBQSw4Q0FDQUMsS0FBQSxVQUNBQyxXQUFBLEdBRUFDLE1BQUEsSUFNQVIsRUFBQSxLQWNBQSxFQUFBUyxRQUFBQyxJQUNBQSxFQUFBWixpQkFBQSxZQUFBYSxJQUNBLElBQUFDLEdBQUEsRUFFQSxNQUFBQyxFQUFBLEtBQ0FELEdBQUEsR0FHQUUsRUFBQUgsSUFDQUMsR0FDQUQsRUFBQUksaUJBR0FILEdBQUEsRUFDQUYsRUFBQU0sb0JBQUEs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QUFBLHlCQUNBWCxFQUFBdkMsRUFBQWxGLFFBQUFvSSxTQUFBLCtCQUNBWCxFQUFBdkMsRUFBQWxGLFFBQUFxSSxRQUFBLCtCQUFBNUksT0FBQSxJQUVBZ0ksRUFBQUssTUFBQVEsWUFBQSxhQUlBZCxFQUFBNUQsR0FBQSxTQUFBLFdBQ0E2RCxFQUFBSyxNQUFBQyxPQUVBSSxTQUFBLGFBR0FQLEVBQUFoRSxHQUFBLFNBQUEsU0FBQXNCLElBRUF1QyxFQUFBdkMsRUFBQWxGLFFBQUFvSSxTQUFBLDBCQUNBWCxFQUFBdkMsRUFBQWxGLFFBQUFvSSxTQUFBLCtCQUNBWCxFQUFBdkMsRUFBQWxGLFFBQUFxSSxRQUFBLCtCQUFBNUksT0FBQSxJQUVBZ0ksRUFBQUssTUFBQVEsWUFBQSxhQUlBLElBQUE5SixPQUFBLDBCQUFBLENBQ0FDLFdBQUEsQ0FDQUMsR0FBQSw2Q0FDQUMsS0FBQSxVQUNBQyxXQUFBLEdBRUFDLE1BQUEsSUEzREEiLCJmaWxlIjoic2NyaXB0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IHBsYWNlaG9sZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9fcGxhY2Vob2xkZXInKTtcbiAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX19zZWFyY2gnKTtcblxuICBpZiAoIWlucHV0KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgaGlkZSA9ICgpID0+IHtcbiAgICAhcGxhY2Vob2xkZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRlJylcbiAgICAgIHBsYWNlaG9sZGVyLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKTtcbiAgfTtcblxuICBjb25zdCBzaG93ID0gKCkgPT4ge1xuICAgIHBsYWNlaG9sZGVyLmNsYXNzTGlzdC5jb250YWlucygnaGlkZScpXG4gICAgICBwbGFjZWhvbGRlci5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJyk7XG4gIH07XG5cbiAgY29uc3Qgb25CbHVyID0gKCkgPT4ge1xuICAgIGlmIChpbnB1dC52YWx1ZSkge1xuICAgICAgaGlkZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzaG93KCk7XG4gICAgfVxuICB9O1xuXG4gIGlmIChpbnB1dC52YWx1ZSkge1xuICAgIGhpZGUoKTtcbiAgfTtcblxuICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgb25CbHVyKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICBjb25zdCBtb2RlbExpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RlbF9fbGlua1wiKTtcbiAgY29uc3QgaW1hZ2VDb250YWluZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RlbF9faW1hZ2UtY29udGFpbmVyXCIpO1xuXG4gIGNvbnN0IGluaXRTd2lwZXIgPSAoKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBTd2lwZXIoXCIubW9kZWxfX3N3aXBlci1jb250YWluZXJcIiwge1xuICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICBlbDogXCIubW9kZWxfX3N3aXBlci1jb250YWluZXIgLm1vZGVsX19wYWdpbmF0aW9uXCIsXG4gICAgICAgIHR5cGU6IFwiYnVsbGV0c1wiLFxuICAgICAgICBjbGlja2FibGU6IHRydWUsXG4gICAgICB9LFxuICAgICAgbG9vcDogdHJ1ZSxcbiAgICB9KTtcbiAgfTtcblxuICBpbml0U3dpcGVyKCk7XG5cbiAgaWYgKCFtb2RlbExpbmtzWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gbW9kZWxMaW5rcy5mb3JFYWNoKChsaW5rKSA9PiB7XG4gIC8vICAgbGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldnQpID0+IHtcblxuICAvLyAgICAgY29uc29sZS5sb2coZXZ0LnRhcmdldC50YWdOYW1lKTtcbiAgLy8gICAgIGlmIChldnQudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2ltZycpIHtcbiAgLy8gICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIC8vICAgICB9XG4gIC8vICAgfSlcbiAgLy8gfSk7XG5cbiAgbW9kZWxMaW5rcy5mb3JFYWNoKChsaW5rKSA9PiB7XG4gICAgbGluay5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcbiAgICAgIGxldCBpc0RyYWdlZCA9IGZhbHNlO1xuXG4gICAgICBjb25zdCBvbk1vdXNlTW92ZSA9ICgpID0+IHtcbiAgICAgICAgaXNEcmFnZWQgPSB0cnVlO1xuICAgICAgfTtcblxuICAgICAgY29uc3Qgb25Nb3VzZVVwID0gKGV2dCkgPT4ge1xuICAgICAgICBpZiAoaXNEcmFnZWQpIHtcbiAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlzRHJhZ2VkID0gZmFsc2U7XG4gICAgICAgIGxpbmsucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBvbk1vdXNlTW92ZSk7XG4gICAgICAgIGxpbmsucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgb25Nb3VzZVVwKTtcbiAgICAgIH07XG5cbiAgICAgIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBvbk1vdXNlTW92ZSk7XG4gICAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIG9uTW91c2VVcCk7XG4gICAgfSk7XG5cbiAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VzaHN0YXJ0XCIsIChldnQpID0+IHtcbiAgICAgIGxldCBpc0RyYWdlZCA9IGZhbHNlO1xuXG4gICAgICBjb25zdCBvblRvdWNoTW92ZSA9ICgpID0+IHtcbiAgICAgICAgaXNEcmFnZWQgPSB0cnVlO1xuICAgICAgfTtcblxuICAgICAgY29uc3Qgb25Ub3VjaEVuZCA9IChldnQpID0+IHtcbiAgICAgICAgaWYgKGlzRHJhZ2VkKSB7XG4gICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBpc0RyYWdlZCA9IGZhbHNlO1xuICAgICAgICBsaW5rLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIiwgb25Ub3VjaE1vdmUpO1xuICAgICAgICBsaW5rLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCBvblRvdWNoRW5kKTtcbiAgICAgIH07XG5cbiAgICAgIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNobW92ZVwiLCBvblRvdWNoTW92ZSk7XG4gICAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCBvblRvdWNoRW5kKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaW1hZ2VDb250YWluZXJzLmZvckVhY2goKGNvbnRhaW5lcikgPT4ge1xuICAgIGNvbnN0IGltYWdlcyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGVsX19pbWFnZVwiKTtcblxuICAgIGlmIChpbWFnZXMubGVuZ3RoID4gMSkge1xuICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJtb2RlbF9fc3dpcGVyLWNvbnRhaW5lclwiKTtcbiAgICB9XG4gIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IHdpcmVCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmRldmljZV9fbW9kZWwtaXRlbScpO1xuICBjb25zdCBwb3B1cHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZGV2aWNlX193aXJlLXBvcHVwLW1vYmlsZScpO1xuICBjb25zdCBjbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZGV2aWNlX193aXJlLXBvcHVwLWNsb3NlJyk7XG4gIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGV2aWNlX193aXJlLXBvcHVwLW92ZXJsYXknKTtcblxuICBpZiAoIXdpcmVCdXR0b25zWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgY2xvc2VBbnlQb3B1cCA9ICgpID0+IHtcbiAgICBwb3B1cHMuZm9yRWFjaCgocG9wdXApID0+IHtcbiAgICAgIGlmIChwb3B1cC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS1zaG93JykpIHtcbiAgICAgICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgnanMtLXNob3cnKTtcbiAgICAgIH1cbiAgICB9KVxuICB9O1xuXG4gIHdpcmVCdXR0b25zLmZvckVhY2goKHdpcmVCdXR0b24sIGlkeCkgPT4ge1xuICAgIHdpcmVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAod2lyZUJ1dHRvbi5xdWVyeVNlbGVjdG9yKCcuZGV2aWNlX19tb2RlbC1ub3Qtc3VwcG9ydGVkJykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdkZXZpY2VfX3dpcmUtcG9wdXAtY2xvc2UnKSkge1xuICAgICAgICBwb3B1cHNbaWR4XS5jbGFzc0xpc3QuYWRkKCdqcy0tc2hvdycpO1xuICAgICAgICBvdmVybGF5LmNsYXNzTGlzdC5hZGQoJ2pzLS1zaG93Jyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGNsb3NlQnV0dG9ucy5mb3JFYWNoKChjbG9zZUJ1dHRvbiwgaWR4KSA9PiB7XG4gICAgY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICBwb3B1cHNbaWR4XS5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tc2hvdycpO1xuICAgICAgb3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tc2hvdycpO1xuICAgIH0pO1xuICB9KTtcblxuICBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGNsb3NlQW55UG9wdXAoKTtcbiAgICBvdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1zaG93Jyk7XG4gIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FuaW1hdGlvbicpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbG90dGllLmxvYWRBbmltYXRpb24oe1xuICAgIGNvbnRhaW5lcjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FuaW1hdGlvbicpLCAvLyB0aGUgZG9tIGVsZW1lbnQgdGhhdCB3aWxsIGNvbnRhaW4gdGhlIGFuaW1hdGlvblxuICAgIHJlbmRlcmVyOiAnc3ZnJyxcbiAgICBsb29wOiB0cnVlLFxuICAgIGF1dG9wbGF5OiB0cnVlLFxuICAgIHBhdGg6ICdkYXRhLmpzb24nIC8vIHRoZSBwYXRoIHRvIHRoZSBhbmltYXRpb24ganNvblxuICB9KTtcbn0pKCk7XG4iLCIndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBSZXFVcmwgPSB7XG4gICAgR0VUOiAnaHR0cHM6Ly9zcGxpdC5kYWljaGljbG91ZC5ydS9icmFuZHMvYWxsJyxcbiAgICAvL1BPU1Q6ICdodHRwczovL2pzLmR1bXAuYWNhZGVteS9rZWtzdGFncmFtJ1xuICB9O1xuXG4gIHZhciBSZXFNZXRob2QgPSB7XG4gICAgR0VUOiAnR0VUJyxcbiAgICBQT1NUOiAnUE9TVCdcbiAgfTtcblxuICB2YXIgUmVxU3RhdHVzID0ge1xuICAgIE9LOiAyMDAsXG4gICAgTVVMVElQTEVfQ0hPSUNFUzogMzAwLFxuICB9O1xuXG4gIHZhciBUSU1FT1VUID0gMTAwMDA7XG5cbiAgdmFyIGlzRXJyb3JTdGF0dXMgPSBmdW5jdGlvbiAoeGhyKSB7XG4gICAgcmV0dXJuIHhoci5zdGF0dXMgPCBSZXFTdGF0dXMuT0tcbiAgICAgIHx8IHhoci5zdGF0dXMgPiBSZXFTdGF0dXMuTVVMVElQTEVfQ0hPSUNFUztcbiAgfTtcblxuICB2YXIgY3JlYXRlUmVxdWVzdCA9IGZ1bmN0aW9uIChvbkxvYWQsIG9uRXJyb3IpIHtcbiAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgICB4aHIudGltZW91dCA9IFRJTUVPVVQ7XG4gICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdqc29uJztcblxuICAgIHhoci5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKGlzRXJyb3JTdGF0dXMoeGhyKSkge1xuICAgICAgICBvbkVycm9yKCfQlNCw0L3QvdGL0LUg0L3QtSDQt9Cw0LPRgNGD0LfQuNC70LjRgdGMLiDQn9GA0LjRh9C40L3QsDogJyArIHhoci5zdGF0dXMgKyAnICcgKyB4aHIuc3RhdHVzVGV4dCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgb25Mb2FkKHhoci5yZXNwb25zZSk7XG4gICAgfSk7XG5cbiAgICB4aHIuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCBmdW5jdGlvbiAoKSB7XG4gICAgICBvbkVycm9yKCfQn9GA0L7QuNC30L7RiNC70LAg0L7RiNC40LHQutCwINGB0L7QtdC00LjQvdC10L3QuNGPJyk7XG4gICAgfSk7XG5cbiAgICB4aHIuYWRkRXZlbnRMaXN0ZW5lcigndGltZW91dCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIG9uRXJyb3IoJ9CX0LDQv9GA0L7RgSDQvdC1INGD0YHQv9C10Lsg0LLRi9C/0L7Qu9C90LjRgtGM0YHRjyDQt9CwICcgKyB4aHIudGltZW91dCArICfQvNGBJyk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4geGhyO1xuICB9O1xuXG4gIHZhciByZW1vdmVFbGVtZW50ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICBlbGVtZW50LnJlbW92ZSgpO1xuICB9O1xuXG4gIHZhciBvbkFueUVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICB2YXIgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIG5vZGUuc3R5bGUgPSAnei1pbmRleDogMTAwOyBtYXJnaW46IDAgYXV0bzsgdGV4dC1hbGlnbjogY2VudGVyOyBiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7JztcbiAgICBub2RlLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICBub2RlLnN0eWxlLmxlZnQgPSAwO1xuICAgIG5vZGUuc3R5bGUucmlnaHQgPSAwO1xuICAgIG5vZGUuc3R5bGUuZm9udFNpemUgPSAnMzBweCc7XG5cbiAgICBub2RlLnRleHRDb250ZW50ID0gbWVzc2FnZTtcbiAgICBkb2N1bWVudC5ib2R5Lmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJiZWdpbicsIG5vZGUpO1xuICAgIHdpbmRvdy5zZXRUaW1lb3V0KHJlbW92ZUVsZW1lbnQsIDIwMDAsIG5vZGUpO1xuICB9O1xuXG4gIHdpbmRvdy5iYWNrZW5kID0ge1xuICAgIGxvYWQ6IGZ1bmN0aW9uIChvbkxvYWQsIG9uRXJyb3IpIHtcbiAgICAgIHZhciByZXEgPSBjcmVhdGVSZXF1ZXN0KG9uTG9hZCwgb25FcnJvciB8fCBvbkFueUVycm9yKTtcbiAgICAgIHJlcS5vcGVuKFJlcU1ldGhvZC5HRVQsIFJlcVVybC5HRVQpO1xuICAgICAgcmVxLnNlbmQoKTtcbiAgICB9LFxuXG4gICAgLy8gc2F2ZTogZnVuY3Rpb24gKGRhdGEsIG9uTG9hZCwgb25FcnJvcikge1xuICAgIC8vICAgdmFyIHJlcSA9IGNyZWF0ZVJlcXVlc3Qob25Mb2FkLCBvbkVycm9yKTtcbiAgICAvLyAgIHJlcS5vcGVuKFJlcU1ldGhvZC5QT1NULCBSZXFVcmwuUE9TVCk7XG4gICAgLy8gICByZXEuc2VuZChkYXRhKTtcbiAgICAvLyB9XG4gIH07XG59KSgpO1xuXG5cblxuXG4iLCIvLyAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcbi8vICAgLy8gJCgnLm1vZGVsLWNob2ljZV9fYnJhbmQtc2VsZWN0Jykuc2VsZWN0Mih7XG4vLyAgIC8vICAgbWluaW11bVJlc3VsdHNGb3JTZWFyY2g6IC0xLFxuLy8gICAvLyB9KTtcblxuLy8gICAvLyAkKCcubW9kZWwtY2hvaWNlX19zZXJpZXMtc2VsZWN0Jykuc2VsZWN0Mih7XG4vLyAgIC8vICAgbWluaW11bVJlc3VsdHNGb3JTZWFyY2g6IC0xLFxuLy8gICAvLyB9KTtcblxuLy8gICBmdW5jdGlvbiBtYWtlU2VsZWN0KGVsZW1lbnQpIHtcbi8vICAgICAkKGVsZW1lbnQpLnNlbGVjdDIoe1xuLy8gICAgICAgbWluaW11bVJlc3VsdHNGb3JTZWFyY2g6IC0xLFxuLy8gICAgIH0pO1xuLy8gICB9O1xuXG5cblxuXG4vLyAgIHdpbmRvdy5tYWtlU2VsZWN0ID0gbWFrZVNlbGVjdDtcblxuLy8gICBjb25zb2xlLmxvZyh3aW5kb3cubWFrZVNlbGVjdCk7XG5cbi8vIH0pO1xuXG5cbihmdW5jdGlvbigkKSB7XG4gIC8vIGZ1bmN0aW9uIG1ha2VTZWxlY3QoZWxlbWVudENsYXNzKSB7XG4gIC8vICAgJChlbGVtZW50Q2xhc3MpLnNlbGVjdDIoe1xuICAvLyAgICAgbWluaW11bVJlc3VsdHNGb3JTZWFyY2g6IC0xLFxuICAvLyAgIH0pO1xuICAvLyB9O1xuXG4gIC8vIHdpbmRvdy5tYWtlU2VsZWN0ID0gbWFrZVNlbGVjdDtcbn0pKGpRdWVyeSk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAvLyBjb25zdCBzcGxpdHMgPSBbXG4gIC8vICAge1xuICAvLyAgICAgXCJpZFwiOjcsXG4gIC8vICAgICBcInRpdGxlXCI6XCJBeGlvbWFcIixcbiAgLy8gICAgIFwic2VyaWVzXCI6W1xuICAvLyAgICAgICB7XG4gIC8vICAgICAgICAgXCJpZFwiOjYzLFxuICAvLyAgICAgICAgIFwidGl0bGVcIjpcIkFTWF9BXCJcbiAgLy8gICAgICAgfSxcbiAgLy8gICAgICAge1xuICAvLyAgICAgICAgIFwiaWRcIjo2MixcbiAgLy8gICAgICAgICBcInRpdGxlXCI6XCJBU1hfQVpcIlxuICAvLyAgICAgICB9XG4gIC8vICAgICBdXG4gIC8vICAgfSxcbiAgLy8gICB7XCJpZFwiOjYsXCJ0aXRsZVwiOlwiRGFpY2hpXCIsXCJzZXJpZXNcIjpbe1wiaWRcIjo0NSxcInRpdGxlXCI6XCJDYXJib24gREFfRFZRXCJ9LHtcImlkXCI6NDYsXCJ0aXRsZVwiOlwiRXZlcmVzdCBEQV9FVlFcIn0se1wiaWRcIjo0MyxcInRpdGxlXCI6XCJQZWFrIERBX0FWUVNcIn0se1wiaWRcIjo0MixcInRpdGxlXCI6XCJYLXRyZW1lIFBlYWsgREFfQVZRU1wifV19LFxuICAvLyAgIHtcImlkXCI6MSxcInRpdGxlXCI6XCJEYWlraW5cIixcInNlcmllc1wiOlt7XCJpZFwiOjExLFwidGl0bGVcIjpcIkNvbWZvcmEgRlRYLUpcXC9HVlwifSx7XCJpZFwiOjI2LFwidGl0bGVcIjpcIkNvbWZvcmEgRlRYUC1LM1wifSx7XCJpZFwiOjI3LFwidGl0bGVcIjpcIkNvbWZvcmEgRlRYUC1MXCJ9LHtcImlkXCI6MjgsXCJ0aXRsZVwiOlwiQ29tZm9yYSBGVFhQLU1cIn0se1wiaWRcIjoyMyxcInRpdGxlXCI6XCJFbXVyYSBGVFhHLUxcIn0se1wiaWRcIjoxOCxcInRpdGxlXCI6XCJFbXVyYSBGVFhKLU1cIn0se1wiaWRcIjoyMCxcInRpdGxlXCI6XCJGTFhTLUJcIn0se1wiaWRcIjoxNixcInRpdGxlXCI6XCJGVFhCLUJcIn0se1wiaWRcIjo2NSxcInRpdGxlXCI6XCJGVFhTLUVcIn0se1wiaWRcIjo2NCxcInRpdGxlXCI6XCJGVFhTLUpcXC9HXCJ9LHtcImlkXCI6MjEsXCJ0aXRsZVwiOlwiRlZYTS1GXCJ9LHtcImlkXCI6MjIsXCJ0aXRsZVwiOlwiRlZYUy1GXCJ9LHtcImlkXCI6MTksXCJ0aXRsZVwiOlwiTmV4dXJhIEZWWEctS1wifSx7XCJpZFwiOjI0LFwidGl0bGVcIjpcIlBlcmZlcmEgRlRYTS1OXCJ9LHtcImlkXCI6MjUsXCJ0aXRsZVwiOlwiUGVyZmVyYSBGVFhTLUtcIn0se1wiaWRcIjoxLFwidGl0bGVcIjpcIlNlbnNpcmEgRlRYQi1DXCJ9XX0sXG4gIC8vICAge1wiaWRcIjoyLFwidGl0bGVcIjpcIktlbnRhdHN1XCIsXCJzZXJpZXNcIjpbe1wiaWRcIjo0OSxcInRpdGxlXCI6XCJCcmF2byAgS1NHQl9IRkFOXCJ9LHtcImlkXCI6NTAsXCJ0aXRsZVwiOlwiQnJhdm8gIEtTR0JBX0haQU5cIn0se1wiaWRcIjo1NixcInRpdGxlXCI6XCJLTUdCQV9IWkFOXCJ9LHtcImlkXCI6NTcsXCJ0aXRsZVwiOlwiS01HQkJfSFpBTlwifSx7XCJpZFwiOjUyLFwidGl0bGVcIjpcIlRlYW0gIEtTR1RfSFpBTlwifSx7XCJpZFwiOjQ3LFwidGl0bGVcIjpcIlRpdGFuIEdlbmVzaXMgS1NHWFwifSx7XCJpZFwiOjUxLFwidGl0bGVcIjpcIlR1cmluIEtTR1VfSFpBTlwifV19LFxuICAvLyAgIHtcImlkXCI6OCxcInRpdGxlXCI6XCJNaWRlYVwiLFwic2VyaWVzXCI6W3tcImlkXCI6NjEsXCJ0aXRsZVwiOlwiQmxhbmMgTVNNQVwifSx7XCJpZFwiOjYwLFwidGl0bGVcIjpcIkJsYW5jIE1TTUEgRVJQIChNQSlcIn0se1wiaWRcIjo1OSxcInRpdGxlXCI6XCJNaXNzaW9uIE1TTUIgKE1CKVwifSx7XCJpZFwiOjU4LFwidGl0bGVcIjpcIlVsdGltYXRlIENvbWZvcnQgTVNNVCAoTVQpXCJ9XX1dO1xuXG5cbiAgLy9sZXQgc2VyaWVzTmFtZSA9ICcnO1xuICAvL2xldCBicmFuZE5hbWUgPSAnJztcblxuICBjb25zdCBicmFuZExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kZWwtY2hvaWNlX19icmFuZC1saXN0Jyk7XG4gIGNvbnN0IGJyYW5kQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGVsLWNob2ljZV9fYnJhbmQtY2hvaWNlJyk7XG4gIC8vY29uc3QgYnJhbmRTZWxlY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kZWwtY2hvaWNlX19zZWxlY3QtYnJhbmQnKTtcblxuICBpZiAoIWJyYW5kTGlzdCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vbGV0IGN1cnJlbnRCcmFuZElkeCA9IC0xO1xuICAvL2xldCBjdXJyZW50T3B0aW9uSWR4ID0gLTE7XG5cbiAgLy9jb25zdCBicmFuZFNlbGVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RlbC1jaG9pY2VfX2JyYW5kLXNlbGVjdCcpO1xuICAvL2NvbnN0IHNlcmllc1dyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kZWwtY2hvaWNlX19zZXJpZXMtd3JhcHBlcicpO1xuICAvL2NvbnN0IHNlcmllc1RlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlcmllcycpLmNvbnRlbnQucXVlcnlTZWxlY3RvcignLm1vZGVsLWNob2ljZV9fc2VyaWVzLXNlbGVjdCcpO1xuXG4gIC8vY29uc3QgbGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RlbC1jaG9pY2VfX2xpbmsnKTtcblxuICAvLyBjb25zdCBnZXRIcmVmID0gKHNlcmllcykgPT4ge1xuICAvLyAgIGxldCBocmVmID0gJyc7XG5cbiAgLy8gICBQQUdFUy5mb3JFYWNoKChwYWdlKSA9PiB7XG4gIC8vICAgICBpZiAoaHJlZiA9PT0gJycpIHtcbiAgLy8gICAgICAgaWYgKHNlcmllcy50b0xvd2VyQ2FzZSgpLmluZGV4T2YocGFnZSkgIT09IC0xKSB7XG4gIC8vICAgICAgICAgaHJlZiA9IHBhZ2U7XG4gIC8vICAgICAgIH1cbiAgLy8gICAgIH1cbiAgLy8gICB9KTtcblxuICAvLyAgIHJldHVybiBocmVmID09PSAnJyA/ICcnIDogaHJlZiArICcuaHRtbCc7XG4gIC8vIH07XG5cbiAgY29uc3Qgb25CcmFuZENsaWNrID0gKCkgPT4ge1xuICAgIGlmICghYnJhbmRMaXN0LmNsYXNzTGlzdC5jb250YWlucygnc2hvdycpKSB7XG4gICAgICBicmFuZExpc3QuY2xhc3NMaXN0LmFkZCgnc2hvdycpO1xuICAgICAgYnJhbmRCdXR0b24uY2xhc3NMaXN0LmFkZCgnb3BlbmVkJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGJyYW5kTGlzdC5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3cnKSkge1xuICAgICAgYnJhbmRMaXN0LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICAgIGJyYW5kQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW5lZCcpO1xuICAgIH1cbiAgICAvLyBqUXVlcnkoJy5tb2RlbC1jaG9pY2VfX2JyYW5kLWxpc3QnKS5tQ3VzdG9tU2Nyb2xsYmFyKHtcbiAgICAvLyAgIHNldEhlaWdodDogMTg5LFxuICAgIC8vICAgYXV0b0hpZGVTY3JvbGxiYXI6IGZhbHNlLFxuICAgIC8vICAgdGhlbWU6ICdkYXJrJyxcbiAgICAvLyAgIG1vdXNlV2hlZWxQaXhlbHM6IDIwMCxcbiAgICAvLyAgIGNvbnRlbnRUb3VjaFNjcm9sbDogdHJ1ZVxuICAgIC8vIH0pO1xuICB9O1xuXG4gIC8vIGNvbnN0IG9uU2VyaWVzQ2xpY2sgPSAoKSA9PiB7XG4gIC8vICAgaWYgKCFzZXJpZXNMaXN0LmNsYXNzTGlzdC5jb250YWlucygnc2hvdycpKSB7XG4gIC8vICAgICBzZXJpZXNMaXN0LmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTtcbiAgLy8gICAgIHNlcmllc0J1dHRvbi5jbGFzc0xpc3QuYWRkKCdvcGVuZWQnKTtcbiAgLy8gICAgIC8vIGNvbnNvbGUubG9nKHNlcmllc0xpc3QuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuYm90dG9tIC0gd2luZG93LmlubmVySGVpZ2h0KTtcbiAgLy8gICAgIHJldHVybjtcbiAgLy8gICB9XG5cbiAgLy8gICBpZiAoc2VyaWVzTGlzdC5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3cnKSkge1xuICAvLyAgICAgc2VyaWVzTGlzdC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XG4gIC8vICAgICBzZXJpZXNCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnb3BlbmVkJyk7XG4gIC8vICAgfVxuICAvLyB9O1xuXG4gIGNvbnN0IG9uT3V0c2lkZUNsaWNrID0gKGV2dCkgPT4ge1xuICAgIGxldCB0YXJnZXQgPSBldnQudGFyZ2V0O1xuXG4gICAgaWYgKFxuICAgICAgIXRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGVsLWNob2ljZV9fYnJhbmQtY2hvaWNlJylcbiAgICAgICYmICF0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RlbC1jaG9pY2VfX2JyYW5kLWl0ZW0nKVxuICAgICAgJiYgIXRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGVsLWNob2ljZV9fYnJhbmQtbGlzdCcpXG4gICAgICAmJiBicmFuZExpc3QuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93JylcbiAgICApIHtcbiAgICAgIGJyYW5kTGlzdC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XG4gICAgICBicmFuZEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuZWQnKTtcbiAgICB9XG5cbiAgICAvLyBpZiAoXG4gICAgLy8gICAhdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kZWwtY2hvaWNlX19zZXJpZXMtY2hvaWNlJylcbiAgICAvLyAgICYmICF0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RlbC1jaG9pY2VfX3Nlcmllcy1pdGVtJylcbiAgICAvLyAgICYmICF0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RlbC1jaG9pY2VfX3Nlcmllcy1saXN0JylcbiAgICAvLyAgICYmIHNlcmllc0xpc3QuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93JylcbiAgICAvLyApIHtcbiAgICAvLyAgIHNlcmllc0xpc3QuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuICAgIC8vICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW5lZCcpO1xuICAgIC8vIH1cbiAgfTtcblxuXG4gICAgLy8gbGV0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIC8vIGxldCBpID0gMDtcblxuICAgIC8vIGFyci5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgLy8gICBsZXQgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgLy8gICBub2RlLnRleHRDb250ZW50ID0gaXRlbVsndGl0bGUnXTtcbiAgICAvLyAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnbW9kZWwtY2hvaWNlX19icmFuZC1pdGVtJyk7XG4gICAgLy8gICBub2RlLnNldEF0dHJpYnV0ZSgnZGF0YS1pZCcsIGkpO1xuICAgIC8vICAgaSsrO1xuICAgIC8vICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQobm9kZSk7XG5cbiAgICAvLyAgIC8vIGxldCBzZXJpZXNTZWxlY3QgPSBzZXJpZXNUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgLy8gICAvLyBzZXJpZXNTZWxlY3QuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgLy8gICAvLyBzZXJpZXNTZWxlY3Quc2V0QXR0cmlidXRlKCduYW1lJywgaXRlbVsndGl0bGUnXSk7XG5cbiAgICAvLyAgIC8vIGl0ZW0uc2VyaWVzLmZvckVhY2goKHNlcmllKSA9PiB7XG4gICAgLy8gICAvLyAgIGxldCBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgLy8gICAvLyAgIG5vZGUuc2V0QXR0cmlidXRlKCd2YWx1ZScsIHNlcmllWyd0aXRsZSddKTtcbiAgICAvLyAgIC8vICAgbm9kZS50ZXh0Q29udGVudCA9IHNlcmllWyd0aXRsZSddO1xuICAgIC8vICAgLy8gICBzZXJpZXNTZWxlY3QuYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgLy8gICAvLyB9KTtcblxuICAgIC8vICAgLy8gc2VyaWVzV3JhcHBlci5hcHBlbmRDaGlsZChzZXJpZXNTZWxlY3QpO1xuICAgIC8vIH0pO1xuXG4gICAgLy8gYnJhbmRMaXN0LmFwcGVuZENoaWxkKGZyYWdtZW50KTtcblxuXG4gICAgLy8gbGV0IGZyYWdtZW50MSA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAvLyBsZXQgaiA9IDA7XG5cbiAgICAvLyBhcnIuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgIC8vICAgbGV0IG5vZGUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgLy8gICBub2RlMS50ZXh0Q29udGVudCA9IGl0ZW1bJ3RpdGxlJ107XG4gICAgLy8gICBub2RlMS5jbGFzc0xpc3QuYWRkKCdtb2RlbC1jaG9pY2VfX2JyYW5kLW9wdGlvbicpO1xuICAgIC8vICAgbm9kZTEuc2V0QXR0cmlidXRlKCdkYXRhLWlkJywgaSk7XG4gICAgLy8gICBqKys7XG4gICAgLy8gICBmcmFnbWVudDEuYXBwZW5kQ2hpbGQobm9kZTEpO1xuXG4gICAgLy8gICAvLyBsZXQgc2VyaWVzU2VsZWN0ID0gc2VyaWVzVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xuICAgIC8vICAgLy8gc2VyaWVzU2VsZWN0LmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgIC8vICAgLy8gc2VyaWVzU2VsZWN0LnNldEF0dHJpYnV0ZSgnbmFtZScsIGl0ZW1bJ3RpdGxlJ10pO1xuXG4gICAgLy8gICAvLyBpdGVtLnNlcmllcy5mb3JFYWNoKChzZXJpZSkgPT4ge1xuICAgIC8vICAgLy8gICBsZXQgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xuICAgIC8vICAgLy8gICBub2RlLnNldEF0dHJpYnV0ZSgndmFsdWUnLCBzZXJpZVsndGl0bGUnXSk7XG4gICAgLy8gICAvLyAgIG5vZGUudGV4dENvbnRlbnQgPSBzZXJpZVsndGl0bGUnXTtcbiAgICAvLyAgIC8vICAgc2VyaWVzU2VsZWN0LmFwcGVuZENoaWxkKG5vZGUpO1xuICAgIC8vICAgLy8gfSk7XG5cbiAgICAvLyAgIC8vIHNlcmllc1dyYXBwZXIuYXBwZW5kQ2hpbGQoc2VyaWVzU2VsZWN0KTtcbiAgICAvLyB9KTtcblxuICAgIC8vIGJyYW5kU2VsZWN0LmFwcGVuZENoaWxkKGZyYWdtZW50MSk7XG5cblxuXG4gICAgLy8gY29uc3Qgb25CcmFuZEl0ZW1DbGljayA9IChldnQpID0+IHtcbiAgICAvLyAgIGxldCB0YXJnZXQgPSBldnQudGFyZ2V0O1xuICAgIC8vICAgbGV0IGlkeCA9ICt0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLWlkJyk7XG5cbiAgICAvLyAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RlbC1jaG9pY2VfX2JyYW5kLWl0ZW0nKSkge1xuICAgIC8vICAgICBpZiAoY3VycmVudEJyYW5kSWR4ID09PSBpZHgpIHtcbiAgICAvLyAgICAgICBicmFuZExpc3QuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuICAgIC8vICAgICAgIGJyYW5kQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW5lZCcpO1xuICAgIC8vICAgICB9XG5cbiAgICAvLyAgICAgaWYgKGN1cnJlbnRCcmFuZElkeCAhPT0gaWR4KSB7XG4gICAgLy8gICAgICAgc2VyaWVzTGlzdC5pbm5lckhUTUwgPSAnJztcblxuICAgIC8vICAgICAgIHNlcmllc0J1dHRvbi50ZXh0Q29udGVudCA9ICfQktGL0LHRgNCw0YLRjCDQuNC3INGB0L/QuNGB0LrQsCc7XG4gICAgLy8gICAgICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7XG5cbiAgICAvLyAgICAgICBsZXQgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgLy8gICAgICAgbGV0IGlkeCA9ICt0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLWlkJyk7XG5cbiAgICAvLyAgICAgICBhcnJbaWR4XS5zZXJpZXMuZm9yRWFjaCgoc2VyaWUpID0+IHtcbiAgICAvLyAgICAgICAgIGxldCBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICAvLyAgICAgICAgIG5vZGUudGV4dENvbnRlbnQgPSBzZXJpZVsndGl0bGUnXTtcbiAgICAvLyAgICAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnbW9kZWwtY2hvaWNlX19zZXJpZXMtaXRlbScpO1xuICAgIC8vICAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgLy8gICAgICAgfSk7XG5cbiAgICAvLyAgICAgICBzZXJpZXNMaXN0LmFwcGVuZENoaWxkKGZyYWdtZW50KTtcbiAgICAvLyAgICAgICBjdXJyZW50QnJhbmRJZHggPSBpZHg7XG5cbiAgICAvLyAgICAgICBicmFuZEJ1dHRvbi50ZXh0Q29udGVudCA9IHRhcmdldC50ZXh0Q29udGVudDtcbiAgICAvLyAgICAgICBicmFuZE5hbWUgPSB0YXJnZXQudGV4dENvbnRlbnQ7XG4gICAgLy8gICAgICAgaWYgKCFicmFuZEJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAvLyAgICAgICAgIGJyYW5kQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XG4gICAgLy8gICAgICAgfVxuXG4gICAgLy8gICAgICAgaWYgKHNlcmllc0J1dHRvbi5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgICAvLyAgICAgICAgIHNlcmllc0J1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgLy8gICAgICAgfVxuXG4gICAgLy8gICAgICAgYnJhbmRMaXN0LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICAvLyAgICAgICBicmFuZEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuZWQnKTtcblxuICAgIC8vICAgICAgIGxpbmsuY2xhc3NMaXN0LmFkZCgnZGlzYWJsZWQnKTtcbiAgICAvLyAgICAgICBsaW5rLnJlbW92ZUF0dHJpYnV0ZSgnaHJlZicpO1xuICAgIC8vICAgICB9XG4gICAgLy8gICB9XG4gICAgLy8gfVxuXG4gICAgLy8gY29uc3Qgb25CcmFuZENoYW5nZSA9IChldnQpID0+IHtcbiAgICAvLyAgIGN1cnJlbnRPcHRpb25JZHggPSBldnQudGFyZ2V0LnNlbGVjdGVkSW5kZXggLSAxO1xuICAgIC8vICAgc2VyaWVzU2VsZWN0LmlubmVySFRNTCA9ICcnO1xuXG4gICAgLy8gICBzZXJpZXNCdXR0b24udGV4dENvbnRlbnQgPSAn0JLRi9Cx0YDQsNGC0Ywg0LjQtyDRgdC/0LjRgdC60LAnO1xuICAgIC8vICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7XG5cbiAgICAvLyAgIGxldCBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgLy8gICBub2RlLnRleHRDb250ZW50ID0gJyc7XG4gICAgLy8gICBub2RlLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gICAgLy8gICBub2RlLnNldEF0dHJpYnV0ZSgnc2VsZWN0ZWQnLCAnJyk7XG4gICAgLy8gICBub2RlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cbiAgICAvLyAgIHNlcmllc1NlbGVjdC5hcHBlbmRDaGlsZChub2RlKTtcblxuICAgIC8vICAgbGV0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuXG4gICAgLy8gICBpZiAoc2VyaWVzU2VsZWN0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgIC8vICAgICBzZXJpZXNTZWxlY3QucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIC8vICAgfVxuXG5cbiAgICAvLyAgIGFycltjdXJyZW50T3B0aW9uSWR4XS5zZXJpZXMuZm9yRWFjaCgoc2VyaWUpID0+IHtcbiAgICAvLyAgICAgbGV0IG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAvLyAgICAgbm9kZS50ZXh0Q29udGVudCA9IHNlcmllWyd0aXRsZSddO1xuICAgIC8vICAgICBub2RlLmNsYXNzTGlzdC5hZGQoJ21vZGVsLWNob2ljZV9fc2VyaWVzLW9wdGlvbicpO1xuICAgIC8vICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChub2RlKTtcbiAgICAvLyAgIH0pO1xuXG4gICAgLy8gICBzZXJpZXNTZWxlY3QuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuXG4gICAgLy8gICBicmFuZEJ1dHRvbi50ZXh0Q29udGVudCA9IGV2dC50YXJnZXQudmFsdWU7XG4gICAgLy8gICBicmFuZE5hbWUgPSBldnQudGFyZ2V0LnZhbHVlO1xuICAgIC8vICAgaWYgKCFicmFuZEJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAvLyAgICAgYnJhbmRCdXR0b24uY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTtcbiAgICAvLyAgIH1cblxuICAgIC8vICAgbGluay5jbGFzc0xpc3QuYWRkKCdkaXNhYmxlZCcpO1xuICAgIC8vICAgbGluay5yZW1vdmVBdHRyaWJ1dGUoJ2hyZWYnKTtcbiAgICAvLyB9XG5cbiAgICAvLyBjb25zdCBvblNlcmllc0l0ZW1DbGljayA9IChldnQpID0+IHtcbiAgICAvLyAgIGxldCB0YXJnZXQgPSBldnQudGFyZ2V0O1xuXG4gICAgLy8gICBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kZWwtY2hvaWNlX19zZXJpZXMtaXRlbScpKSB7XG4gICAgLy8gICAgIHNlcmllc0J1dHRvbi50ZXh0Q29udGVudCA9IHRhcmdldC50ZXh0Q29udGVudDtcbiAgICAvLyAgICAgaWYgKCFzZXJpZXNCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgLy8gICAgICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XG4gICAgLy8gICAgIH1cblxuICAgIC8vICAgICBzZXJpZXNMaXN0LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICAvLyAgICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW5lZCcpO1xuXG4gICAgLy8gICAgIGxpbmsuY2xhc3NMaXN0LnJlbW92ZSgnZGlzYWJsZWQnKTtcbiAgICAvLyAgICAgc2VyaWVzTmFtZSA9IHRhcmdldC50ZXh0Q29udGVudDtcbiAgICAvLyAgICAgbGluay5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBnZXRIcmVmKHNlcmllc05hbWUpKTtcbiAgICAvLyAgIH1cbiAgICAvLyB9XG5cbiAgICAvLyBjb25zdCBvblNlcmllc0NoYW5nZSA9IChldnQpID0+IHtcbiAgICAvLyAgIHNlcmllc0J1dHRvbi50ZXh0Q29udGVudCA9IGV2dC50YXJnZXQudmFsdWU7XG4gICAgLy8gICBpZiAoIXNlcmllc0J1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAvLyAgICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XG4gICAgLy8gICB9XG5cbiAgICAvLyAgIGxpbmsuY2xhc3NMaXN0LnJlbW92ZSgnZGlzYWJsZWQnKTtcbiAgICAvLyAgIHNlcmllc05hbWUgPSBldnQudGFyZ2V0LnZhbHVlO1xuICAgIC8vICAgbGluay5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBnZXRIcmVmKHNlcmllc05hbWUpKTtcbiAgICAvLyB9XG5cbiAgICAvLyBjb25zdCBvbkxpbmtDbGljayA9IChldnQpID0+IHtcbiAgICAvLyAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIC8vICAgbGV0IGhyZWYgPSBldnQudGFyZ2V0LmdldEF0dHJpYnV0ZSgnaHJlZicpO1xuXG4gICAgLy8gICBpZiAoaHJlZiA9PT0gJycpIHtcbiAgICAvLyAgICAgYWxlcnQoJ9CY0L3RgdGC0YDRg9C60YbQuNGPINC/0L4g0YPRgdGC0LDQvdC+0LLQutC1IFdpLUZpINC60L7QvdGC0YDQvtC70LvQtdGA0LAg0LTQu9GPINC00LDQvdC90L7QuSDRgdC10YDQuNC4INC60L7QvdC00LjRhtC40L7QvdC10YDQsCDQsiDRgdC60L7RgNC+0Lwg0LLRgNC10LzQtdC90Lgg0L/QvtGP0LLQuNGC0YHRjy4nKTtcblxuICAgIC8vICAgICByZXR1cm47XG4gICAgLy8gICB9XG5cbiAgICAvLyAgIGRvY3VtZW50LmxvY2F0aW9uLmhyZWYgPSBocmVmO1xuICAgIC8vIH07XG5cbiAgICAvL2xldCBzcGxpdHNEYXRhID0gYmFja2VuZC5sb2FkKGdldERhdGEpO1xuXG4gICAgLy9icmFuZFNlbGVjdC5hcHBlbmRDaGlsZChtYWtlT3B0aW9uTm9kZShzcGxpdHMpKTtcbiAgICAvL21ha2VPcHRpb25Ob2RlKHNwbGl0cyk7XG4gICAgLy9iYWNrZW5kLmxvYWQobWFrZU9wdGlvbk5vZGUpO1xuXG5cbiAgICAvLyBtYWtlU2VsZWN0KGJyYW5kQ2xhc3MpO1xuICAgIC8vIG1ha2VTZWxlY3Qoc2VyaWVzQ2xhc3MpO1xuXG4gICAgLy8galF1ZXJ5KGJyYW5kQ2xhc3MpLnNlbGVjdDIoJ29wZW4nKTtcbiAgICAvLyBqUXVlcnkoYnJhbmRDbGFzcykuc2VsZWN0MignY2xvc2UnKTtcblxuXG4gICAgLy8gY29uc3Qgc2VyaWVzU2VsZWN0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RlbC1jaG9pY2VfX3Nlcmllcy1zZWxlY3QnKTtcblxuXG4gICAgLy8gY29uc3QgaGlkZVNlcmllcyA9ICgpID0+IHtcbiAgICAvLyAgIHNlcmllc1NlbGVjdHMuZm9yRWFjaCgoc2VsZWN0KSA9PiB7XG4gICAgLy8gICAgIGlmICghc2VsZWN0LmNsYXNzTGlzdC5jb250YWlucygnaGlkZGVuJykpIHtcbiAgICAvLyAgICAgICBzZWxlY3QuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgLy8gICAgICAgc2VsZWN0LnJlbW92ZUF0dHJpYnV0ZSgnaWQnKTtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfSlcbiAgICAvLyB9O1xuXG4gICAgLy8gY29uc3Qgc2hvd1NlcmllcyA9IChpZHgpID0+IHtcbiAgICAvLyAgIHNlcmllc1NlbGVjdHNbaWR4XS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICAvLyAgIHNlcmllc1NlbGVjdHNbaWR4XS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3Nlcmllcy1zZWxlY3QnKTtcbiAgICAvLyB9O1xuXG4gICAgLy8galF1ZXJ5KGJyYW5kQ2xhc3MpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgLy8gICBsZXQgaWR4ID0gK2pRdWVyeSgnLm1vZGVsLWNob2ljZV9fYnJhbmQtc2VsZWN0IG9wdGlvbjpzZWxlY3RlZCcpLmF0dHIoJ2RhdGEtaWQnKTtcblxuICAgIC8vICAgaGlkZVNlcmllcygpO1xuICAgIC8vICAgc2hvd1NlcmllcyhpZHggKyAxKTtcblxuICAgIC8vICAgalF1ZXJ5KCcjc2VyaWVzLXNlbGVjdCcpLnNlbGVjdDIoJ29wZW4nKTtcbiAgICAvLyAgIGpRdWVyeSgnI3Nlcmllcy1zZWxlY3QnKS5zZWxlY3QyKCdjbG9zZScpO1xuXG4gICAgLy8gICBqUXVlcnkoJy5tb2RlbC1jaG9pY2VfX2JyYW5kLXNlbGVjdCcpLmFkZENsYXNzKCdzZWxlY3RlZCcpO1xuICAgIC8vICAgalF1ZXJ5KCcubW9kZWwtY2hvaWNlX19zZXJpZXMtc2VsZWN0JykucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XG4gICAgLy8gfSk7XG5cbiAgICAvLyBqUXVlcnkoc2VyaWVzQ2xhc3MpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgLy8gICBpZiAobGluay5jbGFzc0xpc3QuY29udGFpbnMoJ2Rpc2FibGVkJykpIHtcbiAgICAvLyAgICAgbGluay5jbGFzc0xpc3QucmVtb3ZlKCdkaXNhYmxlZCcpO1xuICAgIC8vICAgfVxuXG4gICAgLy8gICBsZXQgdmFsdWUgPSBqUXVlcnkoZXZ0LnRhcmdldCkuY2hpbGRyZW4oJ29wdGlvbjpzZWxlY3RlZCcpLnRleHQoKTtcbiAgICAvLyAgIHNlcmllc05hbWUgPSB2YWx1ZTtcblxuXG4gICAgLy8gICBsaW5rLnNldEF0dHJpYnV0ZSgnaHJlZicsIHNlcmllc05hbWUpO1xuXG4gICAgLy8gICBqUXVlcnkoJy5tb2RlbC1jaG9pY2VfX3Nlcmllcy1zZWxlY3QnKS5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcbiAgICAvLyB9KTtcblxuICAgIC8vUmVzaXplLmluaXQoKTtcbiAgICAvL1Jlc2l6ZS5hZGRMaXN0ZW5lcigpO1xuXG4gICAgYnJhbmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkJyYW5kQ2xpY2spO1xuICAgIC8vc2VyaWVzQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25TZXJpZXNDbGljayk7XG4gICAgLy8gYnJhbmRMaXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25CcmFuZEl0ZW1DbGljayk7XG4gICAgLy8gc2VyaWVzTGlzdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uU2VyaWVzSXRlbUNsaWNrKTtcbiAgICAvLyBicmFuZFNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkJyYW5kQ2hhbmdlKTtcbiAgICAvLyBzZXJpZXNTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25TZXJpZXNDaGFuZ2UpO1xuICAgIC8vIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkxpbmtDbGljayk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgb25PdXRzaWRlQ2xpY2spO1xuXG5cbiAgLy9iYWNrZW5kLmxvYWQobWFrZU9wdGlvbk5vZGUpO1xuXG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgLy9jb25zdCB3cmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmVxdWlwbWVudF9fd3JhcHBlcicpO1xuICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmVxdWlwbWVudF9fY29udGFpbmVyXCIpO1xuXG4gIGlmICghY29udGFpbmVyKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgaW5pdFN3aXBlciA9IChpdGVtKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBTd2lwZXIoaXRlbSwge1xuICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICBlbDogXCIuZXF1aXBtZW50X19wYWdpbmF0aW9uXCIsXG4gICAgICAgIHR5cGU6IFwiYnVsbGV0c1wiLFxuICAgICAgfSxcbiAgICAgIGxvb3A6IHRydWUsXG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgYWRkU2xpZGVDbGFzcyA9IChlbGVtZW50KSA9PiB7XG4gICAgbGV0IGl0ZW1zID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmVxdWlwbWVudF9faXRlbVwiKTtcbiAgICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoXCJzd2lwZXItc2xpZGVcIik7XG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgcmVuZGVyU2xpZGVyID0gKCkgPT4ge1xuICAgIGNvbnRhaW5lci5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBsZXQgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG5cbiAgICAgIGxldCB3cmFwcGVyTm9kZSA9IGl0ZW0ucGFyZW50Tm9kZVxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5lcXVpcG1lbnRfX3dyYXBwZXJcIilcbiAgICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgIHdyYXBwZXJOb2RlLmNsYXNzTmFtZSA9IFwiZXF1aXBtZW50X19zbGlkZS13cmFwcGVyXCI7XG4gICAgICB3cmFwcGVyTm9kZS5jbGFzc0xpc3QuYWRkKFwic3dpcGVyLXdyYXBwZXJcIik7XG5cbiAgICAgIGxldCBwYWdpbmF0aW9uTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICBwYWdpbmF0aW9uTm9kZS5jbGFzc0xpc3QuYWRkKFwiZXF1aXBtZW50X19wYWdpbmF0aW9uXCIpO1xuICAgICAgcGFnaW5hdGlvbk5vZGUuY2xhc3NMaXN0LmFkZChcInN3aXBlci1wYWdpbmF0aW9uXCIpO1xuXG4gICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCh3cmFwcGVyTm9kZSk7XG4gICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChwYWdpbmF0aW9uTm9kZSk7XG5cbiAgICAgIGl0ZW0uYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuICAgICAgYWRkU2xpZGVDbGFzcyhpdGVtKTtcblxuICAgICAgaW5pdFN3aXBlcihpdGVtKTtcbiAgICB9KTtcbiAgfTtcblxuICByZW5kZXJTbGlkZXIoKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAvL2NvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvY2Vzc19fd3JhcHBlcicpO1xuICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByb2Nlc3NfX2NvbnRhaW5lclwiKTtcblxuICBpZiAoIWNvbnRhaW5lcikge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGluaXRTd2lwZXIgPSAoaXRlbSkgPT4ge1xuICAgIHJldHVybiBuZXcgU3dpcGVyKGl0ZW0sIHtcbiAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgZWw6IFwiLnByb2Nlc3NfX3BhZ2luYXRpb25cIixcbiAgICAgICAgdHlwZTogXCJidWxsZXRzXCIsXG4gICAgICB9LFxuICAgICAgbG9vcDogdHJ1ZSxcbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBhZGRTbGlkZUNsYXNzID0gKGVsZW1lbnQpID0+IHtcbiAgICBsZXQgaXRlbXMgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJvY2Vzc19faXRlbVwiKTtcbiAgICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoXCJzd2lwZXItc2xpZGVcIik7XG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgYWRkTnVtYmVyaW5nID0gKHN3aXBlciwgZWwpID0+IHtcbiAgICBjb25zdCBudW1iZXJGaWVsZCA9IGVsLnF1ZXJ5U2VsZWN0b3IoXCIucHJvY2Vzc19fbnVtYmVyXCIpO1xuXG4gICAgc3dpcGVyLm9uKFwic2xpZGVDaGFuZ2VcIiwgKCkgPT4ge1xuICAgICAgbnVtYmVyRmllbGQudGV4dENvbnRlbnQgPSBzd2lwZXIucmVhbEluZGV4ICsgMTtcbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCByZW5kZXJTbGlkZXIgPSAoKSA9PiB7XG4gICAgY29udGFpbmVyLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIGxldCBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcblxuICAgICAgbGV0IHdyYXBwZXJOb2RlID0gaXRlbS5wYXJlbnROb2RlXG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLnByb2Nlc3NfX3dyYXBwZXJcIilcbiAgICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgIHdyYXBwZXJOb2RlLmNsYXNzTmFtZSA9IFwicHJvY2Vzc19fc2xpZGUtd3JhcHBlclwiO1xuICAgICAgd3JhcHBlck5vZGUuY2xhc3NMaXN0LmFkZChcInN3aXBlci13cmFwcGVyXCIpO1xuXG4gICAgICBsZXQgcGFnaW5hdGlvbk5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgcGFnaW5hdGlvbk5vZGUuY2xhc3NMaXN0LmFkZChcInByb2Nlc3NfX3BhZ2luYXRpb25cIik7XG4gICAgICBwYWdpbmF0aW9uTm9kZS5jbGFzc0xpc3QuYWRkKFwic3dpcGVyLXBhZ2luYXRpb25cIik7XG5cbiAgICAgIGxldCBudW1iZXJOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIG51bWJlck5vZGUuY2xhc3NOYW1lID0gXCJwcm9jZXNzX19udW1iZXJcIjtcbiAgICAgIG51bWJlck5vZGUudGV4dENvbnRlbnQgPSAxO1xuXG4gICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCh3cmFwcGVyTm9kZSk7XG4gICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChwYWdpbmF0aW9uTm9kZSk7XG4gICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChudW1iZXJOb2RlKTtcblxuICAgICAgaXRlbS5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG4gICAgICBhZGRTbGlkZUNsYXNzKGl0ZW0pO1xuXG4gICAgICBjb25zdCBwcm9jZXNzU3dpcGVyID0gaW5pdFN3aXBlcihpdGVtKTtcbiAgICAgIGFkZE51bWJlcmluZyhwcm9jZXNzU3dpcGVyLCBpdGVtKTtcbiAgICB9KTtcbiAgfTtcblxuICByZW5kZXJTbGlkZXIoKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC1tb2RlbF9fZm9ybScpO1xuXG4gIGNvbnN0IGVtYWlsSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRbbmFtZT0nZW1haWwnXVwiKTtcbiAgY29uc3QgZW1haWxFcnJvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtbW9kZWxfX2VtYWlsLWVycm9yJyk7XG5cbiAgY29uc3QgYnJhbmRJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJpbnB1dFtuYW1lPSdicmFuZCddXCIpO1xuICBjb25zdCBicmFuZEVycm9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC1tb2RlbF9fYnJhbmQtZXJyb3InKTtcblxuICBjb25zdCBtb2RlbElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImlucHV0W25hbWU9J21vZGVsJ11cIik7XG4gIGNvbnN0IG1vZGVsRXJyb3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLW1vZGVsX19tb2RlbC1lcnJvcicpO1xuXG4gIGNvbnN0IGZpbGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJpbnB1dFt0eXBlPSdmaWxlJ11cIik7XG5cbiAgY29uc3QgY2hlY2tib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLW1vZGVsX19hZ3JlZW1lbnQtaW5wdXQnKTtcblxuICBjb25zdCBzdWJtaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLW1vZGVsX19zdWJtaXQnKTtcblxuICBjb25zdCBwcm9ncmVzcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtbW9kZWxfX2ZpbGUtcHJvZ3Jlc3MnKTtcbiAgY29uc3QgYmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC1tb2RlbF9fYmFyLWN1cnJlbnQnKTtcblxuICBjb25zdCBmaWxlTGFiZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLW1vZGVsX19maWxlLWxhYmVsJyk7XG4gIGNvbnN0IGZpbGVEcm9wQXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtbW9kZWxfX2ZpbGUtd3JhcCcpO1xuXG4gIGNvbnN0IGZpbGVSZXN1bHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLW1vZGVsX19maWxlLXJlc3VsdCcpO1xuICBjb25zdCBmaWxlSW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC1tb2RlbF9fZmlsZS1pbWFnZScpO1xuICBjb25zdCBmaWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtbW9kZWxfX2ZpbGUtbmFtZScpO1xuICBjb25zdCBmaWxlQ2xlYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLW1vZGVsX19maWxlLWNsb3NlJyk7XG5cbiAgaWYgKCFlbWFpbElucHV0KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8g0KHQsdGA0LDRgdGL0LLQsNC10Lwg0YHRgtCw0L3QtNCw0YDRgtC90YvQtSDRgdC+0LHRi9GC0LjRjyDQv9GA0Lgg0L/QtdGA0LXRgtCw0YHQutC40LLQsNC90LjQuCDRhNCw0LnQu9CwXG5cbiAgWydkcmFnZW50ZXInLCAnZHJhZ292ZXInLCAnZHJhZ2xlYXZlJywgJ2Ryb3AnXS5mb3JFYWNoKGV2ZW50TmFtZSA9PiB7XG4gICAgZmlsZURyb3BBcmVhLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBwcmV2ZW50RGVmYXVsdHMsIGZhbHNlKVxuICB9KTtcblxuICBmdW5jdGlvbiBwcmV2ZW50RGVmYXVsdHMgKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgfTtcblxuICAvLyDQlNC+0LHQsNCy0LvRj9C10Lwg0YHRgtC40LvQuCDQv9GA0Lgg0L/QtdGA0LXRgtCw0YHQutC40LLQsNC90LjQuCDRhNCw0LnQu9CwINC90LDQtCDQvdGD0LbQvdC+0Lkg0L7QsdC70LDRgdGC0YzRjlxuXG4gIFsnZHJhZ2VudGVyJywgJ2RyYWdvdmVyJ10uZm9yRWFjaChldmVudE5hbWUgPT4ge1xuICAgIGZpbGVEcm9wQXJlYS5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgaGlnaGxpZ2h0LCBmYWxzZSlcbiAgfSk7XG5cbiAgWydkcmFnbGVhdmUnLCAnZHJvcCddLmZvckVhY2goZXZlbnROYW1lID0+IHtcbiAgICBmaWxlRHJvcEFyZWEuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIHVuaGlnaGxpZ2h0LCBmYWxzZSlcbiAgfSlcblxuICBmdW5jdGlvbiBoaWdobGlnaHQoZSkge1xuICAgIGZpbGVMYWJlbC5jbGFzc0xpc3QuYWRkKCdoaWdobGlnaHQnKTtcbiAgfTtcblxuICBmdW5jdGlvbiB1bmhpZ2hsaWdodChlKSB7XG4gICAgZmlsZUxhYmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZ2hsaWdodCcpO1xuICB9O1xuXG4gIC8vXG5cbiAgZmlsZURyb3BBcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCBoYW5kbGVEcm9wLCBmYWxzZSlcblxuICBmdW5jdGlvbiBoYW5kbGVEcm9wKGUpIHtcbiAgICBsZXQgZHQgPSBlLmRhdGFUcmFuc2ZlclxuICAgIGxldCBmaWxlcyA9IGR0LmZpbGVzXG5cbiAgICBpZiAoZmlsZUlucHV0LmZpbGVzICYmIGZpbGVJbnB1dC5maWxlc1swXSkge1xuICAgICAgZmlsZUlucHV0LnZhbHVlID0gJyc7XG5cbiAgICAgIGlmKCEvc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSl7XG4gICAgICAgIGZpbGVJbnB1dC50eXBlID0gJyc7XG4gICAgICAgIGZpbGVJbnB1dC50eXBlID0gJ2ZpbGUnO1xuICAgICAgfVxuXG4gICAgICBmaWxlUmVzdWx0LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICAgIGZpbGVOYW1lLnRleHRDb250ZW50ID0gJyc7XG4gICAgICBmaWxlSW1nLnJlbW92ZUF0dHJpYnV0ZSgnc3JjJyk7XG4gICAgfVxuXG4gICAgZmlsZUlucHV0LmZpbGVzID0gZmlsZXM7XG4gICAgb25GaWxlQ2hhbmdlKCk7XG5cbiAgICAvL2hhbmRsZUZpbGVzKGZpbGVzKVxuICB9O1xuXG4gIGZ1bmN0aW9uIHByZXZlbnREZWZhdWx0cyAoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgfVxuXG4gIGNvbnN0IGFkZENsYXNzTmFtZSA9IChlbGVtZW50LCBjbGFzc05hbWUpID0+IHtcbiAgICBpZiAoIWVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTmFtZSkpIHtcbiAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCByZW1vdmVDbGFzc05hbWUgPSAoZWxlbWVudCwgY2xhc3NOYW1lKSA9PiB7XG4gICAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTmFtZSkpIHtcbiAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBlbmFibGVCdXR0b24gPSAoKSA9PiB7XG4gICAgc3VibWl0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSAmJiBzdWJtaXQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICB9O1xuXG4gIGNvbnN0IGRpc2FibGVCdXR0b24gPSAoKSA9PiB7XG4gICAgIXN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykgJiYgc3VibWl0LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gIH07XG5cbiAgY29uc3QgaXNGb3JtRmlsbGVkID0gKCkgPT4ge1xuICAgIHJldHVybiBlbWFpbElucHV0LnZhbGlkaXR5LnZhbGlkXG4gICAgICAmJiBicmFuZElucHV0LnZhbHVlICE9PSAnJ1xuICAgICAgJiYgbW9kZWxJbnB1dC52YWx1ZSAhPT0gJydcbiAgICAgICYmIGNoZWNrYm94LmNoZWNrZWRcbiAgfTtcblxuICBjb25zdCBjaGVja0Zvcm0gPSAoKSA9PiB7XG4gICAgaWYgKGlzRm9ybUZpbGxlZCgpKSB7XG4gICAgICBlbmFibGVCdXR0b24oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGlzYWJsZUJ1dHRvbigpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCByZWFkVXJsID0gKGlucHV0KSA9PiB7XG4gICAgaWYgKGlucHV0LmZpbGVzICYmIGlucHV0LmZpbGVzWzBdKSB7XG4gICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcblxuICAgICAgcmVhZGVyLm9ubG9hZHN0YXJ0ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgcHJvZ3Jlc3MuY2xhc3NMaXN0LmFkZCgnc2hvdycpO1xuICAgICAgfVxuXG4gICAgICByZWFkZXIub25wcm9ncmVzcyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKE1hdGgucm91bmQoZS5sb2FkZWQgLyBlLnRvdGFsICogMTAwKSk7XG4gICAgICAgIGJhci5zdHlsZS53aWR0aCA9IE1hdGgucm91bmQoZS5sb2FkZWQgLyBlLnRvdGFsICogMTAwKSArICclJztcbiAgICAgIH1cblxuICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGZpbGVJbWcuc2V0QXR0cmlidXRlKCdzcmMnLCBlLnRhcmdldC5yZXN1bHQpO1xuICAgICAgICBmaWxlTmFtZS50ZXh0Q29udGVudCA9IGlucHV0LmZpbGVzWzBdLm5hbWU7XG4gICAgICAgICFmaWxlUmVzdWx0LmNsYXNzTGlzdC5jb250YWlucygnc2hvdycpICYmIGZpbGVSZXN1bHQuY2xhc3NMaXN0LmFkZCgnc2hvdycpO1xuXG4gICAgICAgIHByb2dyZXNzLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICAgICAgYmFyLnN0eWxlLndpZHRoID0gMDtcbiAgICAgIH1cblxuICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoaW5wdXQuZmlsZXNbMF0pO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IG9uVGV4dEZvY3VzID0gKGV2dCkgPT4ge1xuICAgIGNvbnN0IGlucHV0ID0gZXZ0LnRhcmdldDtcblxuICAgIGFkZENsYXNzTmFtZShpbnB1dCwgJ2ZpbGwnKTtcblxuICAgIGlmIChpbnB1dC52YWx1ZSA9PT0gJycpIHtcbiAgICAgIGFkZENsYXNzTmFtZShpbnB1dCwgJ21hc2snKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3Qgb25UZXh0Qmx1ciA9IChldnQpID0+IHtcbiAgICBjb25zdCBpbnB1dCA9IGV2dC50YXJnZXQ7XG5cbiAgICBpZiAoIWlucHV0LnZhbHVlKSB7XG4gICAgICByZW1vdmVDbGFzc05hbWUoaW5wdXQsICdmaWxsJyk7XG4gICAgfVxuXG4gICAgcmVtb3ZlQ2xhc3NOYW1lKGlucHV0LCAnbWFzaycpO1xuICB9XG5cbiAgY29uc3Qgb25FbWFpbElucHV0ID0gKGV2dCkgPT4ge1xuICAgIGNvbnN0IGlucHV0ID0gZXZ0LnRhcmdldDtcblxuICAgIC8vIGlmIChpbnB1dC52YWx1ZSA9PT0gJycpIHtcbiAgICAvLyAgIGFkZENsYXNzTmFtZShpbnB1dCwgJ21hc2snKTtcbiAgICAvLyAgIGFkZENsYXNzTmFtZShpbnB1dCwgJ2Vycm9yJyk7XG4gICAgLy8gfVxuXG4gICAgaWYgKCFlbWFpbElucHV0LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICBhZGRDbGFzc05hbWUoZW1haWxFcnJvciwgJ3Nob3cnKTtcbiAgICAgIGFkZENsYXNzTmFtZShlbWFpbElucHV0LCAnZXJyb3InKTtcbiAgICB9XG5cbiAgICBpZiAoZW1haWxJbnB1dC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgcmVtb3ZlQ2xhc3NOYW1lKGlucHV0LCAnZXJyb3InKTtcbiAgICAgIHJlbW92ZUNsYXNzTmFtZShlbWFpbEVycm9yLCAnc2hvdycpO1xuICAgIH1cblxuICAgIGlmIChpbnB1dC52YWx1ZSA9PT0gJycpIHtcbiAgICAgIGFkZENsYXNzTmFtZShpbnB1dCwgJ21hc2snKTtcbiAgICB9XG5cbiAgICBpZiAoaW5wdXQudmFsdWUgIT09ICcnKSB7XG4gICAgICByZW1vdmVDbGFzc05hbWUoaW5wdXQsICdtYXNrJyk7XG4gICAgfVxuXG4gICAgY2hlY2tGb3JtKCk7XG4gIH1cblxuICBjb25zdCBvbkJyYW5kSW5wdXQgPSAoZXZ0KSA9PiB7XG4gICAgY29uc3QgaW5wdXQgPSBldnQudGFyZ2V0O1xuXG4gICAgaWYgKGlucHV0LnZhbHVlID09PSAnJykge1xuICAgICAgYWRkQ2xhc3NOYW1lKGlucHV0LCAnbWFzaycpO1xuICAgICAgYWRkQ2xhc3NOYW1lKGlucHV0LCAnZXJyb3InKTtcbiAgICAgIGFkZENsYXNzTmFtZShicmFuZEVycm9yLCAnc2hvdycpO1xuICAgIH1cblxuICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gJycpIHtcbiAgICAgIHJlbW92ZUNsYXNzTmFtZShpbnB1dCwgJ21hc2snKTtcbiAgICAgIHJlbW92ZUNsYXNzTmFtZShpbnB1dCwgJ2Vycm9yJyk7XG4gICAgICByZW1vdmVDbGFzc05hbWUoYnJhbmRFcnJvciwgJ3Nob3cnKTtcbiAgICB9XG5cbiAgICBjaGVja0Zvcm0oKTtcbiAgfVxuXG4gIGNvbnN0IG9uTW9kZWxJbnB1dCA9IChldnQpID0+IHtcbiAgICBjb25zdCBpbnB1dCA9IGV2dC50YXJnZXQ7XG5cbiAgICBpZiAoaW5wdXQudmFsdWUgPT09ICcnKSB7XG4gICAgICBhZGRDbGFzc05hbWUoaW5wdXQsICdtYXNrJyk7XG4gICAgICBhZGRDbGFzc05hbWUoaW5wdXQsICdlcnJvcicpO1xuICAgICAgYWRkQ2xhc3NOYW1lKG1vZGVsRXJyb3IsICdzaG93Jyk7XG4gICAgfVxuXG4gICAgaWYgKGlucHV0LnZhbHVlICE9PSAnJykge1xuICAgICAgcmVtb3ZlQ2xhc3NOYW1lKGlucHV0LCAnbWFzaycpO1xuICAgICAgcmVtb3ZlQ2xhc3NOYW1lKGlucHV0LCAnZXJyb3InKTtcbiAgICAgIHJlbW92ZUNsYXNzTmFtZShtb2RlbEVycm9yLCAnc2hvdycpO1xuICAgIH1cblxuICAgIGNoZWNrRm9ybSgpO1xuICB9XG5cbiAgY29uc3Qgb25GaWxlQ2xlYXIgPSAoKSA9PiB7XG4gICAgZmlsZUlucHV0LnZhbHVlID0gJyc7XG5cbiAgICBpZighL3NhZmFyaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpe1xuICAgICAgZmlsZUlucHV0LnR5cGUgPSAnJztcbiAgICAgIGZpbGVJbnB1dC50eXBlID0gJ2ZpbGUnO1xuICAgIH1cblxuICAgIGZpbGVSZXN1bHQuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuICAgIGZpbGVOYW1lLnRleHRDb250ZW50ID0gJyc7XG4gICAgZmlsZUltZy5yZW1vdmVBdHRyaWJ1dGUoJ3NyYycpO1xuICB9XG5cbiAgY29uc3Qgb25GaWxlQ2hhbmdlID0gKCkgPT4ge1xuICAgIHJlYWRVcmwoZmlsZUlucHV0KTtcbiAgfVxuXG4gIGNvbnN0IG9uQ2hlY2tib3hDbGljayA9ICgpID0+IHtcbiAgICAhY2hlY2tib3guY2hlY2tlZFxuICAgICAgPyBhZGRDbGFzc05hbWUoY2hlY2tib3gsICdlcnJvcicpXG4gICAgICA6IHJlbW92ZUNsYXNzTmFtZShjaGVja2JveCwgJ2Vycm9yJyk7XG5cbiAgICBjaGVja0Zvcm0oKTtcbiAgfVxuXG4gIGNvbnN0IG9uU3VibWl0ID0gKGV2dCkgPT4ge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgZm9ybS5zdWJtaXQoKTtcbiAgfVxuXG4gIGVtYWlsSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCBvblRleHRGb2N1cyk7XG4gIGVtYWlsSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIG9uVGV4dEJsdXIpO1xuICBlbWFpbElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25FbWFpbElucHV0KTtcblxuICBicmFuZElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgb25UZXh0Rm9jdXMpO1xuICBicmFuZElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBvblRleHRCbHVyKTtcbiAgYnJhbmRJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uQnJhbmRJbnB1dCk7XG5cbiAgbW9kZWxJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIG9uVGV4dEZvY3VzKTtcbiAgbW9kZWxJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgb25UZXh0Qmx1cik7XG4gIG1vZGVsSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbk1vZGVsSW5wdXQpO1xuXG4gIGZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkZpbGVDaGFuZ2UpO1xuICBmaWxlQ2xlYXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkZpbGVDbGVhcik7XG5cbiAgY2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNoZWNrYm94Q2xpY2spO1xuXG4gIHN1Ym1pdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uU3VibWl0KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICBjb25zdCAkd2FybmluZyA9ICQoXCIuZGV2aWNlX193YXJuaW5nLWljb25cIik7XG4gIGNvbnN0ICRjaGlwID0gJChcIi5kZXZpY2VfX3N0cm9rZS1jaGlwXCIpO1xuICBjb25zdCAkcG9wdXBDYWJsZSA9ICQoXCIuZGV2aWNlX19zdHJva2UtcG9wdXBcIik7XG4gIGNvbnN0ICRwb3B1cFdhcm5pbmcgPSAkKFwiLmRldmljZV9fd2FybmluZy1wb3B1cFwiKTtcblxuICAkd2FybmluZy5vbihcIm1vdXNlZW50ZXJcIiwgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0ICRwb3B1cCA9ICQodGhpcykubmV4dCgpO1xuICAgIGNvbnN0IG9mZnNldCA9XG4gICAgICAkcG9wdXAub2Zmc2V0KCkubGVmdCArICRwb3B1cC5vdXRlcldpZHRoKCkgLSAkKHdpbmRvdykub3V0ZXJXaWR0aCgpO1xuXG4gICAgaWYgKG9mZnNldCA+IDApIHtcbiAgICAgICRwb3B1cC5jc3MoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGVYKGNhbGMoLTEwMCUgKyA0MHB4KSlcIik7XG4gICAgfVxuICB9KTtcblxuICAkd2FybmluZy5vbihcIm1vdXNlbGVhdmVcIiwgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0ICRwb3B1cCA9ICQodGhpcykubmV4dCgpO1xuICAgICRwb3B1cC5jc3MoXCJ0cmFuc2Zvcm1cIiwgXCJcIik7XG4gIH0pO1xuXG4gICRjaGlwLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0ICRwb3B1cCA9ICQodGhpcykubmV4dCgpO1xuXG4gICAgJHBvcHVwLmFkZENsYXNzKFwib3BlbmVkXCIpO1xuICB9KTtcblxuICAkcG9wdXBDYWJsZS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgaWYgKFxuICAgICAgJChlLnRhcmdldCkuaGFzQ2xhc3MoXCJkZXZpY2VfX3N0cm9rZS1wb3B1cFwiKSB8fFxuICAgICAgJChlLnRhcmdldCkuaGFzQ2xhc3MoXCJkZXZpY2VfX3N0cm9rZS1wb3B1cC1jbG9zZVwiKSB8fFxuICAgICAgJChlLnRhcmdldCkucGFyZW50cyhcIi5kZXZpY2VfX3N0cm9rZS1wb3B1cC1jbG9zZVwiKS5sZW5ndGggPiAwXG4gICAgKSB7XG4gICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKFwib3BlbmVkXCIpO1xuICAgIH1cbiAgfSk7XG5cbiAgJHdhcm5pbmcub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgJHBvcHVwID0gJCh0aGlzKS5uZXh0KCk7XG5cbiAgICAkcG9wdXAuYWRkQ2xhc3MoXCJvcGVuZWRcIik7XG4gIH0pO1xuXG4gICRwb3B1cFdhcm5pbmcub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xuICAgIGlmIChcbiAgICAgICQoZS50YXJnZXQpLmhhc0NsYXNzKFwiZGV2aWNlX193YXJuaW5nLXBvcHVwXCIpIHx8XG4gICAgICAkKGUudGFyZ2V0KS5oYXNDbGFzcyhcImRldmljZV9fc3Ryb2tlLXBvcHVwLWNsb3NlXCIpIHx8XG4gICAgICAkKGUudGFyZ2V0KS5wYXJlbnRzKFwiLmRldmljZV9fc3Ryb2tlLXBvcHVwLWNsb3NlXCIpLmxlbmd0aCA+IDBcbiAgICApIHtcbiAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoXCJvcGVuZWRcIik7XG4gICAgfVxuICB9KTtcblxuICBjb25zdCBzd2lwZXIgPSBuZXcgU3dpcGVyKFwiLm1vZGVsX19pbWFnZS1jb250YWluZXJcIiwge1xuICAgIHBhZ2luYXRpb246IHtcbiAgICAgIGVsOiBcIi5tb2RlbF9faW1hZ2UtY29udGFpbmVyIC5tb2RlbF9fcGFnaW5hdGlvblwiLFxuICAgICAgdHlwZTogXCJidWxsZXRzXCIsXG4gICAgICBjbGlja2FibGU6IHRydWUsXG4gICAgfSxcbiAgICBsb29wOiB0cnVlLFxuICB9KTtcbn0pKCk7XG4iXX0=
